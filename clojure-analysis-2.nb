(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     84322,       2409]
NotebookOptionsPosition[     72633,       2017]
NotebookOutlinePosition[     73191,       2037]
CellTagsIndexPosition[     73148,       2034]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.61039017736975*^9, 3.610390177870949*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<AssociativeUtils`\>\"", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610123880820364*^9, 3.6101238866531343`*^9}}],

Cell["Basically a big map-reduce. Like everything.", "Text",
 CellChangeTimes->{{3.609797485921159*^9, 3.6097974999096317`*^9}, {
  3.609813155635564*^9, 3.6098131579152527`*^9}, {3.610079925420598*^9, 
  3.61007993204767*^9}, {3.6101239253032837`*^9, 3.61012392733926*^9}}],

Cell[CellGroupData[{

Cell["Utils", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.610380546882833*^9, 3.6103805472338943`*^9}}],

Cell[CellGroupData[{

Cell["General Predicates", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.597034006338381*^9, 3.597034043144265*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"notFalseQ", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"!", 
   RowBox[{"(", 
    RowBox[{"x", "  ", "===", " ", "False"}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.596812217777191*^9, 3.596812243885096*^9}, {
  3.596812285218401*^9, 3.596812338290038*^9}, {3.599210785039962*^9, 
  3.599210795757633*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"everyQ", "[", 
   RowBox[{"pred_", ",", " ", "xs_"}], "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "sentinel", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Catch", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Fold", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"pred", "[", "#2", "]"}], ",", " ", "True", ",", " ", 
           RowBox[{"Throw", "[", 
            RowBox[{"False", ",", " ", "sentinel"}], "]"}]}], "]"}], "&"}], 
        ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
        "xs"}], "]"}], ",", "\[IndentingNewLine]", "sentinel"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"thingQ", "[", "]"}], ":=", " ", "False"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598385035980755*^9, 3.5983850379279013`*^9}, {
  3.59838515429491*^9, 3.5983851684288387`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"thingQ", "[", "__", "]"}], ":=", " ", "True"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598385170015087*^9, 3.598385179306218*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["let", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.598144549488331*^9, 3.598144552679078*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "let", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598144556156847*^9, 3.5981445587366447`*^9}}],

Cell[BoxData[
 RowBox[{"SetAttributes", "[", 
  RowBox[{"let", ",", " ", "HoldAll"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.59814456764146*^9, 3.5981445840324793`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"let", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"HoldPattern", "[", 
       RowBox[{"Set", "[", 
        RowBox[{"lhs_", " ", ",", " ", "rhs_"}], "]"}], "]"}], ",", " ", 
      "rst___"}], "}"}], ",", " ", "body___"}], "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lhs", " ", "=", " ", "rhs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"let", "[", 
     RowBox[{
      RowBox[{"{", "rst", "}"}], ",", " ", "body"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598144588165823*^9, 3.598144588720389*^9}, {
   3.598144632230338*^9, 3.598144822971513*^9}, 3.598144954215612*^9, {
   3.610390258256772*^9, 3.610390271647736*^9}, {3.6103903506519003`*^9, 
   3.610390393691846*^9}, {3.610390656296183*^9, 3.610390724617317*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"let", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", " ", "body___"}], "]"}], " ", ":=", " ", 
  "body"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598144825527643*^9, 3.598144838775177*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"let", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "=", "b"}], ",", 
     RowBox[{"c", "=", "a"}]}], "}"}], ",", " ", "c"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610390285858336*^9, 3.610390293410934*^9}}],

Cell[BoxData["b"], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.610390294050304*^9, 3.610390327978394*^9}, {
   3.610390404888215*^9, 3.610390431129496*^9}, 3.610390639732757*^9, 
   3.610390742051186*^9, 3.610393536878117*^9, 3.610394349777779*^9, 
   3.610394497901473*^9, 3.610394985130002*^9, 3.610395928525433*^9, 
   3.6103959660332623`*^9, {3.610396052851529*^9, 3.6103960702093563`*^9}, 
   3.610396326388503*^9, 3.6103963896448393`*^9, 3.6103970013951693`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["List Processing", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.598297150065463*^9, 3.598297172601335*^9}, {
  3.598378644585013*^9, 3.598378646263291*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cons", "[", 
   RowBox[{"x_", ",", " ", "xs_List"}], "]"}], ":=", " ", 
  RowBox[{"Prepend", "[", 
   RowBox[{"xs", ",", "x"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.59859047373456*^9, 3.598590494918252*^9}, {
  3.599070402463993*^9, 3.5990704044705067`*^9}}],

Cell["More clojurey fold:", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.598297449606105*^9, 3.598297457605584*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fold2", "[", 
   RowBox[{"f_", ",", " ", "x_", ",", " ", "ys_List"}], "]"}], " ", ":=", " ", 
  RowBox[{"Fold", "[", 
   RowBox[{"f", ",", " ", "x", ",", " ", "ys"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598297258494111*^9, 3.598297287147674*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fold2", "[", 
   RowBox[{"f_", ",", " ", 
    RowBox[{"{", 
     RowBox[{"x_", ",", " ", "ys__"}], "}"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"fold2", "[", 
   RowBox[{"f", ",", " ", "x", ",", 
    RowBox[{"{", "ys", "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598297291381473*^9, 3.598297360569716*^9}, 
   3.598297499877193*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fold2", "[", 
   RowBox[{"f_", ",", " ", 
    RowBox[{"{", "x_", "}"}]}], "]"}], ":=", " ", "x"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.59829736300914*^9, 3.598297389867613*^9}, {
  3.598297437679891*^9, 3.5982974379191303`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fold2", "[", 
   RowBox[{"f_", ",", " ", 
    RowBox[{"{", "}"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"f", "[", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598297440034258*^9, 3.598297464510479*^9}}],

Cell["Zipmap, etc etc", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.5983109456773443`*^9, 3.59831094912983*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"zipmap", "[", 
   RowBox[{"lhss_List", ",", " ", "rhss_List"}], "]"}], ":=", " ", 
  RowBox[{"MapThread", "[", 
   RowBox[{"Rule", ",", " ", 
    RowBox[{"{", 
     RowBox[{"lhss", ",", " ", "rhss"}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598309345936727*^9, 3.598309361160018*^9}, {
  3.59830952205179*^9, 3.598309545655805*^9}, {3.598309592721611*^9, 
  3.598309593617312*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"combineAt", "[", 
   RowBox[{"f_", ",", " ", "xs_", ",", " ", "rs_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"apl", " ", "=", "\[IndentingNewLine]", " ", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"bldg", ",", " ", "r"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", "=", " ", 
            RowBox[{"lhs", "[", "r", "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"bldg", ",", 
            RowBox[{"i", "\[Rule]", 
             RowBox[{"f", "[", 
              RowBox[{
               RowBox[{"bldg", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
               RowBox[{"rhs", "[", "r", "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Fold", "[", 
     RowBox[{"apl", ",", " ", "xs", ",", " ", "rs"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598378666650144*^9, 3.5983787512582903`*^9}, 
   3.598378881896635*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Other Shit", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6103888288639107`*^9, 3.6103888296379347`*^9}, {
  3.610394373657957*^9, 3.6103943752964363`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qwikCases", "[", 
   RowBox[{"expr_", ",", " ", "frm_"}], "]"}], ":=", 
  RowBox[{"Cases", "[", 
   RowBox[{"expr", ",", " ", "frm", ",", " ", "\[Infinity]", ",", " ", 
    RowBox[{"Heads", "\[Rule]", " ", "True"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610078125264853*^9, 3.610078163563168*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qwikPartition", "[", 
   RowBox[{"x_", ",", "n_", ",", "off_"}], "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{"x", ",", "n", ",", "off", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610387596067012*^9, 3.610387609416251*^9}, {
  3.610391801024932*^9, 3.6103918085904016`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qwikPartition", "[", 
   RowBox[{"x_", ",", " ", "n_"}], "]"}], ":=", " ", 
  RowBox[{"qwikPartition", "[", 
   RowBox[{"x", ",", "n", ",", "n"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.61038752155919*^9, 3.610387550698324*^9}, {
  3.610387581863616*^9, 3.610387586880423*^9}, {3.6103876215757504`*^9, 
  3.610387627990704*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"columnate", "[", 
   RowBox[{"x_", ",", " ", "rows_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"Partition", "[", 
    RowBox[{"x", ",", "rows", ",", "rows", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", "Null", "}"}]}], "]"}], "//", "Transpose"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610388342265007*^9, 3.610388400090472*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.60287912501143*^9, 3.6028791294169083`*^9}}],

Cell["\<\
Dependency-free (associative utils may help construct test batteries, though).\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6029019081698933`*^9, 3.6029019221833897`*^9}, {
  3.602902121458291*^9, 3.602902121729105*^9}, {3.6037398631089163`*^9, 
  3.6037398868866987`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "testWalk", ",", "runTests", ",", " ", "is", ",", " ", "notFound", ",", 
    "passed", ",", "failed"}], "]"}], ";", 
  RowBox[{
   RowBox[{"Attributes", "[", "is", "]"}], "=", " ", 
   RowBox[{"{", "HoldAll", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60289721224224*^9, 3.602897235034136*^9}, {
   3.602901109624857*^9, 3.602901112614876*^9}, {3.602902492834633*^9, 
   3.6029024963810883`*^9}, {3.602902724011547*^9, 3.6029027289262123`*^9}, {
   3.6029067835510406`*^9, 3.602906798016685*^9}, 3.610395158262672*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testWalk", "[", 
   RowBox[{"tests_", ",", "behind_", ",", " ", "ahead_"}], " ", "]"}], ":=", 
  " ", "\[IndentingNewLine]", 
  RowBox[{"testWalk", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "[", "ahead", "]"}], "/.", 
     RowBox[{"Append", "[", 
      RowBox[{"tests", ",", " ", 
       RowBox[{"_", " ", "\[RuleDelayed]", " ", 
        RowBox[{"Throw", "[", 
         RowBox[{"notFound", "[", 
          RowBox[{
           RowBox[{"\"\<behind\>\"", "\[Rule]", "behind"}], ",", " ", 
           RowBox[{"\"\<ahead\>\"", "\[Rule]", " ", "ahead"}]}], " ", "]"}], 
         "]"}]}]}], "]"}]}], ",", " ", 
    RowBox[{"Append", "[", 
     RowBox[{"behind", ",", " ", 
      RowBox[{"First", "[", "ahead", "]"}]}], "]"}], ",", " ", 
    RowBox[{"Rest", "[", "ahead", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.602897489731139*^9, 3.602897638201522*^9}, {
   3.6028976866089153`*^9, 3.602897699774631*^9}, 3.602897831244113*^9, {
   3.6028983761544943`*^9, 3.602898382074605*^9}, {3.602898424774269*^9, 
   3.602898444494355*^9}, {3.602898745659721*^9, 3.602898859893244*^9}, {
   3.602898895604669*^9, 3.602898919290853*^9}, {3.6028990821227837`*^9, 
   3.602899119593362*^9}, {3.60289915474638*^9, 3.602899232028389*^9}, {
   3.602899334625546*^9, 3.602899335169456*^9}, {3.60290193407292*^9, 
   3.602901939267617*^9}, {3.6029020900389233`*^9, 3.602902110551862*^9}, {
   3.6029023490362453`*^9, 3.6029023616421328`*^9}, {3.602902480513864*^9, 
   3.6029024862113533`*^9}, {3.602902645079198*^9, 3.602902658496421*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testWalk", "[", 
   RowBox[{"tests_", ",", " ", "behind_", ",", " ", 
    RowBox[{"{", "}"}]}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"testWalk", "[", 
     RowBox[{"#", ",", "behind", ",", 
      RowBox[{"{", "}"}]}], "]"}], "&"}], "/@", "tests"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.602897833142717*^9, 3.602897868811491*^9}, {
  3.602898583820779*^9, 3.6028986232873793`*^9}, {3.6028986611938133`*^9, 
  3.6028986911617002`*^9}, {3.602901183668252*^9, 3.602901186307152*^9}, {
  3.602905943236911*^9, 3.602905958675108*^9}, {3.602906047681364*^9, 
  3.602906048785495*^9}, {3.6029061166709948`*^9, 3.602906149332719*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testWalk", "[", 
   RowBox[{
    RowBox[{"r_", " ", "\[Rule]", " ", "m_"}], ",", " ", "behind_", ",", " ", 
    
    RowBox[{"{", "}"}]}], "]"}], ":=", 
  RowBox[{"testWalk", "[", 
   RowBox[{"m", ",", " ", 
    RowBox[{"Append", "[", 
     RowBox[{"behind", ",", " ", "r"}], "]"}], ",", " ", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.602898445575198*^9, 3.602898564319623*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testWalk", "[", 
   RowBox[{"isForm_is", ",", " ", "behind_", ",", " ", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"SameQ", "@@", "isForm"}], ")"}], ",", "\[IndentingNewLine]", 
    RowBox[{"passed", "[", 
     RowBox[{
      RowBox[{"\"\<path\>\"", "\[Rule]", "behind"}], ",", 
      RowBox[{"Replace", "[", 
       RowBox[{"isForm", ",", " ", 
        RowBox[{
         RowBox[{"is", "[", "xs___", "]"}], "\[RuleDelayed]", " ", 
         RowBox[{"Hold", "[", 
          RowBox[{"SameQ", "[", "xs", "]"}], "]"}]}]}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"failed", "[", 
     RowBox[{
      RowBox[{"\"\<path\>\"", "\[Rule]", "behind"}], ",", " ", 
      RowBox[{"\"\<expected\>\"", "\[Rule]", 
       RowBox[{"Replace", "[", 
        RowBox[{"isForm", ",", " ", 
         RowBox[{
          RowBox[{"is", "[", "xs___", "]"}], "\[RuleDelayed]", " ", 
          RowBox[{"Hold", "[", 
           RowBox[{"SameQ", "[", "xs", "]"}], "]"}]}]}], "]"}]}], ",", " ", 
      RowBox[{"\"\<got\>\"", "\[Rule]", " ", 
       RowBox[{"Replace", "[", 
        RowBox[{"isForm", ",", " ", 
         RowBox[{
          RowBox[{"is", "[", "xs___", "]"}], "\[RuleDelayed]", " ", 
          RowBox[{"SameQ", "@@@", 
           RowBox[{"Hold", "@@", 
            RowBox[{"{", 
             RowBox[{"{", "xs", "}"}], "}"}]}]}]}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.602897732169285*^9, 3.602897741133698*^9}, {
  3.602897780248303*^9, 3.602897827899831*^9}, {3.602899289643446*^9, 
  3.602899292019123*^9}, {3.602900973694463*^9, 3.602900973896867*^9}, {
  3.602903042411746*^9, 3.602903129280582*^9}, {3.6029035435947323`*^9, 
  3.6029036167077703`*^9}, {3.602903798062684*^9, 3.602903806284136*^9}, {
  3.6029039787472258`*^9, 3.602903981188623*^9}, {3.602904014619079*^9, 
  3.602904056622548*^9}, {3.602904167806541*^9, 3.602904290333337*^9}, {
  3.602904329962532*^9, 3.602904330066905*^9}, {3.602904412274497*^9, 
  3.602904449106001*^9}, {3.602904548254447*^9, 3.602904557613105*^9}, {
  3.602904634678146*^9, 3.602904674869893*^9}, {3.602967213710788*^9, 
  3.602967249599634*^9}, {3.602988969614584*^9, 3.602988969831164*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"runTests", "[", 
   RowBox[{"tests_", ",", 
    RowBox[{"path", ":", 
     RowBox[{"{", "___String", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"testWalk", "[", 
    RowBox[{"tests", ",", 
     RowBox[{"{", "}"}], ",", "path"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.602883993289528*^9, 3.60288402123695*^9}, {
   3.602884054016261*^9, 3.602884106887703*^9}, {3.602884201999894*^9, 
   3.6028842164892797`*^9}, {3.6028842887707863`*^9, 3.602884386426284*^9}, {
   3.6028844527040243`*^9, 3.60288445372865*^9}, {3.602884489792293*^9, 
   3.602884632752591*^9}, {3.602884670403162*^9, 3.6028847272943573`*^9}, {
   3.6028847616471148`*^9, 3.602884781248773*^9}, {3.602884907163056*^9, 
   3.602884933247778*^9}, {3.6028971832918158`*^9, 3.602897185491177*^9}, {
   3.602901068824445*^9, 3.60290108396953*^9}, 3.602901314245582*^9, {
   3.6029013545204163`*^9, 3.602901404292858*^9}, {3.602901636940619*^9, 
   3.602901653280682*^9}, {3.60290171959732*^9, 3.6029017733143873`*^9}, {
   3.602902323493698*^9, 3.602902330323978*^9}, {3.602905965653892*^9, 
   3.6029059667546453`*^9}, 3.6029060312542267`*^9, 3.602906121982332*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"runTests", "[", "tests_", "]"}], ":=", " ", 
  RowBox[{"runTests", "[", 
   RowBox[{"tests", ",", " ", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6029017213023987`*^9, 3.602901741888188*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mapper", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.60838720903561*^9, 3.608387213867951*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapper", "[", "f_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{"f", ",", "#"}], "]"}], "&"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6084024652451963`*^9, 3.608402482791486*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["asMap", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.608401914279929*^9, 3.6084019164063807`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"asMap", "[", "x_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"lookup", "[", 
    RowBox[{"x", ",", "##"}], "]"}], "&"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60840071125609*^9, 3.608400739659273*^9}, 
   3.608403401871502*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"asMap", "[", 
   RowBox[{"x_", ",", " ", "default_"}], "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"{", "##", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "k_", "}"}], "\[RuleDelayed]", 
        RowBox[{"lookup", "[", 
         RowBox[{"x", ",", "k", ",", " ", "default"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", " ", 
        RowBox[{"lookup", "[", 
         RowBox[{"x", ",", " ", "##"}], "]"}]}]}], "}"}]}], "]"}], 
   "&"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6084033592373734`*^9, 3.608403373013782*^9}, {
  3.608403414115053*^9, 3.6084035487285547`*^9}, {3.6084039986454773`*^9, 
  3.608404015886221*^9}, {3.608404060500169*^9, 3.6084041202079973`*^9}, {
  3.6084041783472424`*^9, 3.608404188919306*^9}, {3.6084043442843723`*^9, 
  3.6084043478342457`*^9}, {3.6084044058839703`*^9, 3.608404413194457*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"runTests", "[", "\[IndentingNewLine]", 
  RowBox[{"let", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m1", " ", "=", " ", 
      RowBox[{"someStructure", "[", 
       RowBox[{"\"\<a\>\"", "\[Rule]", " ", "\"\<A\>\""}], "]"}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"is", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"asMap", "[", "m1", "]"}], "[", "\"\<a\>\"", "]"}], ",", 
        "\"\<A\>\""}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"is", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"asMap", "[", 
          RowBox[{"m1", ",", "\"\<C\>\""}], "]"}], "[", "\"\<c\>\"", "]"}], 
        ",", " ", "\"\<C\>\""}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"is", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"asMap", "[", "m1", "]"}], "[", 
         RowBox[{"\"\<b\>\"", ",", " ", "\"\<C\>\""}], "]"}], ",", 
        "\"\<C\>\""}], "]"}]}], "}"}]}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.608403556962121*^9, 3.608403719622596*^9}, {
  3.608403750262039*^9, 3.608403887389125*^9}, {3.608403945577671*^9, 
  3.608403946782501*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"passed", "[", 
    RowBox[{
     RowBox[{"\<\"path\"\>", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Hold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"asMap", "[", 
         RowBox[{"someStructure", "[", 
          RowBox[{"\<\"a\"\>", "\[Rule]", "\<\"A\"\>"}], "]"}], "]"}], 
        "[", "\<\"a\"\>", "]"}], "===", "\<\"A\"\>"}], "]"}]}], "]"}], ",", 
   RowBox[{"passed", "[", 
    RowBox[{
     RowBox[{"\<\"path\"\>", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Hold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"asMap", "[", 
         RowBox[{
          RowBox[{"someStructure", "[", 
           RowBox[{"\<\"a\"\>", "\[Rule]", "\<\"A\"\>"}], "]"}], 
          ",", "\<\"C\"\>"}], "]"}], "[", "\<\"c\"\>", "]"}], 
       "===", "\<\"C\"\>"}], "]"}]}], "]"}], ",", 
   RowBox[{"passed", "[", 
    RowBox[{
     RowBox[{"\<\"path\"\>", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Hold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"asMap", "[", 
         RowBox[{"someStructure", "[", 
          RowBox[{"\<\"a\"\>", "\[Rule]", "\<\"A\"\>"}], "]"}], "]"}], "[", 
        RowBox[{"\<\"b\"\>", ",", "\<\"C\"\>"}], "]"}], "===", "\<\"C\"\>"}], 
      "]"}]}], "]"}]}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.6084038795506372`*^9, 3.6084038877510557`*^9}, {
   3.60840391863302*^9, 3.60840394804914*^9}, 3.608404130423621*^9, {
   3.60840426486756*^9, 3.6084042742009697`*^9}, 3.6084043710786543`*^9, 
   3.608404427794808*^9, 3.6084063775240707`*^9, 3.609464822708673*^9, 
   3.6103935374058027`*^9, 3.610394350377249*^9, 3.610394498450098*^9, 
   3.6103949856450644`*^9, 3.610395929100904*^9, 3.610395966970758*^9, {
   3.610396053419159*^9, 3.6103960708185987`*^9}, 3.610396326921968*^9, 
   3.610396390230785*^9, {3.610396981515381*^9, 3.610397001991826*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Init", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.604247386379744*^9, 3.6042473866996202`*^9}}],

Cell["\<\
Looks like if we dropped clojure-1.5.1.jar rather than clojure-1.2.0.jar into \
lib we mux up JLink. Should probably get the latest version of JLink.jar, or \
something. Ideally we could get it from some repo and handle this via \
Leiningen.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6042522907574673`*^9, 3.604252372922873*^9}}],

Cell[CellGroupData[{

Cell["load", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610394468296975*^9, 3.610394470975211*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "$Path", ",", 
    "\"\</Users/timothygardner/code/ClojureLink/src/mathematica\>\""}], "]"}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.504139157507572*^9, 3.50413917164657*^9}, {
   3.5041392671130657`*^9, 3.504139315312611*^9}, 3.6024467761494827`*^9, {
   3.604247240962201*^9, 3.60424726349481*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<ClojureLink`\>\"", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.50413914098973*^9, 3.5041391451790648`*^9}, 
   3.5041393175179462`*^9, {3.610395196408408*^9, 3.610395201918747*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InstallClojureLink", "[", 
   RowBox[{
   "\"\</Users/timothygardner/code/ClojureLink\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "{", "\"\</Users/timothygardner/code/ClojureLink/src/clj\>\"", "}"}]}], 
   "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.504139433014282*^9, 3.504139440081815*^9}, {
   3.504139744383008*^9, 3.504139758328649*^9}, {3.5056215253299723`*^9, 
   3.505621532411501*^9}, {3.5056223422736397`*^9, 3.505622343063479*^9}, {
   3.505622390936513*^9, 3.505622411510468*^9}, {3.505622553537956*^9, 
   3.505622554706108*^9}, {3.505623349783263*^9, 3.505623350227833*^9}, {
   3.5056234031786547`*^9, 3.505623422798609*^9}, {3.5056237219126053`*^9, 
   3.50562373556535*^9}, {3.602446781887697*^9, 3.602446818802354*^9}, 
   3.60424724608107*^9, {3.604247931052925*^9, 3.604247948931633*^9}}],

Cell[BoxData[
 RowBox[{"SetClojureLinkAutoReplacements", "[", 
  RowBox[{"EvaluationNotebook", "[", "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6024471810995913`*^9, 3.6024471877788563`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["qmark", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.60506299473174*^9, 3.6050630025027323`*^9}}],

Cell["\<\
Actually this is a bug. Totally doesn\[CloseCurlyQuote]t work, play around \
with question marks to see how\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.605063352444273*^9, 3.6050633666976013`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qmark", "=", "\"\<\:2047\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60506283082257*^9, 3.6050628419453707`*^9}}],

Cell[BoxData["\<\"\:2047\"\>"], "Output",
 InitializationCell->True,
 CellChangeTimes->{
  3.610393595573195*^9, 3.610395364554913*^9, 3.6103959330215807`*^9, 
   3.610395971052706*^9, 3.6103960038290586`*^9, {3.6103960573815536`*^9, 
   3.610396074788262*^9}, 3.610396330813757*^9, 3.610396400123597*^9, 
   3.6103970148723288`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"addQmark", "[", "s_String", "]"}], ":=", " ", 
  RowBox[{"s", "<>", "qmark"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605062904093499*^9, 3.605062920127*^9}, {
  3.6050629579356947`*^9, 3.6050629593028507`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"addQmark", "[", "s_Symbol", "]"}], ":=", " ", 
  RowBox[{"Symbol", "@", 
   RowBox[{"addQmark", "@", 
    RowBox[{"ToString", "@", "s"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6050628540070744`*^9, 3.6050629676926107`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["does it float", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610393616367358*^9, 3.610393617526086*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", "\[IndentingNewLine]", 
  RowBox[{"with\:2011out\:2011str", "[", "\[IndentingNewLine]", 
   RowBox[{"print", "@", 
    RowBox[{"eval", "@", 
     RowBox[{"load\:2011string", "@", "\"\<*clojure-version*\>\""}]}]}], 
   "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604250479412196*^9, 3.604250529676876*^9}, {
   3.604250639830553*^9, 3.604250645989959*^9}, 3.610394416906205*^9, 
   3.610394450052643*^9}],

Cell[BoxData["\<\"{:qualifier nil, :minor 5, :incremental 1, :major 1}\"\>"], \
"Output",
 InitializationCell->True,
 CellChangeTimes->{
  3.6103936194205236`*^9, 3.6103944521951313`*^9, 3.6103953648964043`*^9, 
   3.61039593342702*^9, 3.6103959715325747`*^9, 3.6103960041586037`*^9, {
   3.610396057568954*^9, 3.610396075002783*^9}, 3.610396330996472*^9, 
   3.610396400286811*^9, 3.610397015070498*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Namespaces", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.604348436405394*^9, 3.60434844149152*^9}}],

Cell[CellGroupData[{

Cell["Problem", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.604364177308529*^9, 3.604364178138789*^9}}],

Cell["\<\
in-ns doesn\[CloseCurlyQuote]t work, getting it to work would require \
rewriting the clojure side of ClojureLink somewhat.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.604348372410725*^9, 3.604348410157895*^9}, {
  3.604348457362369*^9, 3.604348482279851*^9}, {3.604348690764203*^9, 
  3.6043487142891197`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"currentNamespace", "[", "]"}], ":=", 
  RowBox[{"ClojureEvaluate", "[", 
   RowBox[{"with\:2011out\:2011str", "[", 
    RowBox[{"print", "[", 
     RowBox[{"load\:2011string", "[", "\"\<*ns*\>\"", "]"}], "]"}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604348253074171*^9, 3.60434826354874*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"currentNamespace", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604348355996788*^9, 3.604348357235903*^9}}],

Cell[BoxData["\<\"#<Namespace user>\"\>"], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.610395364948311*^9, 3.610396010839753*^9, 
  3.610396094454897*^9, 3.610396412347702*^9, 3.610397015260437*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"coreSymbol", "=", " ", 
  RowBox[{"ClojureSymbol", "@", "\"\<ClojureLink.core\>\""}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604247975837233*^9, 3.604247985773625*^9}}],

Cell[BoxData[
 RowBox[{"ClojureSymbol", "[", "\<\"ClojureLink.core\"\>", "]"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.610395364993719*^9, 3.610396010906986*^9, 
  3.610396094524692*^9, 3.6103964123978767`*^9, 3.610397015307745*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", 
  RowBox[{"in\:2011ns", "@", 
   RowBox[{"quote", "@", "coreSymbol"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\[LeftGuillemet]", 
   RowBox[{"JavaObject", "[", 
    RowBox[{"clojure", ".", "lang", ".", "Namespace"}], "]"}], 
   "\[RightGuillemet]"}],
  JLink`Objects`vm1`JavaObject30376784222486529]], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.610395365024824*^9, 3.610396010974181*^9, 
  3.6103960945860147`*^9, 3.610396412432032*^9, 3.610397015358304*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"currentNamespace", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6043486091326017`*^9, 3.6043486103741302`*^9}}],

Cell[BoxData["\<\"#<Namespace user>\"\>"], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.610395365072578*^9, 3.610396011040236*^9, 
  3.6103960946534224`*^9, 3.6103964124809847`*^9, 3.610397015407545*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", 
  RowBox[{"in\:2011ns", "@", 
   RowBox[{"quote", "@", 
    RowBox[{"ClojureSymbol", "[", "\"\<clojure.tools.analyzer\>\"", "]"}]}]}],
   "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604248284326832*^9, 3.604248305845849*^9}, {
  3.604345652485627*^9, 3.604345652687806*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\[LeftGuillemet]", 
   RowBox[{"JavaObject", "[", 
    RowBox[{"clojure", ".", "lang", ".", "Namespace"}], "]"}], 
   "\[RightGuillemet]"}],
  JLink`Objects`vm1`JavaObject24034204052357121]], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.610395365110216*^9, 3.61039601110179*^9, 
  3.61039609471959*^9, 3.6103964125305634`*^9, 3.610397015458458*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"currentNamespace", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604348365798819*^9, 3.604348367067008*^9}}],

Cell[BoxData["\<\"#<Namespace user>\"\>"], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.610395365156272*^9, 3.61039601116593*^9, 
  3.610396094786086*^9, 3.610396412570063*^9, 3.610397015507749*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", 
  RowBox[{"require", "[", 
   RowBox[{"quote", "@", "coreSymbol"}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604247993672173*^9, 3.604248006324918*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"analysisSymbol", " ", "=", " ", 
  RowBox[{"ClojureSymbol", "@", "\"\<ClojureLink.analysis\>\""}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604247514286664*^9, 3.604247529951985*^9}, {
  3.604346148913241*^9, 3.6043461493631973`*^9}}],

Cell[BoxData[
 RowBox[{"ClojureSymbol", "[", "\<\"ClojureLink.analysis\"\>", 
  "]"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.61039536520697*^9, 3.610396011270002*^9, 
  3.6103960948712997`*^9, 3.610396412632286*^9, 3.610397015646735*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", 
  RowBox[{"require", "[", 
   RowBox[{"quote", "[", "analysisSymbol", "]"}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604348202703631*^9, 3.604348215552595*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", 
  RowBox[{"in\:2011ns", "[", 
   RowBox[{"quote", "[", "analysisSymbol", "]"}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60434822157169*^9, 3.604348232820772*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\[LeftGuillemet]", 
   RowBox[{"JavaObject", "[", 
    RowBox[{"clojure", ".", "lang", ".", "Namespace"}], "]"}], 
   "\[RightGuillemet]"}],
  JLink`Objects`vm1`JavaObject4903506464997377]], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.6103953658913727`*^9, 3.610396011985303*^9, 
  3.6103960955527267`*^9, 3.6103964132220783`*^9, 3.6103970163428288`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"currentNamespace", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6043482678417673`*^9, 3.604348269072772*^9}}],

Cell[BoxData["\<\"#<Namespace user>\"\>"], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.610395365939089*^9, 3.6103960120497828`*^9, 
  3.610396095624546*^9, 3.610396413265357*^9, 3.61039701639152*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Work-around", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.604349630805613*^9, 3.604349632026394*^9}}],

Cell[TextData[{
 "Use: ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"nsreq", "[", "\"\<ClojureLink.analysis\>\"", "]"}], ";", 
   RowBox[{"nsreq", "[", "\"\<clojure.jvm.tools.analyzer\>\"", "]"}], ";"}]], 
  "Input",
  CellChangeTimes->{{3.604355241521142*^9, 3.604355249122266*^9}, {
   3.604362896085126*^9, 3.60436293267015*^9}, {3.605053749189436*^9, 
   3.605053749859435*^9}}]
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.608005289115169*^9, 3.608005291615572*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsreq", "[", "ns_ClojureSymbol", "]"}], ":=", 
  RowBox[{"ClojureEvaluate", "@", 
   RowBox[{"require", "@", 
    RowBox[{"quote", "@", "ns"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604349640923064*^9, 3.604349716123522*^9}, {
  3.60435027365521*^9, 3.6043502763968487`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsreq", "[", "ns_String", "]"}], ":=", " ", 
  RowBox[{"nsreq", "[", 
   RowBox[{"ClojureSymbol", "[", "ns", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6043502784641438`*^9, 3.60435030121754*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsq", "[", 
   RowBox[{"ns_", ",", " ", "x_"}], "]"}], ":=", " ", 
  RowBox[{"ClojureSymbol", "[", 
   RowBox[{"StringJoin", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ns", ",", "\"\</\>\"", ",", "x"}], "}"}], "/.", 
      RowBox[{
       RowBox[{"ClojureSymbol", "[", "y_", "]"}], "\[RuleDelayed]", " ", 
       "y"}]}], ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604349259296501*^9, 3.604349322760928*^9}, {
  3.604349380154913*^9, 3.604349420063553*^9}, {3.604349460997456*^9, 
  3.60434948377182*^9}, {3.604349522224559*^9, 3.6043495321021976`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Parse Project", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.6103952921037397`*^9, 3.6103952937583323`*^9}}],

Cell["\<\
Just whack it with the predefined instaparse thing (for all its many warts)\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.610395296710569*^9, 3.610395315302187*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsreq", "[", "\"\<ClojureLink.parser\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610395345023979*^9, 3.6103953552270823`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"parseFile", ",", "parseString"}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6103953810669527`*^9, 3.6103953883458014`*^9}, {
  3.610396819622137*^9, 3.610396821712673*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseFile", "[", "f_String", "]"}], ":=", " ", 
  RowBox[{"ClojureEvaluate", "[", 
   RowBox[{"ClojureLink\:2024parser`parse\:2011file", "[", "f", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.608008045292636*^9, 3.608008074088542*^9}, {
  3.608008106231945*^9, 3.6080081227485*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseString", "[", "s_String", "]"}], ":=", " ", 
  RowBox[{"ClojureEvaluate", "[", 
   RowBox[{"ClojureLink\:2024parser`parse\:2011string", "[", "s", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610396831072607*^9, 3.6103968480297527`*^9}}],

Cell[CellGroupData[{

Cell["Tests", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610395426168159*^9, 3.6103954274481993`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseProjectTest", "=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"is", "[", 
      RowBox[{"True", ",", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"parseString", "[", "\"\<[bla]\>\"", "]"}], ",", " ", 
         "_List"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"is", "[", 
      RowBox[{"True", ",", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"parseString", "[", "\"\<[bla]\>\"", "]"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\:0589top", ",", 
           RowBox[{"{", 
            RowBox[{"\:0589expression", ",", 
             RowBox[{"{", 
              RowBox[{"\:0589vector", ",", 
               RowBox[{"{", 
                RowBox[{"\:0589expression", ",", 
                 RowBox[{"{", 
                  RowBox[{"\:0589atom", ",", 
                   RowBox[{"{", 
                    RowBox[{"\:0589name", ",", "\"\<bla\>\""}], "}"}]}], 
                  "}"}]}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], "]"}]}], "]"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"is", "[", 
      RowBox[{"True", ",", " ", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{
         "parseFile", "[", 
          "\"\</Users/timothygardner/code/mathematica-clojure-analysis/clj-\
test-project/src/clj_test_project/core.clj\>\"", "]"}], ",", "_List"}], 
        "]"}]}], "]"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6103954342379847`*^9, 3.610395442474114*^9}, {
  3.610395493746976*^9, 3.610395494172647*^9}, {3.610396655662456*^9, 
  3.610396777891797*^9}, {3.6103968751397533`*^9, 3.610396891943015*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "/@", 
   RowBox[{"runTests", "[", "parseProjectTest", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610396781365239*^9, 3.610396784103044*^9}, {
  3.6103968994149837`*^9, 3.610396906303134*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"passed", "[", 
  RowBox[{
   RowBox[{"\<\"path\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"Hold", "[", 
    RowBox[{"True", "===", 
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"parseString", "[", "\<\"[bla]\"\>", "]"}], ",", "_List"}], 
      "]"}]}], "]"}]}], "]"}]], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.610396901428975*^9, 3.6103969067571297`*^9}, 
   3.610397016905468*^9}],

Cell[BoxData[
 RowBox[{"passed", "[", 
  RowBox[{
   RowBox[{"\<\"path\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"Hold", "[", 
    RowBox[{"True", "===", 
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"parseString", "[", "\<\"[bla]\"\>", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\:0589top", ",", 
         RowBox[{"{", 
          RowBox[{"\:0589expression", ",", 
           RowBox[{"{", 
            RowBox[{"\:0589vector", ",", 
             RowBox[{"{", 
              RowBox[{"\:0589expression", ",", 
               RowBox[{"{", 
                RowBox[{"\:0589atom", ",", 
                 RowBox[{"{", 
                  RowBox[{"\:0589name", ",", "\<\"bla\"\>"}], "}"}]}], 
                "}"}]}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], "]"}]}], "]"}]}],
   "]"}]], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.610396901428975*^9, 3.6103969067571297`*^9}, 
   3.610397016908019*^9}],

Cell[BoxData[
 RowBox[{"passed", "[", 
  RowBox[{
   RowBox[{"\<\"path\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"Hold", "[", 
    RowBox[{"True", "===", 
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{
       "parseFile", 
        "[", "\<\"/Users/timothygardner/code/mathematica-clojure-analysis/clj-\
test-project/src/clj_test_project/core.clj\"\>", "]"}], ",", "_List"}], 
      "]"}]}], "]"}]}], "]"}]], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.610396901428975*^9, 3.6103969067571297`*^9}, 
   3.6103970169105053`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["AST Reference Graph", "Section",
 CellChangeTimes->{{3.610380516707426*^9, 3.610380541802712*^9}}],

Cell[CellGroupData[{

Cell["basic grammar patterns", "Subsection",
 CellChangeTimes->{{3.60800974132269*^9, 3.608009747238162*^9}, {
  3.610381996243292*^9, 3.610381996736763*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "makeDefiningForm", ",", "makeDefiningForm", ",", " ", 
   "definingFormScanRules", ",", "patternForName", ",", " ", 
   "patternForSymbol", ",", " ", "rawSymbolP", ",", "patternForRawSymbol", 
   ",", "patternForKeyword"}], "]"}]], "Input",
 CellChangeTimes->{{3.608010180669121*^9, 3.60801018317057*^9}, {
  3.608010536258876*^9, 3.608010550303502*^9}, {3.610381915235243*^9, 
  3.6103819170084047`*^9}, {3.6103819539942617`*^9, 3.6103819602426434`*^9}, {
  3.6103821223246107`*^9, 3.610382123757154*^9}, {3.61038434008671*^9, 
  3.610384341757854*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"whitespaceP", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\:0589whitespace", ",", " ", "___"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.608009724589842*^9, 3.608009752585112*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["nodifyShit", "Subsection",
 CellChangeTimes->{{3.6101239525085917`*^9, 3.610123954267015*^9}, {
  3.610133558989913*^9, 3.610133563172572*^9}, {3.6103897639533377`*^9, 
  3.610389767544018*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"nodifySymbols", ",", "nodifyKeywords"}], "]"}]], "Input",
 CellChangeTimes->{{3.610389415327939*^9, 3.61038942236966*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsPrefixSplit", "[", "s_String", "]"}], ":=", " ", 
  RowBox[{"StringSplit", "[", 
   RowBox[{"s", ",", "\"\</\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6103892365156193`*^9, 3.610389349503063*^9}}],

Cell[CellGroupData[{

Cell["nodifySymbols", "Subsubsection",
 CellChangeTimes->{{3.610389913824295*^9, 3.6103899168391943`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nodifySymbols", "[", "x_", "]"}], " ", ":=", "\n", " ", 
  RowBox[{"x", " ", "/.", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\:0589expression", ",", " ", 
      RowBox[{"{", 
       RowBox[{"\:0589atom", ",", " ", 
        RowBox[{"{", 
         RowBox[{"\:0589name", ",", " ", "n_"}], "}"}]}], "}"}]}], "}"}], " ",
     "\[RuleDelayed]", "\n", "   ", 
    RowBox[{"symb", "@@", 
     RowBox[{"nsPrefixSplit", "[", "n", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.61013313355956*^9, 3.6101331472361603`*^9}, {
  3.610133220121191*^9, 3.6101332403849916`*^9}, {3.610133272689056*^9, 
  3.610133303619236*^9}, {3.61013338339822*^9, 3.6101333890647907`*^9}, {
  3.610133423974848*^9, 3.610133443734373*^9}, {3.610389208244131*^9, 
  3.610389211234231*^9}, {3.610389324145833*^9, 3.610389364401016*^9}, {
  3.610389426105097*^9, 3.610389432929308*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["nodifyKeywords", "Subsubsection",
 CellChangeTimes->{{3.61038992891088*^9, 3.610389931214923*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nodifyKeywords", "[", "x_", "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"x", "/.", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\:0589expression", ",", 
      RowBox[{"{", 
       RowBox[{"\:0589atom", " ", ",", 
        RowBox[{"{", 
         RowBox[{"\:0589keyword", ",", " ", 
          RowBox[{"colon", ":", 
           RowBox[{"(", 
            RowBox[{"\"\<:\>\"", "|", "\"\<::\>\""}], ")"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\:0589name", ",", " ", "s_"}], "}"}]}], "}"}]}], "}"}]}], 
     "}"}], "\[RuleDelayed]", " ", "\[IndentingNewLine]", 
    RowBox[{"Switch", "[", 
     RowBox[{"colon", ",", "\[IndentingNewLine]", "\"\<:\>\"", ",", " ", 
      RowBox[{"keyword", "@@", 
       RowBox[{"nsPrefixSplit", "[", "s", "]"}]}], ",", 
      "\[IndentingNewLine]", "\"\<::\>\"", ",", 
      RowBox[{"keyword", "[", 
       RowBox[{"\"\<:\>\"", ",", "s"}], "]"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6103843549314337`*^9, 3.6103843808861523`*^9}, {
  3.610384442768669*^9, 3.6103844891354303`*^9}, {3.6103890534354057`*^9, 
  3.610389071795456*^9}, {3.6103891341917973`*^9, 3.610389197764686*^9}, {
  3.6103893835224*^9, 3.610389393224917*^9}, {3.6103973672075453`*^9, 
  3.610397457623191*^9}, {3.610397501208125*^9, 3.610397569029746*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nodifyKeywordsTests", "=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"is", "[", 
      RowBox[{
       RowBox[{"nodifyKeywords", "[", 
        RowBox[{"parseString", "[", "\"\<:bla\>\"", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\:0589top", ",", 
         RowBox[{"keyword", "[", "\"\<bla\>\"", "]"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"is", "[", 
      RowBox[{
       RowBox[{"nodifyKeywords", "[", 
        RowBox[{"parseString", "[", "\"\<::bla\>\"", "]"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"\:0589top", ",", 
         RowBox[{"keyword", "[", 
          RowBox[{"\"\<:\>\"", ",", "\"\<bla\>\""}], "]"}]}], "}"}]}], 
      "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.610397153003009*^9, 3.6103971910434313`*^9}, 
   3.610397289464691*^9, {3.610397325673052*^9, 3.6103973360601187`*^9}, {
   3.6103975958113613`*^9, 3.610397601291768*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "/@", 
   RowBox[{"runTests", "[", "nodifyKeywordsTests", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.610397201569222*^9, 3.6103972106723137`*^9}, {
  3.610397301737114*^9, 3.610397304584813*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"passed", "[", 
  RowBox[{
   RowBox[{"\<\"path\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"Hold", "[", 
    RowBox[{
     RowBox[{"nodifyKeywords", "[", 
      RowBox[{"parseString", "[", "\<\":bla\"\>", "]"}], "]"}], "===", 
     RowBox[{"{", 
      RowBox[{"\:0589top", ",", 
       RowBox[{"keyword", "[", "\<\"bla\"\>", "]"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Print",
 CellChangeTimes->{3.610397305368531*^9, 3.610397619284276*^9}],

Cell[BoxData[
 RowBox[{"passed", "[", 
  RowBox[{
   RowBox[{"\<\"path\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"Hold", "[", 
    RowBox[{
     RowBox[{"nodifyKeywords", "[", 
      RowBox[{"parseString", "[", "\<\"::bla\"\>", "]"}], "]"}], "===", 
     RowBox[{"{", 
      RowBox[{"\:0589top", ",", 
       RowBox[{"keyword", "[", 
        RowBox[{"\<\":\"\>", ",", "\<\"bla\"\>"}], "]"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Print",
 CellChangeTimes->{3.610397305368531*^9, 3.6103976192854557`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["nodifyDefiningForms", "Subsubsection",
 CellChangeTimes->{{3.610124050538212*^9, 3.610124055449048*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "getDefiniendum", ",", "getBody", ",", "getType", ",", "makeDefiningForm", 
   ",", "definingFormScanRules", ",", "nodifyDefiningForms"}], "]"}]], "Input",\

 CellChangeTimes->{{3.6103899537867117`*^9, 3.610389972338244*^9}, {
  3.610390086046054*^9, 3.6103900932781897`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getDefiniendum", "[", "df_definingForm", "]"}], ":=", " ", 
  RowBox[{"lookup", "[", 
   RowBox[{"df", ",", " ", "\"\<definiendum\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.61012385548418*^9, 3.6101238723014917`*^9}, {
  3.610390080846408*^9, 3.610390081981763*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getBody", "[", "df_definingForm", "]"}], ":=", 
  RowBox[{"lookup", "[", 
   RowBox[{"df", ",", " ", "\"\<definingForm\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6101239455598183`*^9, 3.6101239742506733`*^9}, {
  3.610390097285585*^9, 3.61039009807749*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getType", "[", "df_definingForm", "]"}], ":=", " ", 
  RowBox[{"lookup", "[", 
   RowBox[{"df", ",", " ", "\"\<type\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.610133692272962*^9, 3.610133701757765*^9}, {
  3.610390100005129*^9, 3.610390101469347*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeDefiningForm", "[", 
   RowBox[{
   "type_", ",", " ", "dfn_symb", ",", " ", "body_List", ",", " ", "src_"}], 
   "]"}], ":=", " ", 
  RowBox[{"definingForm", "[", 
   RowBox[{
    RowBox[{"\"\<type\>\"", "\[Rule]", " ", "type"}], ",", " ", 
    RowBox[{"\"\<definiendum\>\"", "\[Rule]", " ", "dfn"}], ",", " ", 
    RowBox[{"\"\<body\>\"", "\[Rule]", " ", "body"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6080100646760073`*^9, 3.608010116612092*^9}, {
   3.608010179465222*^9, 3.608010199334298*^9}, {3.608012811716507*^9, 
   3.6080128125549793`*^9}, 3.610125777707507*^9, {3.610126031294359*^9, 
   3.610126047472129*^9}, {3.6101336155872107`*^9, 3.610133616141873*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"definingFormScanRules", "=", "\[IndentingNewLine]", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\:0589list", ",", " ", 
        RowBox[{"symb", "[", "pfn", "]"}], ",", " ", "whitespaceP", ",", " ", 
        "n_symb", ",", " ", "body___"}], "}"}], "\[RuleDelayed]", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"makeDefiningForm", "[", 
       RowBox[{"pfn", ",", " ", "n", ",", " ", 
        RowBox[{"{", "body", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"pfn", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<defn\>\"", ",", " ", "\"\<def\>\"", ",", " ", "\"\<defmacro\>\"",
          ",", " ", "\"\<defprotocol\>\"", ",", " ", "\"\<defrecord\>\"", ",",
          " ", "\"\<deftype\>\"", ",", " ", "\"\<definline\>\""}], "}"}]}], 
      "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6080095517808943`*^9, 3.608009571394964*^9}, {
   3.608009636560701*^9, 3.608009723774322*^9}, {3.6080097574722233`*^9, 
   3.608009770159638*^9}, {3.60800984339017*^9, 3.608009900897378*^9}, {
   3.608009975626863*^9, 3.60801005233759*^9}, {3.6080101238056192`*^9, 
   3.608010168388673*^9}, {3.608010212116001*^9, 3.608010306276175*^9}, {
   3.6080111001565533`*^9, 3.6080111093125772`*^9}, 3.608011502721509*^9, 
   3.608012010281087*^9, 3.608012076423978*^9, 3.608012956507245*^9, {
   3.60801594887465*^9, 3.608015958742798*^9}, {3.608297205337489*^9, 
   3.60829720576772*^9}, {3.608297273066888*^9, 3.608297280448502*^9}, {
   3.608297314884486*^9, 3.6082974023157597`*^9}, {3.608297495997313*^9, 
   3.608297532897418*^9}, {3.60829808953855*^9, 3.608298114933289*^9}, {
   3.6082984337525873`*^9, 3.60829843701418*^9}, {3.610125786141089*^9, 
   3.610125789956212*^9}, {3.610125955082568*^9, 3.610126010335308*^9}, {
   3.610133583381769*^9, 3.610133591357136*^9}, {3.6101340172043123`*^9, 
   3.610134019960875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nodifyDefiningForms", "[", "asts_List", "]"}], ":=", 
  RowBox[{"asts", "//.", "definingFormScanRules"}]}]], "Input",
 CellChangeTimes->{{3.610124718281653*^9, 3.610124756697365*^9}, {
  3.6101256470855827`*^9, 3.6101256481736317`*^9}, {3.610126195121357*^9, 
  3.610126197921356*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["nodifyShit", "Subsubsection",
 CellChangeTimes->{{3.610389794809235*^9, 3.6103897962326317`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nodifyShit", "[", "xs_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"xs", "//", "nodifySymbols"}], "//", "nodifyKeywords"}], "//", 
    "nodifyDefiningForms"}], "//", "nodifyNsForms"}]}]], "Input",
 CellChangeTimes->{{3.6103898038474703`*^9, 3.61038983540722*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Subsubsection",
 CellChangeTimes->{{3.6103970843136044`*^9, 3.610397085447795*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nodifyKeywordsTest", "=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"is", "[", "]"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.610397090402515*^9, 3.610397106682571*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["nsForm", "Subsection",
 CellChangeTimes->{{3.610124059449298*^9, 3.610124060965234*^9}}],

Cell[CellGroupData[{

Cell["nsForm grammarz", "Subsubsection",
 CellChangeTimes->{{3.61038059639573*^9, 3.610380603538397*^9}, 
   3.6103842805841*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"patternForRequireForm", "[", "b_", "]"}], ":=", " ", 
  RowBox[{"{", 
   RowBox[{"\:0589list", ",", " ", 
    RowBox[{"keyword", "[", "\"\<require\>\"", "]"}], ",", " ", "b"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.610384255217174*^9, 3.610384306143506*^9}, {
  3.610384350759099*^9, 3.610384351822904*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"patternForRequireForm", "[", "_", "]"}]], "Input",
 CellChangeTimes->{{3.610384315967414*^9, 3.610384320173933*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\:0589list", ",", 
   RowBox[{"keyword", "[", "\<\"require\"\>", "]"}], ",", "_"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.610384320723712*^9, 3.610389446143785*^9, 
  3.610395275646275*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["nodifyNsForms", "Subsubsection",
 CellChangeTimes->{{3.610124063599979*^9, 3.610124076191874*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"requireForms", "[", "xs_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Cases", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.6103806630345907`*^9, 3.610380678323455*^9}, {
  3.610381825862803*^9, 3.61038186936353*^9}, {3.6103842400114717`*^9, 
  3.6103842523714733`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsFormRule", "=", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\:0589list", ",", 
      RowBox[{"patternForRawSymbol", "[", "\"\<ns\>\"", "]"}], ",", " ", 
      "whitespaceP", ",", " ", 
      RowBox[{"n", ":", "nameP"}], ",", " ", "body___"}], "}"}], 
    "\[RuleDelayed]", "\[IndentingNewLine]", 
    RowBox[{"let", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"requireForms", "=", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"qwikCases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "body", "}"}], "/.", "requireFormRule"}], ",", " ", 
            "_requireForm"}], "]"}], "/.", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"x", ":", 
              RowBox[{"{", "__", "}"}]}], "\[RuleDelayed]", " ", 
             RowBox[{"(", 
              RowBox[{"\"\<require\>\"", "\[Rule]", " ", "x"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"_", "\[RuleDelayed]", " ", 
             RowBox[{"Sequence", "[", "]"}]}]}], "}"}]}], ")"}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"nsForm", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<nsName\>\"", "\[Rule]", " ", "n"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"requireForms", "[", 
         RowBox[{"{", "body", "}"}], "]"}], ",", "\[IndentingNewLine]", " ", 
        RowBox[{"\"\<body\>\"", "\[Rule]", " ", 
         RowBox[{"{", "body", "}"}]}]}], "]"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.608400531799322*^9, 3.6084006121246347`*^9}, {
  3.608400809930704*^9, 3.608400849258622*^9}, {3.608401462512651*^9, 
  3.608401463759632*^9}, {3.608402170282304*^9, 3.608402191812846*^9}, {
  3.6084022255328407`*^9, 3.60840226452464*^9}, {3.608402308514462*^9, 
  3.608402314695986*^9}, {3.608402825162305*^9, 3.608402826128418*^9}, {
  3.608403119583777*^9, 3.608403151512114*^9}, {3.610132100123485*^9, 
  3.610132118767652*^9}, {3.610192612915125*^9, 3.610192620065321*^9}, {
  3.610193136090143*^9, 3.610193145889392*^9}, {3.61038062711932*^9, 
  3.6103806545277033`*^9}, {3.610381941198354*^9, 3.610381945093358*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nodifyNsForms", "[", "asts_List", "]"}], ":=", 
  RowBox[{"asts", "/.", "nsFormRule"}]}]], "Input",
 CellChangeTimes->{{3.610191953407207*^9, 3.610191962109563*^9}, {
   3.6101925981374073`*^9, 3.610192606344298*^9}, 3.610193468345676*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["nsData", "Subsection",
 CellChangeTimes->{{3.609855333414425*^9, 3.6098553405834227`*^9}, {
  3.610124103648223*^9, 3.6101241041672792`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"topDefs", "[", "nsd_nsData", "]"}], ":=", 
  RowBox[{"lookup", "[", 
   RowBox[{"nsd", ",", "\"\<topDefs\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.610124129854991*^9, 3.610124141344013*^9}}],

Cell[CellGroupData[{

Cell["toNsData", "Subsubsection",
 CellChangeTimes->{{3.6101241122487707`*^9, 3.6101241142951317`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"defsByNamespace", "[", "asts_List", "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"groupBy", "[", "\[IndentingNewLine]", 
    RowBox[{"First", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Reap", "[", "\[IndentingNewLine]", 
       RowBox[{"Fold", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ns", ",", " ", "x"}], "}"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{"x", ",", " ", "nsFormPattern"}], "]"}], ",", 
             "\[IndentingNewLine]", "x", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Sow", "[", 
               RowBox[{"{", 
                RowBox[{"ns", ",", "x"}], "}"}], "]"}], ";", "ns"}]}], 
            "]"}]}], "]"}], ",", "\[IndentingNewLine]", "\"\<user\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Cases", "[", 
          RowBox[{"asts", ",", 
           RowBox[{"(", 
            RowBox[{"nsFormPattern", "|", "definingFormPattern"}], ")"}], " ",
            ",", "\[Infinity]"}], "]"}]}], "]"}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"lhs_", " ", "\[Rule]", " ", "rhs_"}], ")"}], "\[RuleDelayed]", 
    " ", 
    RowBox[{"(", 
     RowBox[{"lhs", "\[Rule]", " ", 
      RowBox[{"rhs", "\[LeftDoubleBracket]", 
       RowBox[{";;", ",", "2"}], "\[RightDoubleBracket]"}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.609857006565221*^9, 3.6098570930440407`*^9}, 
   3.609872150217127*^9, {3.6100451789555893`*^9, 3.610045199241926*^9}, {
   3.610045248433338*^9, 3.610045250985991*^9}, 3.610073591124558*^9, {
   3.610073847015432*^9, 3.6100738965104933`*^9}, {3.610075386842208*^9, 
   3.6100754554698772`*^9}, {3.610075702867852*^9, 3.610075705779415*^9}}],

Cell["\<\
Extend the following to deal with \[OpenCurlyDoubleQuote]user\
\[CloseCurlyDoubleQuote] case when we know more about nsForms:\
\>", "Text",
 CellChangeTimes->{{3.610046127879725*^9, 3.610046142260689*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"toNsData", "[", "asts_List", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"defsByNamespace", "[", "asts", "]"}], "/.", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lhs_", "\[Rule]", " ", "rhs_"}], ")"}], "\[RuleDelayed]", 
     RowBox[{"nsData", "[", 
      RowBox[{
       RowBox[{"\"\<nsForm\>\"", "\[Rule]", " ", "lhs"}], ",", 
       RowBox[{"\"\<topDefs\>\"", "\[Rule]", " ", "rhs"}]}], "]"}]}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.609856579204216*^9, 3.6098569940827913`*^9}, 
   3.609857032414054*^9, {3.609872201299589*^9, 3.609872201659171*^9}, {
   3.610045562864251*^9, 3.610045668311777*^9}, {3.610045761444873*^9, 
   3.610045890721991*^9}, {3.6100460488807783`*^9, 3.6100460795593233`*^9}, {
   3.610046112582726*^9, 3.610046123344037*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"namespaceName", "[", "nsdt_nsData", "]"}], ":=", " ", 
  RowBox[{"namespaceName", "[", 
   RowBox[{"lookup", "[", 
    RowBox[{"nsdt", ",", " ", "\"\<nsForm\>\""}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.610045914137578*^9, 3.6100459477681017`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["expandVars", "Subsection",
 CellChangeTimes->{{3.609855287468993*^9, 3.609855289268463*^9}}],

Cell[CellGroupData[{

Cell["expandIntranamespaceVars", "Subsubsection",
 CellChangeTimes->{{3.6098152185964193`*^9, 3.609815223027438*^9}, {
  3.609851639972869*^9, 3.609851640564426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"varMap", "[", "nsd_nsData", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ns", "=", 
      RowBox[{"namespaceName", "[", "nsd", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", "\[Rule]", " ", 
        RowBox[{"symb", "[", 
         RowBox[{"ns", ",", " ", "#"}], "]"}]}], "&"}], ")"}], "/@", 
     RowBox[{"definedSymbol", "/@", 
      RowBox[{"lookup", "[", 
       RowBox[{"\"\<topDefs\>\"", ",", " ", "nsd"}], "]"}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.609815315819428*^9, 3.6098153168268137`*^9}, {
   3.6098153650400143`*^9, 3.609815399185444*^9}, {3.609850419698848*^9, 
   3.609850469002906*^9}, {3.6098505027528677`*^9, 3.609850645201371*^9}, 
   3.609850802192239*^9, 3.6098509462584047`*^9, {3.6098510285632153`*^9, 
   3.609851169399253*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandIntranamespaceVars", "[", 
   RowBox[{"nsds", ":", 
    RowBox[{"{", "__nsData", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Map", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"nsd", ",", "\[IndentingNewLine]", 
      RowBox[{"update", "[", 
       RowBox[{"nsd", ",", " ", "\"\<topDefs\>\"", ",", " ", 
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{"varMap", "[", "nsd", "]"}]}], "&"}]}], "]"}]}], "]"}], ",",
     "\[IndentingNewLine]", "nsds"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.609815225491095*^9, 3.6098153076208353`*^9}, {
  3.609815408537516*^9, 3.609815458935131*^9}, {3.609815592775528*^9, 
  3.6098156015023823`*^9}, {3.6098156460241537`*^9, 3.609815650381631*^9}, {
  3.6098491326564283`*^9, 3.6098491529232693`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["expandAliasedVars", "Subsubsection",
 CellChangeTimes->{{3.60981514956483*^9, 3.609815169300709*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"aliasMap", "[", "nsd_nsData", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Cases", "[", 
   RowBox[{",", ",", "\[Infinity]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.609812578526408*^9, 3.609812580023767*^9}, {
  3.60981270214229*^9, 3.609812735518283*^9}, {3.609815388225656*^9, 
  3.609815393808457*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"aliasVarMap", "[", "nsd_nsData", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"aliasMap", "[", "nsd", "]"}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a_", " ", "\[Rule]", " ", "ns_"}], ")"}], "\[RuleDelayed]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"symb", "[", 
       RowBox[{"a", ",", " ", "nm_"}], "]"}], 
      AdjustmentBox["\[RuleDelayed]",
       BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 0.}}], 
      AdjustmentBox[" ",
       BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 0.}}], 
      RowBox[{
       AdjustmentBox["symb",
        BoxMargins->{{-0.2306929800847076, 0.2306929800847076}, {0., 0.}}], 
       AdjustmentBox["[",
        BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 0.}}], 
       
       AdjustmentBox[
        RowBox[{"ns", ",", " ", "nm"}],
        BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 0.}}], 
       
       AdjustmentBox["]",
        BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 
         0.}}]}]}], 
     AdjustmentBox[")",
      BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 
       0.}}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.6097945619550743`*^9, 3.609794567004404*^9}, {
   3.609794649130281*^9, 3.60979465053793*^9}, 3.6097947549991198`*^9, {
   3.609795044201004*^9, 3.609795089312398*^9}, {3.609795504470194*^9, 
   3.609795722082026*^9}, {3.6097957932446527`*^9, 3.609795799598997*^9}, {
   3.6097959068441133`*^9, 3.609796209669504*^9}, {3.6097964195712633`*^9, 
   3.609796446320644*^9}, {3.609796702690351*^9, 3.609796730994379*^9}, {
   3.60979680012842*^9, 3.6097968196793213`*^9}, {3.6097969502383003`*^9, 
   3.60979695226099*^9}, {3.609796987100778*^9, 3.609797008330043*^9}, {
   3.6097972286472893`*^9, 3.609797228877557*^9}, {3.609797435352722*^9, 
   3.6097974427525806`*^9}, {3.609812233048337*^9, 3.6098122589750423`*^9}, {
   3.609813038418571*^9, 3.609813132990275*^9}, {3.609813193002799*^9, 
   3.609813196827655*^9}, {3.6098134113079643`*^9, 3.6098134313049803`*^9}, {
   3.609814268737215*^9, 3.609814271735549*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandAliasedVars", "[", 
   RowBox[{"nsds", ":", 
    RowBox[{"{", "__nsData", "}"}]}], "]"}], ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"Map", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"nsd", ",", "\[IndentingNewLine]", 
      RowBox[{"update", "[", 
       RowBox[{"nsd", ",", " ", "\"\<topDefs\>\"", ",", " ", 
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{"aliasVarMap", "[", "nsd", "]"}]}], "&"}]}], "]"}]}], "]"}],
     ",", "\[IndentingNewLine]", "nsds"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.609794011345903*^9, 3.609794232188349*^9}, {
  3.609794294595677*^9, 3.609794322082171*^9}, {3.609794363137237*^9, 
  3.609794364802099*^9}, {3.609794395297037*^9, 3.609794558268877*^9}, {
  3.609794747552103*^9, 3.6097948070785017`*^9}, {3.6097950346178417`*^9, 
  3.609795040377336*^9}, {3.609795763603141*^9, 3.6097957895130053`*^9}, {
  3.6097960781384783`*^9, 3.6097960793499527`*^9}, {3.609796656051499*^9, 
  3.6097966965552464`*^9}, {3.6098140238352623`*^9, 3.6098140239859037`*^9}, {
  3.6098148470005283`*^9, 3.609814847727777*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["expandVars", "Subsubsection",
 CellChangeTimes->{{3.609855308477116*^9, 3.609855310395756*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandVars", "[", 
   RowBox[{"nsds", ":", 
    RowBox[{"{", "___nsData", "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"nsds", "//", "nodifySymbols"}], "//", "expandAliasedVars"}], "//",
    "expandIntranamespaceVars"}]}]], "Input",
 CellChangeTimes->{{3.609793257408784*^9, 3.609793282927454*^9}, 
   3.609793313689014*^9, {3.609793378103998*^9, 3.60979341903165*^9}, {
   3.6097935374926043`*^9, 3.609793548052568*^9}, {3.60979724048482*^9, 
   3.609797251773683*^9}, {3.6097972883234043`*^9, 3.609797290619759*^9}, {
   3.609811934567346*^9, 3.609811936418545*^9}, {3.609813121693036*^9, 
   3.6098131238855743`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["nsGraph", "Subsection",
 CellChangeTimes->{{3.6100774110303507`*^9, 3.6100774126282797`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"defrefs", "[", "df_definingForm", "]"}], ":=", 
  RowBox[{"qwikCases", "[", 
   RowBox[{
    RowBox[{"body", "[", "df", "]"}], ",", "_symb"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.610077914602257*^9, 3.610077923103558*^9}, {
  3.610078010667119*^9, 3.610078026165422*^9}, {3.6100780632672586`*^9, 
  3.610078073473043*^9}, {3.610079796783955*^9, 3.610079797612877*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"defGraph", "[", "df_definingForm", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d", "=", 
      RowBox[{"definiendum", "[", "df", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graph", "[", 
     RowBox[{
      RowBox[{"{", "d", "}"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", "\[DirectedEdge]", "#"}], "&"}], ")"}], "/@", 
       RowBox[{"defrefs", "[", "df", "]"}]}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.610077780496315*^9, 3.610077870134404*^9}, {
  3.610078322625333*^9, 3.6100783319600363`*^9}, {3.6100784357058372`*^9, 
  3.610078436586287*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsGraph", "[", "nsdt_nsData", "]"}], ":=", 
  RowBox[{"GraphUnion", " ", "@@", 
   RowBox[{"(", 
    RowBox[{"defGraph", "/@", 
     RowBox[{"topDefs", "[", "nsdt", "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.610077500196782*^9, 3.610077513611018*^9}, {
  3.610077547370698*^9, 3.610077548268529*^9}, {3.610077594518313*^9, 
  3.6100777774720297`*^9}, {3.610079015592778*^9, 3.610079025654418*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsGraph", "[", 
   RowBox[{"nsdts", ":", 
    RowBox[{"{", "___nsData", "}"}]}], "]"}], ":=", 
  RowBox[{"GraphUnion", " ", "@@", 
   RowBox[{"(", 
    RowBox[{"nsGraph", "/@", "nsdts"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.610077426069775*^9, 3.610077493530346*^9}, {
  3.61007903158296*^9, 3.610079045541662*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["graphProject", "Subsection",
 CellChangeTimes->{{3.609855294524439*^9, 3.6098552974999743`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphProject", "[", "asts_List", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"asts", "//", "nodifyShit"}], "//", "toNsData"}], "//", 
    "expandVars"}], "//", "nsGraph"}]}]], "Input",
 CellChangeTimes->{{3.60979342796974*^9, 3.609793453469955*^9}, {
  3.60979349000483*^9, 3.609793562452132*^9}, {3.609856608212119*^9, 
  3.60985660992583*^9}, {3.610124022356863*^9, 3.6101240400660267`*^9}, {
  3.610133015296801*^9, 3.610133017512093*^9}, {3.610389733251082*^9, 
  3.610389737163827*^9}, {3.6103898426864243`*^9, 3.610389844553645*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphProject", "[", "projectPath_String", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"projectPath", "//", "parseProject"}], "//", 
   "graphProject"}]}]], "Input",
 CellChangeTimes->{{3.6097936669693937`*^9, 3.609793723904351*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{960, 1156},
WindowMargins->{{Automatic, -224}, {896, Automatic}},
ShowSelection->True,
InputAutoReplacements->{
 "\\" -> "\:2024", "--" -> "\:2011", "-=" -> "\:02cd", "''" -> "\:0589", "**" -> 
  "\:204e", "\[DownQuestion]" -> "\:2047", "!!" -> "\:203c"},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"menloExperiment.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 95, 1, 30, "Input"],
Cell[655, 23, 177, 3, 33, "Input",
 InitializationCell->True],
Cell[835, 28, 274, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[1134, 35, 119, 2, 80, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1278, 41, 133, 2, 44, "Subsection",
 InitializationCell->True],
Cell[1414, 45, 372, 9, 28, "Input",
 InitializationCell->True],
Cell[1789, 56, 819, 21, 148, "Input",
 InitializationCell->True],
Cell[2611, 79, 232, 5, 28, "Input",
 InitializationCell->True],
Cell[2846, 86, 185, 4, 28, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[3068, 95, 118, 2, 36, "Subsection",
 InitializationCell->True],
Cell[3189, 99, 155, 3, 33, "Input",
 InitializationCell->True],
Cell[3347, 104, 196, 4, 33, "Input",
 InitializationCell->True],
Cell[3546, 110, 891, 23, 75, "Input",
 InitializationCell->True],
Cell[4440, 135, 244, 7, 31, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[4709, 146, 278, 8, 30, "Input",
 InitializationCell->True],
Cell[4990, 156, 483, 7, 70, "Output",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[5522, 169, 179, 3, 36, "Subsection",
 InitializationCell->True],
Cell[5704, 174, 324, 8, 28, "Input",
 InitializationCell->True],
Cell[6031, 184, 128, 2, 29, "Text",
 InitializationCell->True],
Cell[6162, 188, 313, 7, 28, "Input",
 InitializationCell->True],
Cell[6478, 197, 398, 11, 28, "Input",
 InitializationCell->True],
Cell[6879, 210, 286, 7, 28, "Input",
 InitializationCell->True],
Cell[7168, 219, 258, 7, 28, "Input",
 InitializationCell->True],
Cell[7429, 228, 125, 2, 29, "Text",
 InitializationCell->True],
Cell[7557, 232, 453, 11, 28, "Input",
 InitializationCell->True],
Cell[8013, 245, 1257, 33, 131, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[9307, 283, 180, 3, 36, "Subsection",
 InitializationCell->True],
Cell[9490, 288, 364, 8, 31, "Input",
 InitializationCell->True],
Cell[9857, 298, 436, 11, 31, "Input",
 InitializationCell->True],
Cell[10296, 311, 392, 9, 31, "Input",
 InitializationCell->True],
Cell[10691, 322, 430, 11, 33, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[11158, 338, 123, 2, 36, "Subsection",
 InitializationCell->True],
Cell[11284, 342, 301, 6, 30, "Text",
 InitializationCell->True],
Cell[11588, 350, 617, 13, 33, "Input",
 InitializationCell->True],
Cell[12208, 365, 1598, 32, 67, "Input",
 InitializationCell->True],
Cell[13809, 399, 701, 15, 30, "Input",
 InitializationCell->True],
Cell[14513, 416, 466, 13, 31, "Input",
 InitializationCell->True],
Cell[14982, 431, 2318, 50, 111, "Input",
 InitializationCell->True],
Cell[17303, 483, 1213, 22, 31, "Input",
 InitializationCell->True],
Cell[18519, 507, 278, 7, 30, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[18834, 519, 120, 2, 44, "Subsection",
 InitializationCell->True],
Cell[18957, 523, 258, 7, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[19252, 535, 122, 2, 36, "Subsection",
 InitializationCell->True],
Cell[19377, 539, 284, 8, 31, "Input",
 InitializationCell->True],
Cell[19664, 549, 1045, 25, 94, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[20734, 578, 1215, 31, 125, "Input",
 InitializationCell->True],
Cell[21952, 611, 1921, 47, 74, "Output",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23934, 665, 118, 2, 80, "Section",
 InitializationCell->True],
Cell[24055, 669, 360, 7, 49, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[24440, 680, 119, 2, 44, "Subsection",
 InitializationCell->True],
Cell[24562, 684, 397, 10, 33, "Input",
 InitializationCell->True],
Cell[24962, 696, 245, 4, 33, "Input",
 InitializationCell->True],
Cell[25210, 702, 886, 17, 53, "Input",
 InitializationCell->True],
Cell[26099, 721, 220, 4, 33, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[26356, 730, 121, 2, 44, "Subsection",
 InitializationCell->True],
Cell[26480, 734, 226, 5, 30, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[26731, 743, 160, 3, 31, "Input",
 InitializationCell->True],
Cell[26894, 748, 333, 6, 70, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[27242, 757, 268, 6, 31, "Input",
 InitializationCell->True],
Cell[27513, 765, 285, 7, 33, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[27835, 777, 128, 2, 36, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[27988, 783, 479, 10, 73, "Input",
 InitializationCell->True],
Cell[28470, 795, 404, 7, 70, "Output",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[28935, 809, 121, 2, 50, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[29081, 815, 122, 2, 44, "Subsection",
 InitializationCell->True],
Cell[29206, 819, 340, 7, 49, "Text",
 InitializationCell->True],
Cell[29549, 828, 367, 9, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[29941, 841, 157, 3, 31, "Input",
 InitializationCell->True],
Cell[30101, 846, 212, 3, 70, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[30350, 854, 214, 4, 31, "Input",
 InitializationCell->True],
Cell[30567, 860, 252, 4, 70, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[30856, 869, 164, 4, 33, "Input",
 InitializationCell->True],
Cell[31023, 875, 408, 9, 70, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[31468, 889, 161, 3, 31, "Input",
 InitializationCell->True],
Cell[31632, 894, 216, 3, 70, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[31885, 902, 344, 8, 33, "Input",
 InitializationCell->True],
Cell[32232, 912, 406, 9, 70, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[32675, 926, 157, 3, 31, "Input",
 InitializationCell->True],
Cell[32835, 931, 211, 3, 70, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[33061, 937, 232, 5, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[33318, 946, 278, 5, 31, "Input",
 InitializationCell->True],
Cell[33599, 953, 258, 5, 70, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[33872, 961, 241, 5, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[34138, 970, 243, 5, 33, "Input",
 InitializationCell->True],
Cell[34384, 977, 413, 9, 70, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[34834, 991, 159, 3, 31, "Input",
 InitializationCell->True],
Cell[34996, 996, 213, 3, 70, "Output",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[35258, 1005, 126, 2, 36, "Subsection",
 InitializationCell->True],
Cell[35387, 1009, 482, 12, 34, "Text",
 InitializationCell->True],
Cell[35872, 1023, 337, 8, 33, "Input",
 InitializationCell->True],
Cell[36212, 1033, 263, 6, 33, "Input",
 InitializationCell->True],
Cell[36478, 1041, 654, 16, 33, "Input",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[37181, 1063, 129, 2, 50, "Section",
 InitializationCell->True],
Cell[37313, 1067, 192, 4, 30, "Text",
 InitializationCell->True],
Cell[37508, 1073, 196, 4, 33, "Input",
 InitializationCell->True],
Cell[37707, 1079, 267, 6, 33, "Input",
 InitializationCell->True],
Cell[37977, 1087, 351, 8, 33, "Input",
 InitializationCell->True],
Cell[38331, 1097, 310, 7, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[38666, 1108, 122, 2, 44, "Subsection",
 InitializationCell->True],
Cell[38791, 1112, 1730, 43, 193, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[40546, 1159, 267, 6, 31, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[40838, 1169, 455, 13, 26, "Print",
 InitializationCell->True],
Cell[41296, 1184, 943, 26, 46, "Print",
 InitializationCell->True],
Cell[42242, 1212, 571, 16, 66, "Print",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[42886, 1236, 104, 1, 50, "Section"],
Cell[CellGroupData[{
Cell[43015, 1241, 158, 2, 44, "Subsection"],
Cell[43176, 1245, 609, 11, 53, "Input"],
Cell[43788, 1258, 219, 5, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44044, 1268, 200, 3, 44, "Subsection"],
Cell[44247, 1273, 174, 3, 33, "Input"],
Cell[44424, 1278, 240, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[44689, 1287, 106, 1, 35, "Subsubsection"],
Cell[44798, 1290, 894, 19, 67, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45729, 1314, 104, 1, 35, "Subsubsection"],
Cell[45836, 1317, 1349, 29, 128, "Input"],
Cell[47188, 1348, 984, 24, 72, "Input"],
Cell[CellGroupData[{
Cell[48197, 1376, 243, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[48465, 1385, 476, 13, 26, "Print"],
Cell[48944, 1400, 516, 14, 26, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49521, 1421, 110, 1, 35, "Subsubsection"],
Cell[49634, 1424, 330, 7, 33, "Input"],
Cell[49967, 1433, 307, 6, 31, "Input"],
Cell[50277, 1441, 298, 6, 31, "Input"],
Cell[50578, 1449, 292, 6, 31, "Input"],
Cell[50873, 1457, 716, 14, 49, "Input"],
Cell[51592, 1473, 1976, 36, 109, "Input"],
Cell[53571, 1511, 320, 6, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53928, 1522, 103, 1, 35, "Subsubsection"],
Cell[54034, 1525, 324, 8, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54395, 1538, 98, 1, 35, "Subsubsection"],
Cell[54496, 1541, 223, 5, 49, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[54768, 1552, 94, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[54887, 1557, 129, 2, 35, "Subsubsection"],
Cell[55019, 1561, 349, 8, 33, "Input"],
Cell[CellGroupData[{
Cell[55393, 1573, 140, 2, 31, "Input"],
Cell[55536, 1577, 233, 6, 33, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55818, 1589, 104, 1, 35, "Subsubsection"],
Cell[55925, 1592, 310, 6, 49, "Input"],
Cell[56238, 1600, 2285, 48, 225, "Input"],
Cell[58526, 1650, 274, 5, 31, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[58849, 1661, 147, 2, 44, "Subsection"],
Cell[58999, 1665, 232, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[59256, 1674, 103, 1, 35, "Subsubsection"],
Cell[59362, 1677, 2033, 47, 237, "Input"],
Cell[61398, 1726, 215, 4, 30, "Text"],
Cell[61616, 1732, 858, 18, 69, "Input"],
Cell[62477, 1752, 293, 6, 33, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[62819, 1764, 98, 1, 36, "Subsection"],
Cell[CellGroupData[{
Cell[62942, 1769, 166, 2, 35, "Subsubsection"],
Cell[63111, 1773, 931, 23, 71, "Input"],
Cell[64045, 1798, 847, 18, 103, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64929, 1821, 107, 1, 35, "Subsubsection"],
Cell[65039, 1824, 346, 7, 49, "Input"],
Cell[65388, 1833, 2165, 45, 49, "Input"],
Cell[67556, 1880, 1146, 22, 111, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68739, 1907, 101, 1, 35, "Subsubsection"],
Cell[68843, 1910, 668, 14, 49, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[69560, 1930, 99, 1, 36, "Subsection"],
Cell[69662, 1933, 408, 8, 31, "Input"],
Cell[70073, 1943, 721, 20, 67, "Input"],
Cell[70797, 1965, 441, 9, 31, "Input"],
Cell[71241, 1976, 357, 9, 31, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[71635, 1990, 102, 1, 36, "Subsection"],
Cell[71740, 1993, 598, 12, 31, "Input"],
Cell[72341, 2007, 264, 6, 31, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
