(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    193819,       5383]
NotebookOptionsPosition[    169646,       4594]
NotebookOutlinePosition[    170202,       4614]
CellTagsIndexPosition[    170159,       4611]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.61039017736975*^9, 3.610390177870949*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<AssociativeUtils`\>\"", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610123880820364*^9, 3.6101238866531343`*^9}}],

Cell["Basically a big map-reduce. Like everything.", "Text",
 CellChangeTimes->{{3.609797485921159*^9, 3.6097974999096317`*^9}, {
  3.609813155635564*^9, 3.6098131579152527`*^9}, {3.610079925420598*^9, 
  3.61007993204767*^9}, {3.6101239253032837`*^9, 3.61012392733926*^9}}],

Cell[CellGroupData[{

Cell["Utils", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.610380546882833*^9, 3.6103805472338943`*^9}}],

Cell[CellGroupData[{

Cell["General Predicates", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.597034006338381*^9, 3.597034043144265*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"notFalseQ", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"!", 
   RowBox[{"(", 
    RowBox[{"x", "  ", "===", " ", "False"}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.596812217777191*^9, 3.596812243885096*^9}, {
  3.596812285218401*^9, 3.596812338290038*^9}, {3.599210785039962*^9, 
  3.599210795757633*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"everyQ", "[", 
   RowBox[{"pred_", ",", " ", "xs_"}], "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "sentinel", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Catch", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Fold", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"pred", "[", "#2", "]"}], ",", " ", "True", ",", " ", 
           RowBox[{"Throw", "[", 
            RowBox[{"False", ",", " ", "sentinel"}], "]"}]}], "]"}], "&"}], 
        ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
        "xs"}], "]"}], ",", "\[IndentingNewLine]", "sentinel"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"thingQ", "[", "]"}], ":=", " ", "False"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598385035980755*^9, 3.5983850379279013`*^9}, {
  3.59838515429491*^9, 3.5983851684288387`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"thingQ", "[", "__", "]"}], ":=", " ", "True"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598385170015087*^9, 3.598385179306218*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["let", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.598144549488331*^9, 3.598144552679078*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "let", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598144556156847*^9, 3.5981445587366447`*^9}}],

Cell[BoxData[
 RowBox[{"SetAttributes", "[", 
  RowBox[{"let", ",", " ", "HoldAll"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.59814456764146*^9, 3.5981445840324793`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"let", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"HoldPattern", "[", 
       RowBox[{"Set", "[", 
        RowBox[{"lhs_", " ", ",", " ", "rhs_"}], "]"}], "]"}], ",", " ", 
      "rst___"}], "}"}], ",", " ", "body___"}], "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lhs", " ", "=", " ", "rhs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"let", "[", 
     RowBox[{
      RowBox[{"{", "rst", "}"}], ",", " ", "body"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598144588165823*^9, 3.598144588720389*^9}, {
   3.598144632230338*^9, 3.598144822971513*^9}, 3.598144954215612*^9, {
   3.610390258256772*^9, 3.610390271647736*^9}, {3.6103903506519003`*^9, 
   3.610390393691846*^9}, {3.610390656296183*^9, 3.610390724617317*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"let", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", " ", "body___"}], "]"}], " ", ":=", " ", 
  "body"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598144825527643*^9, 3.598144838775177*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"let", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "=", "b"}], ",", 
     RowBox[{"c", "=", "a"}]}], "}"}], ",", " ", "c"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610390285858336*^9, 3.610390293410934*^9}}],

Cell[BoxData["b"], "Output",
 CellChangeTimes->{
  3.614890763810931*^9, {3.614890887957629*^9, 3.614890899028021*^9}, 
   3.6149645918020067`*^9, 3.615671534089706*^9, 3.615776255885008*^9, 
   3.6176515639379187`*^9, 3.618156489467951*^9, 3.6185016462300673`*^9, 
   3.619495948515275*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["cons car cdr, motherfuckers", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.601820276801179*^9, 3.601820279936575*^9}, {
  3.601821679757131*^9, 3.601821679899549*^9}, {3.603580761464801*^9, 
  3.603580763439166*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"cons", ",", "car", ",", "cdr"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60358083664914*^9, 3.60358084056183*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cons", "[", 
   RowBox[{"x_", ",", " ", "ys_"}], "]"}], ":=", " ", 
  RowBox[{"Prepend", "[", 
   RowBox[{"ys", ",", " ", "x"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.601820283310053*^9, 3.601820296545106*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cons", "[", 
   RowBox[{"x_", ",", " ", "Null"}], "]"}], ":=", " ", 
  RowBox[{"{", "x", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603580943873818*^9, 3.6035809506518097`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"car", "[", 
   RowBox[{"_", "[", 
    RowBox[{"x_", ",", " ", "___"}], "]"}], "]"}], ":=", " ", "x"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.603580768994233*^9, 3.6035807888061028`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"car", "[", 
   RowBox[{
    RowBox[{"_", "[", "]"}], "|", "Null"}], "]"}], ":=", " ", 
  "Null"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603580792195797*^9, 3.603580833730596*^9}, {
  3.60358097401762*^9, 3.603580977856132*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cdr", "[", 
   RowBox[{"h_", "[", 
    RowBox[{"_", ",", " ", "xs___"}], "]"}], "]"}], ":=", " ", 
  RowBox[{"h", "[", "xs", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60358084760105*^9, 3.603580920499197*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cdr", "[", 
   RowBox[{"h_", "[", "]"}], "]"}], ":=", " ", "Null"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6035809070870857`*^9, 3.603580928533145*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["repeatedly", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.603593114724972*^9, 3.6035931170831127`*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "repeatedly", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603593390290503*^9, 3.60359339519314*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"repeatedly", "[", 
   RowBox[{"f_", ",", " ", "args___", ",", " ", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Reap", "[", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"Sow", "[", 
       RowBox[{"f", "[", "args", "]"}], "]"}], ",", 
      RowBox[{"{", "n", "}"}]}], "]"}], "]"}], "\[LeftDoubleBracket]", 
   RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603495404951297*^9, 3.603495469265127*^9}, {
  3.603593128932502*^9, 3.603593159289372*^9}, {3.603593218026534*^9, 
  3.6035933021551456`*^9}, {3.60359334045612*^9, 3.603593349502874*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"repeatedly", "[", 
   RowBox[{"f_", ",", " ", "args___", ",", " ", "0"}], "]"}], ":=", " ", 
  RowBox[{"{", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603593353087674*^9, 3.6035933614890957`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Other Shit", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6103888288639107`*^9, 3.6103888296379347`*^9}, {
  3.610394373657957*^9, 3.6103943752964363`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qwikCases", "[", 
   RowBox[{"expr_", ",", " ", "frm_"}], "]"}], ":=", 
  RowBox[{"Cases", "[", 
   RowBox[{"expr", ",", " ", "frm", ",", " ", "\[Infinity]", ",", " ", 
    RowBox[{"Heads", "\[Rule]", " ", "True"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610078125264853*^9, 3.610078163563168*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qwikPartition", "[", 
   RowBox[{"x_", ",", "n_", ",", "off_"}], "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{"x", ",", "n", ",", "off", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610387596067012*^9, 3.610387609416251*^9}, {
  3.610391801024932*^9, 3.6103918085904016`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qwikPartition", "[", 
   RowBox[{"x_", ",", " ", "n_"}], "]"}], ":=", " ", 
  RowBox[{"qwikPartition", "[", 
   RowBox[{"x", ",", "n", ",", "n"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.61038752155919*^9, 3.610387550698324*^9}, {
  3.610387581863616*^9, 3.610387586880423*^9}, {3.6103876215757504`*^9, 
  3.610387627990704*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"columnate", "[", 
   RowBox[{"x_", ",", " ", "rows_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"Partition", "[", 
    RowBox[{"x", ",", "rows", ",", "rows", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", "Null", "}"}]}], "]"}], "//", "Transpose"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610388342265007*^9, 3.610388400090472*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.60287912501143*^9, 3.6028791294169083`*^9}}],

Cell["\<\
Dependency-free (associative utils may help construct test batteries, though).\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6029019081698933`*^9, 3.6029019221833897`*^9}, {
  3.602902121458291*^9, 3.602902121729105*^9}, {3.6037398631089163`*^9, 
  3.6037398868866987`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "testWalk", ",", "runTests", ",", " ", "is", ",", " ", "notFound", ",", 
    "passed", ",", "failed"}], "]"}], ";", 
  RowBox[{
   RowBox[{"Attributes", "[", "is", "]"}], "=", " ", 
   RowBox[{"{", "HoldAll", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60289721224224*^9, 3.602897235034136*^9}, {
   3.602901109624857*^9, 3.602901112614876*^9}, {3.602902492834633*^9, 
   3.6029024963810883`*^9}, {3.602902724011547*^9, 3.6029027289262123`*^9}, {
   3.6029067835510406`*^9, 3.602906798016685*^9}, 3.610395158262672*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testWalk", "[", 
   RowBox[{"tests_", ",", "behind_", ",", " ", "ahead_"}], " ", "]"}], ":=", 
  " ", "\[IndentingNewLine]", 
  RowBox[{"testWalk", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "[", "ahead", "]"}], "/.", 
     RowBox[{"Append", "[", 
      RowBox[{"tests", ",", " ", 
       RowBox[{"_", " ", "\[RuleDelayed]", " ", 
        RowBox[{"Throw", "[", 
         RowBox[{"notFound", "[", 
          RowBox[{
           RowBox[{"\"\<behind\>\"", "\[Rule]", "behind"}], ",", " ", 
           RowBox[{"\"\<ahead\>\"", "\[Rule]", " ", "ahead"}]}], " ", "]"}], 
         "]"}]}]}], "]"}]}], ",", " ", 
    RowBox[{"Append", "[", 
     RowBox[{"behind", ",", " ", 
      RowBox[{"First", "[", "ahead", "]"}]}], "]"}], ",", " ", 
    RowBox[{"Rest", "[", "ahead", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.602897489731139*^9, 3.602897638201522*^9}, {
   3.6028976866089153`*^9, 3.602897699774631*^9}, 3.602897831244113*^9, {
   3.6028983761544943`*^9, 3.602898382074605*^9}, {3.602898424774269*^9, 
   3.602898444494355*^9}, {3.602898745659721*^9, 3.602898859893244*^9}, {
   3.602898895604669*^9, 3.602898919290853*^9}, {3.6028990821227837`*^9, 
   3.602899119593362*^9}, {3.60289915474638*^9, 3.602899232028389*^9}, {
   3.602899334625546*^9, 3.602899335169456*^9}, {3.60290193407292*^9, 
   3.602901939267617*^9}, {3.6029020900389233`*^9, 3.602902110551862*^9}, {
   3.6029023490362453`*^9, 3.6029023616421328`*^9}, {3.602902480513864*^9, 
   3.6029024862113533`*^9}, {3.602902645079198*^9, 3.602902658496421*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testWalk", "[", 
   RowBox[{"tests_", ",", " ", "behind_", ",", " ", 
    RowBox[{"{", "}"}]}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"testWalk", "[", 
     RowBox[{"#", ",", "behind", ",", 
      RowBox[{"{", "}"}]}], "]"}], "&"}], "/@", "tests"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.602897833142717*^9, 3.602897868811491*^9}, {
  3.602898583820779*^9, 3.6028986232873793`*^9}, {3.6028986611938133`*^9, 
  3.6028986911617002`*^9}, {3.602901183668252*^9, 3.602901186307152*^9}, {
  3.602905943236911*^9, 3.602905958675108*^9}, {3.602906047681364*^9, 
  3.602906048785495*^9}, {3.6029061166709948`*^9, 3.602906149332719*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testWalk", "[", 
   RowBox[{
    RowBox[{"r_", " ", "\[Rule]", " ", "m_"}], ",", " ", "behind_", ",", " ", 
    
    RowBox[{"{", "}"}]}], "]"}], ":=", 
  RowBox[{"testWalk", "[", 
   RowBox[{"m", ",", " ", 
    RowBox[{"Append", "[", 
     RowBox[{"behind", ",", " ", "r"}], "]"}], ",", " ", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.602898445575198*^9, 3.602898564319623*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testWalk", "[", 
   RowBox[{"isForm_is", ",", " ", "behind_", ",", " ", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"SameQ", "@@", "isForm"}], ")"}], ",", "\[IndentingNewLine]", 
    RowBox[{"passed", "[", 
     RowBox[{
      RowBox[{"\"\<path\>\"", "\[Rule]", "behind"}], ",", 
      RowBox[{"Replace", "[", 
       RowBox[{"isForm", ",", " ", 
        RowBox[{
         RowBox[{"is", "[", "xs___", "]"}], "\[RuleDelayed]", " ", 
         RowBox[{"Hold", "[", 
          RowBox[{"SameQ", "[", "xs", "]"}], "]"}]}]}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"failed", "[", 
     RowBox[{
      RowBox[{"\"\<path\>\"", "\[Rule]", "behind"}], ",", " ", 
      RowBox[{"\"\<expected\>\"", "\[Rule]", 
       RowBox[{"Replace", "[", 
        RowBox[{"isForm", ",", " ", 
         RowBox[{
          RowBox[{"is", "[", "xs___", "]"}], "\[RuleDelayed]", " ", 
          RowBox[{"Hold", "[", 
           RowBox[{"SameQ", "[", "xs", "]"}], "]"}]}]}], "]"}]}], ",", " ", 
      RowBox[{"\"\<got\>\"", "\[Rule]", " ", 
       RowBox[{"Replace", "[", 
        RowBox[{"isForm", ",", " ", 
         RowBox[{
          RowBox[{"is", "[", "xs___", "]"}], "\[RuleDelayed]", " ", 
          RowBox[{"SameQ", "@@@", 
           RowBox[{"Hold", "@@", 
            RowBox[{"{", 
             RowBox[{"{", "xs", "}"}], "}"}]}]}]}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.602897732169285*^9, 3.602897741133698*^9}, {
  3.602897780248303*^9, 3.602897827899831*^9}, {3.602899289643446*^9, 
  3.602899292019123*^9}, {3.602900973694463*^9, 3.602900973896867*^9}, {
  3.602903042411746*^9, 3.602903129280582*^9}, {3.6029035435947323`*^9, 
  3.6029036167077703`*^9}, {3.602903798062684*^9, 3.602903806284136*^9}, {
  3.6029039787472258`*^9, 3.602903981188623*^9}, {3.602904014619079*^9, 
  3.602904056622548*^9}, {3.602904167806541*^9, 3.602904290333337*^9}, {
  3.602904329962532*^9, 3.602904330066905*^9}, {3.602904412274497*^9, 
  3.602904449106001*^9}, {3.602904548254447*^9, 3.602904557613105*^9}, {
  3.602904634678146*^9, 3.602904674869893*^9}, {3.602967213710788*^9, 
  3.602967249599634*^9}, {3.602988969614584*^9, 3.602988969831164*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"runTests", "[", 
   RowBox[{"tests_", ",", 
    RowBox[{"path", ":", 
     RowBox[{"{", "___String", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"testWalk", "[", 
    RowBox[{"tests", ",", 
     RowBox[{"{", "}"}], ",", "path"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.602883993289528*^9, 3.60288402123695*^9}, {
   3.602884054016261*^9, 3.602884106887703*^9}, {3.602884201999894*^9, 
   3.6028842164892797`*^9}, {3.6028842887707863`*^9, 3.602884386426284*^9}, {
   3.6028844527040243`*^9, 3.60288445372865*^9}, {3.602884489792293*^9, 
   3.602884632752591*^9}, {3.602884670403162*^9, 3.6028847272943573`*^9}, {
   3.6028847616471148`*^9, 3.602884781248773*^9}, {3.602884907163056*^9, 
   3.602884933247778*^9}, {3.6028971832918158`*^9, 3.602897185491177*^9}, {
   3.602901068824445*^9, 3.60290108396953*^9}, 3.602901314245582*^9, {
   3.6029013545204163`*^9, 3.602901404292858*^9}, {3.602901636940619*^9, 
   3.602901653280682*^9}, {3.60290171959732*^9, 3.6029017733143873`*^9}, {
   3.602902323493698*^9, 3.602902330323978*^9}, {3.602905965653892*^9, 
   3.6029059667546453`*^9}, 3.6029060312542267`*^9, 3.602906121982332*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"runTests", "[", "tests_", "]"}], ":=", " ", 
  RowBox[{"runTests", "[", 
   RowBox[{"tests", ",", " ", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6029017213023987`*^9, 3.602901741888188*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Mapper", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.60838720903561*^9, 3.608387213867951*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapper", "[", "f_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{"f", ",", "#"}], "]"}], "&"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6084024652451963`*^9, 3.608402482791486*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["asMap", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.608401914279929*^9, 3.6084019164063807`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"asMap", "[", "x_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"lookup", "[", 
    RowBox[{"x", ",", "##"}], "]"}], "&"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60840071125609*^9, 3.608400739659273*^9}, 
   3.608403401871502*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"asMap", "[", 
   RowBox[{"x_", ",", " ", "default_"}], "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"{", "##", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "k_", "}"}], "\[RuleDelayed]", 
        RowBox[{"lookup", "[", 
         RowBox[{"x", ",", "k", ",", " ", "default"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", " ", 
        RowBox[{"lookup", "[", 
         RowBox[{"x", ",", " ", "##"}], "]"}]}]}], "}"}]}], "]"}], 
   "&"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6084033592373734`*^9, 3.608403373013782*^9}, {
  3.608403414115053*^9, 3.6084035487285547`*^9}, {3.6084039986454773`*^9, 
  3.608404015886221*^9}, {3.608404060500169*^9, 3.6084041202079973`*^9}, {
  3.6084041783472424`*^9, 3.608404188919306*^9}, {3.6084043442843723`*^9, 
  3.6084043478342457`*^9}, {3.6084044058839703`*^9, 3.608404413194457*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"runTests", "[", "\[IndentingNewLine]", 
  RowBox[{"let", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m1", " ", "=", " ", 
      RowBox[{"someStructure", "[", 
       RowBox[{"\"\<a\>\"", "\[Rule]", " ", "\"\<A\>\""}], "]"}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"is", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"asMap", "[", "m1", "]"}], "[", "\"\<a\>\"", "]"}], ",", 
        "\"\<A\>\""}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"is", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"asMap", "[", 
          RowBox[{"m1", ",", "\"\<C\>\""}], "]"}], "[", "\"\<c\>\"", "]"}], 
        ",", " ", "\"\<C\>\""}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"is", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"asMap", "[", "m1", "]"}], "[", 
         RowBox[{"\"\<b\>\"", ",", " ", "\"\<C\>\""}], "]"}], ",", 
        "\"\<C\>\""}], "]"}]}], "}"}]}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.608403556962121*^9, 3.608403719622596*^9}, {
  3.608403750262039*^9, 3.608403887389125*^9}, {3.608403945577671*^9, 
  3.608403946782501*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"passed", "[", 
    RowBox[{
     RowBox[{"\<\"path\"\>", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Hold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"asMap", "[", 
         RowBox[{"someStructure", "[", 
          RowBox[{"\<\"a\"\>", "\[Rule]", "\<\"A\"\>"}], "]"}], "]"}], 
        "[", "\<\"a\"\>", "]"}], "===", "\<\"A\"\>"}], "]"}]}], "]"}], ",", 
   RowBox[{"passed", "[", 
    RowBox[{
     RowBox[{"\<\"path\"\>", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Hold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"asMap", "[", 
         RowBox[{
          RowBox[{"someStructure", "[", 
           RowBox[{"\<\"a\"\>", "\[Rule]", "\<\"A\"\>"}], "]"}], 
          ",", "\<\"C\"\>"}], "]"}], "[", "\<\"c\"\>", "]"}], 
       "===", "\<\"C\"\>"}], "]"}]}], "]"}], ",", 
   RowBox[{"passed", "[", 
    RowBox[{
     RowBox[{"\<\"path\"\>", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Hold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"asMap", "[", 
         RowBox[{"someStructure", "[", 
          RowBox[{"\<\"a\"\>", "\[Rule]", "\<\"A\"\>"}], "]"}], "]"}], "[", 
        RowBox[{"\<\"b\"\>", ",", "\<\"C\"\>"}], "]"}], "===", "\<\"C\"\>"}], 
      "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.614890764154179*^9, {3.614890888394808*^9, 3.614890900194949*^9}, 
   3.614964592267117*^9, 3.615671534484296*^9, 3.6157762562716227`*^9, 
   3.617651564277445*^9, 3.61815648976711*^9, 3.618501646583664*^9, 
   3.619495948829443*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["qwikReap", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610441920675005*^9, 3.610441921810149*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "qwikReap", "]"}], "=", " ", "HoldAll"}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6105594860445547`*^9, 3.610559497818672*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qwikReap", "[", "expr_", "]"}], ":=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Reap", "[", "expr", "]"}], "\[LeftDoubleBracket]", "2", 
     "\[RightDoubleBracket]"}], ",", " ", 
    RowBox[{
     RowBox[{"{", "x_", "}"}], "\[RuleDelayed]", " ", "x"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6104419230773478`*^9, 3.610441925219699*^9}, {
  3.610441971564928*^9, 3.610441978923195*^9}, {3.610442010792502*^9, 
  3.610442123216238*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["graphUnion2", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.61044451885425*^9, 3.610444527126739*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "graphUnion2", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610444553760187*^9, 3.610444557548291*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphUnion2", "[", "]"}], ":=", 
  RowBox[{"Graph", "[", 
   RowBox[{"{", "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610444473180801*^9, 3.610444534303081*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphUnion2", "[", "g_Graph", "]"}], ":=", "g"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610444645556431*^9, 3.610444650517311*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphUnion2", "[", "gs__Graph", "]"}], ":=", 
  RowBox[{"GraphUnion", "[", "gs", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610444492434156*^9, 3.610444500835123*^9}, {
  3.610444536142065*^9, 3.610444582448309*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["qwikMapIndexed", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6109994454201097`*^9, 3.6109994487789173`*^9}}],

Cell["\<\
Like mapIndexed, but just maps over first level and passes in unwrapped index.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.610999464226767*^9, 3.6109994867992887`*^9}, {
  3.611002181622118*^9, 3.6110021848939953`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qwikMapIndexed", "[", 
   RowBox[{"f_", ",", "expr_"}], "]"}], ":=", 
  RowBox[{"MapIndexed", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"#1", ",", 
       RowBox[{"#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
       "]"}], "&"}], ",", " ", "expr"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6109990340319443`*^9, 3.610999098257277*^9}, {
  3.610999177700493*^9, 3.61099917802055*^9}, {3.610999317013129*^9, 
  3.6109993175555*^9}, {3.610999381669405*^9, 3.610999422341877*^9}, {
  3.6110021865512867`*^9, 3.6110021877099323`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["stringishQ", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.620128242012344*^9, 3.6201282438477077`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stringishQ", "[", "_", "]"}], ":=", " ", "False"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.619456334288252*^9, 3.619456342689041*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stringishQ", "[", 
   RowBox[{"String_", "|", "StringExpression_"}], "]"}], ":=", " ", 
  "True"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.619456313356526*^9, 3.619456345673558*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["(more) Graph Utils", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.6035803971691837`*^9, 3.603580406103015*^9}, {
  3.604367219152766*^9, 3.6043672287683363`*^9}}],

Cell[CellGroupData[{

Cell["set graph things", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.604367214482707*^9, 3.604367218027431*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "setGraphOpts", ",", "setGraphVerts", ",", "setGraphEdges", ",", 
   "addGraphOpts", ",", "mapToGraphVerts"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60358456841325*^9, 3.603584571649242*^9}, {
  3.6035846865591593`*^9, 3.603584700238635*^9}, {3.6059648461071367`*^9, 
  3.605964850501925*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"setGraphOpts", "[", 
   RowBox[{"g_Graph", ",", " ", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "Graph", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Graph", "[", 
   RowBox[{
    RowBox[{"VertexList", "@", "g"}], ",", 
    RowBox[{"EdgeList", "@", "g"}], ",", " ", "opts"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603398996543165*^9, 3.6033990900779247`*^9}, 
   3.603580382423972*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"setGraphVerts", "[", 
   RowBox[{"g_Graph", ",", "verts_"}], "]"}], ":=", " ", 
  RowBox[{"Graph", "[", 
   RowBox[{"verts", ",", 
    RowBox[{"EdgeList", "[", "g", "]"}], ",", 
    RowBox[{"Options", "[", "g", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603567430333745*^9, 3.603567487270183*^9}, {
   3.605967255391979*^9, 3.605967259719266*^9}, 3.605967354726632*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"setGraphEdges", "[", 
   RowBox[{"g_Graph", ",", "edges_"}], "]"}], ":=", "\[IndentingNewLine]", 
  " ", 
  RowBox[{"Graph", "[", 
   RowBox[{
    RowBox[{"VertexList", "[", "g", "]"}], ",", " ", "edges", ",", " ", 
    RowBox[{"Options", "[", "g", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603567488542081*^9, 3.603567516292262*^9}, {
   3.603582361737074*^9, 3.603582396286066*^9}, {3.603582430288156*^9, 
   3.603582472662458*^9}, {3.6035833066404133`*^9, 3.60358330921525*^9}, {
   3.605967266334853*^9, 3.605967267807926*^9}, 3.605967352207353*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"addGraphOpts", "[", 
   RowBox[{"g_Graph", ",", " ", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "Graph", "]"}]}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"opts2", " ", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "opts", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Options", "[", "g", "]"}], "}"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graph", "[", 
     RowBox[{
      RowBox[{"VertexList", "@", "g"}], ",", 
      RowBox[{"EdgeList", "@", "g"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"Sequence", "@@", " ", "opts2"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603583996857383*^9, 3.603584043176469*^9}, {
  3.6035841028289223`*^9, 3.6035841355870523`*^9}, {3.603584221524501*^9, 
  3.603584274574106*^9}, {3.603584349436507*^9, 3.6035843834300337`*^9}, {
  3.603584528198731*^9, 3.60358455992328*^9}, {3.603584817730402*^9, 
  3.60358481809898*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Options", "@", 
  RowBox[{"Graph", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", "\[Rule]", "b"}], "}"}], ",", " ", 
    RowBox[{"EdgeLabels", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "\[Rule]", "b"}], ")"}], "\[Rule]", "\"\<bla\>\""}], 
      "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605967318763139*^9, 3.605967333440425*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"EdgeLabels", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[DirectedEdge]", "b"}], "\[Rule]", "\<\"bla\"\>"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.614890764360755*^9, 3.614890888644083*^9, 
  3.614964592525962*^9, 3.615671534717259*^9, 3.615776256462275*^9, 
  3.617651564474134*^9, 3.6181564899272614`*^9, 3.618501646747916*^9, 
  3.6194959490053*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graph", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", "\[Rule]", "b"}], "}"}], ",", " ", 
   RowBox[{"EdgeLabels", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "\[Rule]", "b"}], ")"}], "\[Rule]", "\"\<bla\>\""}], 
     "}"}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6104450026785927`*^9, 3.610445014229933*^9}}],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{$CellContext`a, $CellContext`b}, {{{1, 2}}, Null}, {
      EdgeLabels -> {
        DirectedEdge[$CellContext`a, $CellContext`b] -> "bla"}}]], 
    Typeset`boxes, Typeset`boxes$s2d = GraphicsGroupBox[{{
       Arrowheads[0.041582132564841494`], 
       Directive[
        Opacity[0.7], 
        Hue[0.6, 0.7, 0.5]], {
        TagBox[
         ArrowBox[
          LineBox[{
            DynamicLocation["VertexID$1", Automatic, Center], 
            DynamicLocation["VertexID$2", Automatic, Center]}]], 
         "DynamicName", BoxID -> "EdgeLabelID$1"], 
        InsetBox[
         FormBox["\"bla\"", TraditionalForm], 
         DynamicLocation["EdgeLabelID$1", Automatic, 
          Scaled[0.5]], 
         ImageScaled[{0.5, 0.5}], BaseStyle -> "Graphics"]}}, {
       Directive[
        Hue[0.6, 0.2, 0.8], 
        EdgeForm[
         Directive[
          GrayLevel[0], 
          Opacity[0.7]]]], 
       TagBox[
        DiskBox[{1., 0.}, 0.01273], "DynamicName", BoxID -> "VertexID$1"], 
       TagBox[
        DiskBox[{0., 1.2246467991473532`*^-16}, 0.01273], "DynamicName", 
        BoxID -> "VertexID$2"]}}], $CellContext`flag}, 
    TagBox[
     DynamicBox[GraphComputation`NetworkGraphicsBox[
      3, Typeset`graph, Typeset`boxes, $CellContext`flag], {
      CachedValue :> Typeset`boxes, SingleEvaluation -> True, 
       SynchronousUpdating -> False, TrackedSymbols :> {$CellContext`flag}},
      ImageSizeCache->{{5.765786437626893, 
       353.23421356237316`}, {-9.743072915248867, 4.085354209497346}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False,
    UnsavedVariables:>{$CellContext`flag}]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FrameTicks->None]], "Output",
 CellChangeTimes->{3.6148907643939857`*^9, 3.614890888711097*^9, 
  3.614964592569624*^9, 3.615671534810143*^9, 3.6157762565055237`*^9, 
  3.617651564520547*^9, 3.618156489972707*^9, 3.618501646824318*^9, 
  3.61949594905167*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Options", "[", 
  RowBox[{"Graph", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", "\[Rule]", "b"}], "}"}], ",", " ", 
    RowBox[{"EdgeLabels", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "\[Rule]", "b"}], ")"}], "\[Rule]", "\"\<bla\>\""}], 
      "}"}]}]}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605967227322589*^9, 3.60596723692071*^9}, {
  3.605967280716756*^9, 3.605967291711206*^9}, {3.610444953182314*^9, 
  3.610444953701166*^9}, {3.610445020430623*^9, 3.6104450217410717`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"EdgeLabels", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[DirectedEdge]", "b"}], "\[Rule]", "\<\"bla\"\>"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.614890764428896*^9, 3.614890888959798*^9, 
  3.61496459260362*^9, 3.615671534851945*^9, 3.6157762565368977`*^9, 
  3.6176515645597763`*^9, 3.618156489998426*^9, 3.618501646863768*^9, 
  3.619495949083416*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["get graph things", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6104448890144043`*^9, 3.610444891748629*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getEdgeLabels", "[", "g_Graph", "]"}], ":=", 
  RowBox[{"EdgeLabels", "/.", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"Options", "[", "g", "]"}], ",", 
     RowBox[{"_", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610444894993534*^9, 3.61044494449937*^9}, {
  3.610445371469236*^9, 3.610445378752927*^9}, {3.610445410221282*^9, 
  3.6104454239573727`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getVertexStyle", "[", "g_Graph", "]"}], ":=", " ", 
  RowBox[{"VertexStyle", "/.", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"Options", "[", "g", "]"}], ",", 
     RowBox[{"_", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610999892444475*^9, 3.610999948675439*^9}}],

Cell["\<\
Not sure if this is quite right, that is, maybe there\[CloseCurlyQuote]s a \
difference between having the empty list set as a vertex\[CloseCurlyQuote]s \
style and excluding it from the style thing altogether:\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.611000257828438*^9, 3.611000289506525*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getVertexStyle", "[", 
    RowBox[{"g_Graph", ",", " ", "v_"}], "]"}], "/;", 
   RowBox[{"VertexQ", "[", 
    RowBox[{"g", ",", "v"}], "]"}]}], ":=", " ", 
  RowBox[{"v", "/.", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"getVertexStyle", "[", "g", "]"}], ",", " ", 
     RowBox[{"_", "\[Rule]", 
      RowBox[{"{", "}"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6109999500399942`*^9, 3.611000081625045*^9}, {
  3.611000150383338*^9, 3.611000194030842*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["mapToGraphVerts, mapToGraphEdges", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.606517370731986*^9, 3.606517389170972*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"mapToGraphVerts", ",", "mapToGraphEdges"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605967436821666*^9, 3.6059674400295763`*^9}, {
  3.606517413067953*^9, 3.6065174159885387`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapToGraphVerts", "[", 
   RowBox[{"f_", ",", "g_Graph"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"let", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vs1", "=", 
       RowBox[{"VertexList", "@", "g"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"vs2", "=", 
       RowBox[{"f", "/@", "vs1"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"rs", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"vs1", "\[Rule]", " ", "vs2"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"es", "=", 
       RowBox[{"EdgeList", "@", "g"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"es2", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{"#", ",", "rs", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "&"}], ")"}], "/@", "es"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"ers", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"es", "\[Rule]", "es2"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graph", "[", 
     RowBox[{
     "vs2", ",", "\[IndentingNewLine]", "es2", ",", "\[IndentingNewLine]", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Options", "[", "g", "]"}], "/.", "ers"}], ")"}]}]}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605865943823989*^9, 3.6058660114518547`*^9}, {
   3.605866060271549*^9, 3.605866070097568*^9}, {3.605866168914658*^9, 
   3.605866292580434*^9}, {3.605866349416436*^9, 3.6058665389121723`*^9}, 
   3.605866953278452*^9, {3.605867137166171*^9, 3.605867146048127*^9}, {
   3.60586733528618*^9, 3.6058673604994164`*^9}, {3.6058674246377907`*^9, 
   3.605867518533333*^9}, {3.605867691810853*^9, 3.605867693465281*^9}, {
   3.605867937438654*^9, 3.605867968596799*^9}, {3.605868053822468*^9, 
   3.60586805497262*^9}, {3.605964981249983*^9, 3.6059650008149767`*^9}, {
   3.60596715402521*^9, 3.6059671860074*^9}, 3.6059673599602633`*^9, {
   3.605967446025722*^9, 3.605967447689454*^9}, {3.60596761003519*^9, 
   3.605967744402104*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"let", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"g", "=", 
     RowBox[{"Graph", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "\[Rule]", "b"}], ",", 
         RowBox[{"b", "\[Rule]", "c"}], ",", 
         RowBox[{"c", "\[Rule]", "a"}]}], "}"}], ",", " ", 
       RowBox[{"EdgeLabels", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "\[Rule]", "b"}], ")"}], "\[Rule]", " ", 
          "\"\<bla\>\""}], "}"}]}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"mapToGraphVerts", "[", 
    RowBox[{"foo", ",", "g"}], "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6059648980062523`*^9, 3.605964940572133*^9}, {
  3.605967374541745*^9, 3.60596741903363*^9}}],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
       $CellContext`foo[$CellContext`a], 
       $CellContext`foo[$CellContext`b], 
       $CellContext`foo[$CellContext`c]}, {{{1, 2}, {2, 3}, {3, 1}}, Null}, {
      EdgeLabels -> {DirectedEdge[
           $CellContext`foo[$CellContext`a], 
           $CellContext`foo[$CellContext`b]] -> "bla"}}]], Typeset`boxes, 
    Typeset`boxes$s2d = GraphicsGroupBox[{{
       Arrowheads[0.03555748430834104], 
       Directive[
        Opacity[0.7], 
        Hue[0.6, 0.7, 0.5]], {
        TagBox[
         ArrowBox[
          LineBox[{
            DynamicLocation["VertexID$1", Automatic, Center], 
            DynamicLocation["VertexID$2", Automatic, Center]}]], 
         "DynamicName", BoxID -> "EdgeLabelID$1"], 
        InsetBox[
         FormBox["\"bla\"", TraditionalForm], 
         DynamicLocation["EdgeLabelID$1", Automatic, 
          Scaled[0.5]], 
         ImageScaled[{0.5, 0.5}], BaseStyle -> "Graphics"]}, 
       ArrowBox[
        LineBox[{
          DynamicLocation["VertexID$2", Automatic, Center], 
          DynamicLocation["VertexID$3", Automatic, Center]}]], 
       ArrowBox[
        LineBox[{
          DynamicLocation["VertexID$3", Automatic, Center], 
          DynamicLocation["VertexID$1", Automatic, Center]}]]}, {
       Directive[
        Hue[0.6, 0.2, 0.8], 
        EdgeForm[
         Directive[
          GrayLevel[0], 
          Opacity[0.7]]]], 
       TagBox[
        DiskBox[{-0.8660254037844384, -0.4999999999999994}, 
         0.020399597244776385`], "DynamicName", BoxID -> "VertexID$1"], 
       TagBox[
        DiskBox[{0.8660254037844389, -0.5000000000000012}, 
         0.020399597244776385`], "DynamicName", BoxID -> "VertexID$2"], 
       TagBox[
        DiskBox[{1.8369701987210297`*^-16, 1.}, 0.020399597244776385`], 
        "DynamicName", BoxID -> "VertexID$3"]}}], $CellContext`flag}, 
    TagBox[
     DynamicBox[GraphComputation`NetworkGraphicsBox[
      3, Typeset`graph, Typeset`boxes, $CellContext`flag], {
      CachedValue :> Typeset`boxes, SingleEvaluation -> True, 
       SynchronousUpdating -> False, TrackedSymbols :> {$CellContext`flag}},
      ImageSizeCache->{{5.765786437626889, 
       353.23421356237304`}, {-153.52141356237308`, 150.3709454156276}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False,
    UnsavedVariables:>{$CellContext`flag}]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FrameTicks->None]], "Output",
 CellChangeTimes->{3.614890764544072*^9, 3.6148908894102488`*^9, 
  3.6149645927659817`*^9, 3.6156715350652647`*^9, 3.615776256645039*^9, 
  3.6176515646741533`*^9, 3.618156490099175*^9, 3.61850164697335*^9, 
  3.61949594920118*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapToGraphEdges", "[", 
   RowBox[{"f_", ",", "g_Graph"}], "]"}], ":=", " ", 
  RowBox[{"setGraphEdges", "[", 
   RowBox[{"g", ",", " ", 
    RowBox[{"f", "/@", 
     RowBox[{"EdgeList", "[", "g", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605865943823989*^9, 3.6058660114518547`*^9}, {
   3.605866060271549*^9, 3.605866070097568*^9}, {3.605866168914658*^9, 
   3.605866292580434*^9}, {3.605866349416436*^9, 3.6058665389121723`*^9}, 
   3.605866953278452*^9, {3.605867137166171*^9, 3.605867146048127*^9}, {
   3.60586733528618*^9, 3.6058673604994164`*^9}, {3.6058674246377907`*^9, 
   3.605867518533333*^9}, {3.605867691810853*^9, 3.605867693465281*^9}, {
   3.605867937438654*^9, 3.605867968596799*^9}, {3.605868053822468*^9, 
   3.60586805497262*^9}, {3.605964981249983*^9, 3.6059650008149767`*^9}, {
   3.60596715402521*^9, 3.6059671860074*^9}, 3.6059673599602633`*^9, {
   3.605967446025722*^9, 3.605967447689454*^9}, {3.60596761003519*^9, 
   3.605967744402104*^9}, {3.6065174270774307`*^9, 3.606517465626741*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["decoration conveniences", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6052648599633093`*^9, 3.605264873153594*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"addToolTips", "[", "g_Graph", "]"}], ":=", 
  RowBox[{"setGraphVerts", "[", 
   RowBox[{"g", ",", 
    RowBox[{"Tooltip", "/@", 
     RowBox[{"VertexList", "[", "g", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604440173005361*^9, 3.6044402009985523`*^9}, 
   3.610194789043695*^9, 3.610444815185606*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"addNameLabels", "[", "g_Graph", "]"}], ":=", " ", 
  RowBox[{"addGraphOpts", "[", 
   RowBox[{"g", ",", " ", 
    RowBox[{"VertexLabels", "\[Rule]", " ", "\"\<Name\>\""}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605264874236197*^9, 3.6052649201111183`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"addEdgeToolTips", "[", "g_Graph", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"let", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"els", "=", 
      RowBox[{"getEdgeLabels", "[", "g", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Switch", "[", 
     RowBox[{"els", ",", "\[IndentingNewLine]", "Automatic", ",", 
      RowBox[{"setGraphEdges", "[", 
       RowBox[{"g", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Tooltip", "[", 
           RowBox[{"#", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"EdgeList", "[", "g", "]"}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
      RowBox[{"let", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tts", "=", "\[IndentingNewLine]", 
          RowBox[{"Append", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Replace", "[", 
             RowBox[{"els", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"e_", " ", "\[Rule]", " ", "l_"}], ")"}], 
               "\[RuleDelayed]", " ", 
               RowBox[{"(", 
                RowBox[{"e", "\[Rule]", " ", 
                 RowBox[{"Tooltip", "[", 
                  RowBox[{"e", ",", "l"}], "]"}]}], ")"}]}], ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"e_", "\[RuleDelayed]", " ", 
             RowBox[{"Tooltip", "[", 
              RowBox[{"e", ",", "e"}], "]"}]}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"setGraphEdges", "[", 
         RowBox[{"g", ",", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"EdgeList", "@", "g"}], ",", " ", "tts", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdy00ogwEAh/ERTrOY2tYIa8qQsCxbrX3bgSmtnaglzetAsY9yo5y0RnFY
EpmvtQNrtVJzmF2UTbPNKGlWVjbNDuRjLOH9v4en3+nhjc/oJ8ppNFojGVwP
2vocqbxSdLwqhuMtj1K4nbXJoZXo10Bua0kLI0mfizJhcMN5q9kLGTJxCEpH
Xi4gO2xJwGf6zw0UNg3dwaovWR7ypJoiXJIwKpZJiRMhB2ZkHTJYYK9RshvU
U677vFIxMkp5GsjNQmKOaYbTTIExQuoymcZgcwPBuCS1HGQoQyIDC+rno2yY
qg7UQ++mlw+jg842aMr5OiG9pBHCu0mRHK7Ydtwx0vfeWg+M18TyV6SRdLgA
n/wPRRh8S9UlSbs3uBx426XiQnGlgwcDPwo+THukArjwvdsOVTq7BA5vvg5A
3Z9/ayxL/rQ05S/9Yw9+Ghf3YfycdQh7Es4AVNfQz+CRwk7JJOTX0FGmpfwH
BEQUOw==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ornament", "[", "g_Graph", "]"}], ":=", " ", 
  RowBox[{"addEdgeToolTips", "@", 
   RowBox[{"addToolTips", "@", 
    RowBox[{"addNameLabels", "@", "g"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606591253435029*^9, 3.6065912692401257`*^9}, {
  3.606591299464514*^9, 3.606591307688456*^9}, {3.606591338594221*^9, 
  3.6065913405960207`*^9}, {3.606591403311872*^9, 3.6065914092313843`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["singleEdgify", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6035804130145063`*^9, 3.603580423542552*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"singleEdgify", ",", "edgeListTransform"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603582204762931*^9, 3.6035822100317163`*^9}, {
  3.604426829705948*^9, 3.6044268308894567`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"edgeListTransform", "[", 
   RowBox[{"el_List", ",", 
    RowBox[{"v", ":", 
     RowBox[{"(", " ", 
      RowBox[{"Automatic", "|", "True", "|", "False"}], ")"}]}]}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Switch", "[", 
   RowBox[{
   "v", ",", "\[IndentingNewLine]", "Automatic", ",", " ", "el", ",", 
    "\[IndentingNewLine]", "True", ",", 
    RowBox[{"Replace", "[", 
     RowBox[{"el", ",", 
      RowBox[{"UndirectedEdge", "\[Rule]", "DirectedEdge"}], ",", 
      RowBox[{"{", "2", "}"}], ",", 
      RowBox[{"Heads", "\[Rule]", " ", "True"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "False", ",", " ", 
    RowBox[{"Replace", "[", 
     RowBox[{"el", ",", " ", 
      RowBox[{"DirectedEdge", "\[Rule]", " ", "UndirectedEdge"}], ",", 
      RowBox[{"{", "2", "}"}], ",", " ", 
      RowBox[{"Heads", "\[Rule]", " ", "True"}]}], "]"}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.603588459689472*^9, 3.603588525744934*^9}, {
  3.603597210178514*^9, 3.603597214727792*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"edgeListTransform", "[", 
   RowBox[{"Null", ",", " ", "_"}], "]"}], ":=", " ", "Null"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6035908321910677`*^9, 3.603590840138329*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Options", "[", "singleEdgify", "]"}], "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"DirectedEdges", "\[Rule]", " ", "Automatic"}], ",", 
    RowBox[{"allowSelfLoops", "\[Rule]", " ", "False"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603581986214396*^9, 3.603582033967548*^9}, {
  3.603589929810676*^9, 3.603589972477746*^9}, {3.603590144765624*^9, 
  3.6035901452063828`*^9}, {3.6035902129428263`*^9, 3.6035902232816896`*^9}, {
  3.603590636396448*^9, 3.603590636892146*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"DirectedEdges", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"allowSelfLoops", "\[Rule]", "False"}]}], "}"}]], "Output",
 CellChangeTimes->{3.614890764909401*^9, 3.614890889709366*^9, 
  3.614964592900813*^9, 3.6156715352163677`*^9, 3.6157762568207006`*^9, 
  3.617651564884212*^9, 3.6181564902395906`*^9, 3.618501647172785*^9, 
  3.619495949376457*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"singleEdgify", "[", 
   RowBox[{"el_List", ",", 
    RowBox[{"OptionsPattern", "[", "singleEdgify", "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"searcher", " ", "=", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "allowSelfLoops", "]"}], ",", 
        "\[IndentingNewLine]", "Identity", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "|", 
          RowBox[{"Reverse", "@", "#"}]}], "&"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"edgeListTransform", "[", 
       RowBox[{"#", ",", " ", 
        RowBox[{"OptionValue", "[", "DirectedEdges", "]"}]}], "]"}], "&"}], 
     "@", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "el", "]"}], "<", "2"}], ",", 
       "\[IndentingNewLine]", "el", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Reap", "[", "\[IndentingNewLine]", 
         RowBox[{"NestWhile", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"ahd", ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"e", "=", " ", 
                 RowBox[{"First", "[", "ahd", "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Sow", "[", "e", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"Rest", "@", "ahd"}], ",", 
                  RowBox[{"searcher", "@", "e"}]}], "]"}]}]}], "]"}]}], "]"}],
            ",", "\[IndentingNewLine]", "el", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"#", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], "&"}]}], "]"}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6034068049044333`*^9, 3.603406825150406*^9}, {
   3.603406953273291*^9, 3.6034069856194963`*^9}, {3.603407017888294*^9, 
   3.6034071682336893`*^9}, {3.6034599414856253`*^9, 
   3.6034599447666683`*^9}, {3.6034803045825577`*^9, 3.603480304782439*^9}, {
   3.603480453880095*^9, 3.60348045859828*^9}, {3.6035736193943157`*^9, 
   3.603573697554948*^9}, {3.603580326502701*^9, 3.6035803552816877`*^9}, {
   3.6035805035326567`*^9, 3.60358054338976*^9}, {3.603581978470222*^9, 
   3.603582010959361*^9}, {3.603582060655716*^9, 3.603582199015664*^9}, 
   3.603582242729188*^9, {3.603582673002977*^9, 3.60358267389986*^9}, {
   3.6035829340633583`*^9, 3.603582975531966*^9}, {3.603583055089085*^9, 
   3.603583056561221*^9}, {3.6035832314110622`*^9, 3.603583242865078*^9}, {
   3.6035885399876842`*^9, 3.603588581169072*^9}, {3.603590032147407*^9, 
   3.6035901223609943`*^9}, {3.603590239622054*^9, 3.6035902882245083`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"singleEdgify", "[", 
   RowBox[{"g_Graph", ",", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "singleEdgify", "]"}]}]}], "]"}], ":=", 
  " ", 
  RowBox[{"setGraphEdges", "[", 
   RowBox[{"g", ",", 
    RowBox[{"singleEdgify", "[", 
     RowBox[{
      RowBox[{"EdgeList", "[", "g", "]"}], ",", "opts"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6035804273701982`*^9, 3.603580452172338*^9}, {
   3.603582717801991*^9, 3.603582761940308*^9}, 3.6035828277638206`*^9, {
   3.603590464499312*^9, 3.603590556173889*^9}, {3.603590646987626*^9, 
   3.603590650142606*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["extractVertexCoordinates", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.605150033394562*^9, 3.605150051999166*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "extractVertexCoordinates", ",", " ", "extractVertexCoordinateRules", ",", 
   "extractGraphPlotCoordinates", ",", "overlaySubgraph"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605150889138006*^9, 3.6051508932734947`*^9}, {
  3.605152514429867*^9, 3.605152518941277*^9}, {3.605961914523106*^9, 
  3.605961914797936*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractGraphPlotCoordinates", "[", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"Annotation", "[", 
      RowBox[{"_", ",", 
       RowBox[{"VertexCoordinateRules", "\[Rule]", " ", "vcr_"}]}], "]"}], 
     ",", "___"}], "]"}], "]"}], ":=", "vcr"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605945874035026*^9, 3.6059458971700077`*^9}, {
  3.605945942323119*^9, 3.605945996426798*^9}, {3.605946111193595*^9, 
  3.605946159628414*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractVertexCoordinates", "[", "g_Graph", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"VertexCoordinates", "/.", 
   RowBox[{"AbsoluteOptions", "[", 
    RowBox[{"g", ",", " ", "VertexCoordinates"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605150037609029*^9, 3.605150077498467*^9}, {
  3.605150649812519*^9, 3.605150680185289*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractVertexCoordinates", "[", "g_Graphics", "]"}], ":=", 
  RowBox[{"extractGraphPlotCoordinates", "@", "g"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605150037609029*^9, 3.605150077498467*^9}, {
  3.605150649812519*^9, 3.605150680185289*^9}, {3.605961988560046*^9, 
  3.605961999783969*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractVertexCoordinates", "[", 
   RowBox[{"g_Graph", ",", " ", "verts_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"verts", "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"VertexList", "@", "g"}], "\[Rule]", " ", 
     RowBox[{"extractVertexCoordinates", "@", "g"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605150083031311*^9, 3.6051501419451227`*^9}, {
  3.605150235157872*^9, 3.6051503946888847`*^9}, {3.6051504833273697`*^9, 
  3.6051506084876966`*^9}, {3.605150767627833*^9, 3.60515077814573*^9}, {
  3.605150935838694*^9, 3.6051509427084084`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractVertexCoordinateRules", "[", "g_Graph", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"VertexList", "[", "g", "]"}], "\[Rule]", 
    RowBox[{"extractVertexCoordinates", "[", "g", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603587468326333*^9, 3.603587495450966*^9}, {
  3.6051522623372793`*^9, 3.605152288069463*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"overlaySubgraph", "[", 
   RowBox[{"g_Graph", ",", "sg_Graph"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Show", "[", 
   RowBox[{"g", ",", "\[IndentingNewLine]", 
    RowBox[{"addGraphOpts", "[", 
     RowBox[{"sg", ",", "\[IndentingNewLine]", 
      RowBox[{"VertexCoordinates", "\[Rule]", " ", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"VertexList", "[", "sg", "]"}], "/.", 
         RowBox[{"extractVertexCoordinateRules", "[", "g", "]"}]}], ")"}]}]}],
      "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60358366298326*^9, 3.603583808977558*^9}, {
  3.6035839359914007`*^9, 3.603583936526157*^9}, {3.603584947333624*^9, 
  3.603584948072948*^9}, {3.6035864820862207`*^9, 3.603586567383026*^9}, {
  3.6035866163978977`*^9, 3.603586770744676*^9}, {3.603586800856783*^9, 
  3.603586847772805*^9}, {3.6035868952409163`*^9, 3.6035869005818033`*^9}, {
  3.603586943626968*^9, 3.603586950983913*^9}, {3.603587055404976*^9, 
  3.603587119812211*^9}, {3.603587212152812*^9, 3.603587229469784*^9}, {
  3.6035872689546967`*^9, 3.603587326762968*^9}, {3.6035875289496737`*^9, 
  3.6035875402503033`*^9}, {3.6051521986846657`*^9, 3.605152199798333*^9}, {
  3.605152295502674*^9, 3.605152299374258*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["toGraph", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.60359110928476*^9, 3.603591111083811*^9}, {
  3.603591246176423*^9, 3.603591246320265*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "toGraph", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6066875688896227`*^9, 3.606687571559601*^9}}],

Cell["Not sure what the point of this is, whatever", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.606687554680064*^9, 3.606687558918105*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"toGraph", "[", "xs___", "]"}], ":=", 
  RowBox[{"Graph", "[", "xs", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6035912635719233`*^9, 3.603591270303437*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"toGraph", "[", "g_Graph", "]"}], ":=", " ", "g"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6035921463350897`*^9, 3.603592152809598*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"toGraph", "[", "Null", "]"}], ":=", 
  RowBox[{"Graph", "[", 
   RowBox[{"{", "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6035912486541557`*^9, 3.603591256152364*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["nullGraphQ", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.606688232264576*^9, 3.606688233489655*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nullGraphQ", "[", "_", "]"}], ":=", " ", "False"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606688498942009*^9, 3.6066885039395723`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nullGraphQ", "[", "g_Graph", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"VertexList", "[", "g", "]"}], "\[Equal]", 
   RowBox[{"{", "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606688234481072*^9, 3.60668823616019*^9}, {
  3.6066883014082212`*^9, 3.606688319134684*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["fix ReverseGraph", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.606688120268673*^9, 3.606688128763822*^9}}],

Cell["Note: unprotecting graph. Deal with it.", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.606688369291543*^9, 3.606688375290506*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unprotect", "[", "Graph", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606688129742612*^9, 3.606688174351755*^9}, 
   3.606688520215103*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graph", "/:", " ", 
  RowBox[{"ReverseGraph", "[", 
   RowBox[{"g_Graph", "?", "nullGraphQ"}], "]"}], ":=", "g"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606688186020666*^9, 3.606688190422337*^9}, {
  3.606688331186288*^9, 3.606688350322435*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"TagSetDelayed", "::", "write"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Tag \[NoBreak]\\!\\(Graph\\)\[NoBreak] in \
\[NoBreak]\\!\\(ReverseGraph[\\(\\(g_Graph ? nullGraphQ\\)\\)]\\)\[NoBreak] \
is Protected. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/write\\\", ButtonNote -> \
\\\"TagSetDelayed::write\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6148907654891443`*^9, 3.614890890368455*^9, 
  3.614964593261179*^9, 3.615671535585885*^9, 3.6157762571153584`*^9, 
  3.617651565213386*^9, 3.6181564906026497`*^9, 3.6185016475762863`*^9, 
  3.619495949697262*^9}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.614890765490035*^9, 3.614890890370316*^9, 
  3.614964593262395*^9, 3.615671535586894*^9, 3.615776257116358*^9, 
  3.6176515652143393`*^9, 3.618156490603609*^9, 3.618501647577273*^9, 
  3.619495949698752*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["getATree, getADag", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.606687369118392*^9, 3.6066873737653*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"getATree", ",", "getADag"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6066875741898947`*^9, 3.60668758230453*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "getATree", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"DirectedEdges", "\[Rule]", " ", "Automatic"}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603588355433235*^9, 3.6035883877240257`*^9}, {
  3.60668739271264*^9, 3.606687393487979*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getATree", "[", 
   RowBox[{"g_Graph", ",", " ", "v_", ",", " ", 
    RowBox[{"OptionsPattern", "[", "getATree", "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"edgeListTransform", "[", 
     RowBox[{"#", ",", 
      RowBox[{"OptionValue", "[", "DirectedEdges", "]"}]}], "]"}], "&"}], "@",
    "\[IndentingNewLine]", 
   RowBox[{"car", "@", 
    RowBox[{"car", "@", 
     RowBox[{"cdr", "@", 
      RowBox[{"Reap", "[", "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cur", "=", "v"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"BreadthFirstScan", "[", 
          RowBox[{"g", ",", "v", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<PrevisitVertex\>\"", "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Set", "[", 
                 RowBox[{"cur", ",", "#"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<FrontierEdge\>\"", "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sow", "[", 
                 RowBox[{"#", "/.", 
                  RowBox[{
                   RowBox[{"e_", "[", 
                    RowBox[{"as___", ",", " ", "cur", ",", " ", "bs___"}], 
                    "]"}], "\[RuleDelayed]", 
                   RowBox[{"e", "[", 
                    RowBox[{"cur", ",", "as", ",", "bs"}], "]"}]}]}], " ", 
                 "]"}], "&"}], ")"}]}]}], "}"}]}], "]"}]}], "]"}], 
       "]"}]}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603575253456121*^9, 3.6035752550023518`*^9}, {
   3.6035752911608047`*^9, 3.603575383466587*^9}, {3.603575462071376*^9, 
   3.603575482682747*^9}, {3.6035756361917267`*^9, 3.603575680019202*^9}, {
   3.6035757205799294`*^9, 3.603575721641361*^9}, {3.6035807158054953`*^9, 
   3.6035807427546*^9}, {3.603581109769557*^9, 3.6035811156995573`*^9}, {
   3.603581179557386*^9, 3.6035811800676727`*^9}, {3.603588393083996*^9, 
   3.603588400341494*^9}, {3.603588675303671*^9, 3.603588714261238*^9}, 
   3.603589026315831*^9, {3.603589131150671*^9, 3.603589256198762*^9}, {
   3.6035893523944397`*^9, 3.603589358670869*^9}, {3.603589421148554*^9, 
   3.603589465480204*^9}, 3.603590798492489*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getADag", "[", 
   RowBox[{"g_Graph", ",", "v_", ",", " ", 
    RowBox[{"OptionsPattern", "[", "getADag", "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Reap", "[", "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cur", "=", "v"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"BreadthFirstScan", "[", 
          RowBox[{"g", ",", "v", ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"edgeHandler", "=", 
               RowBox[{
                RowBox[{"Sow", "[", 
                 RowBox[{"#", "/.", 
                  RowBox[{
                   RowBox[{"_", "[", 
                    RowBox[{"as___", ",", " ", "cur", ",", " ", "bs___"}], 
                    "]"}], "\[RuleDelayed]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{"cur", ",", "as", ",", "bs"}], "]"}]}]}], " ", 
                 "]"}], "&"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<PrevisitVertex\>\"", "\[Rule]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Set", "[", 
                   RowBox[{"cur", ",", "#"}], "]"}], "&"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
               "\"\<FrontierEdge\>\"", "\[Rule]", " ", "edgeHandler"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<CycleEdge\>\"", "\[Rule]", " ", "edgeHandler"}]}],
               "}"}]}], "]"}]}], "]"}]}], "]"}], "]"}], "//", 
      "\[IndentingNewLine]", "cdr"}], "//", "car"}], "//", "car"}], "//", 
   RowBox[{
    RowBox[{"Replace", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Null", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}]}], "]"}], "&"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603575725873103*^9, 3.603575770667947*^9}, {
  3.6035811413275747`*^9, 3.6035811774923277`*^9}, {3.603583387132986*^9, 
  3.60358338728397*^9}, {3.603583418803656*^9, 3.603583489825976*^9}, {
  3.603583566381391*^9, 3.603583609742869*^9}, {3.60358564097344*^9, 
  3.60358564260713*^9}, {3.603585739164091*^9, 3.603585767864805*^9}, {
  3.603589546740637*^9, 3.6035896902259502`*^9}, {3.60359180782931*^9, 
  3.603591810266323*^9}, {3.606689038689724*^9, 3.606689040558901*^9}, {
  3.606689124144413*^9, 3.6066891889886703`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["upstreamGraph, downstreamGraph, highlightWithNeighborhood", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.606690609203681*^9, 3.60669061955511*^9}, {
  3.606692203867044*^9, 3.606692210562401*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"upstreamGraph", ",", "downstreamGraph"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6066867470904293`*^9, 3.606686750780661*^9}, {
  3.60669039793141*^9, 3.606690406480338*^9}, {3.606690538738009*^9, 
  3.606690539255879*^9}, {3.606690574249092*^9, 3.606690578721747*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"upstreamGraph", "[", 
    RowBox[{"g_Graph", ",", "v_"}], "]"}], "/;", 
   RowBox[{"VertexQ", "[", 
    RowBox[{"g", ",", "v"}], "]"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"getADag", "[", 
       RowBox[{
        RowBox[{"ReverseGraph", "[", "g", "]"}], ",", "v"}], "]"}], "//", 
      "toGraph"}], "//", "ReverseGraph"}], "//", 
    RowBox[{
     RowBox[{"HighlightGraph", "[", 
      RowBox[{"#", ",", "v"}], "]"}], "&"}]}], "//", "ornament"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.606686397205988*^9, 3.6066864068936996`*^9}, {
  3.606686502441506*^9, 3.606686599921857*^9}, {3.606686632369534*^9, 
  3.6066866337522097`*^9}, {3.606686722397341*^9, 3.606686817417943*^9}, {
  3.606689936202182*^9, 3.606689951034383*^9}, {3.606690071303434*^9, 
  3.606690097996366*^9}, {3.606690132371478*^9, 3.606690132674377*^9}, {
  3.606690255204164*^9, 3.606690261533525*^9}, {3.606690296619896*^9, 
  3.606690375589738*^9}, {3.606690408513794*^9, 3.606690432364546*^9}, {
  3.606690530561627*^9, 3.606690542799708*^9}, {3.6066913245542316`*^9, 
  3.606691329761462*^9}, {3.6066920301303883`*^9, 3.6066920317646227`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"upstreamGraph", "[", 
   RowBox[{"g_Graph", ",", "vs_List"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"HighlightGraph", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Apply", "[", 
     RowBox[{"graphUnion2", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v", "\[Function]", 
         RowBox[{
          RowBox[{
           RowBox[{"getADag", "[", 
            RowBox[{
             RowBox[{"ReverseGraph", "[", "g", "]"}], ",", "v"}], "]"}], "//",
            "toGraph"}], "//", "ReverseGraph"}]}], ")"}], "/@", "vs"}]}], 
     "]"}], ",", "\[IndentingNewLine]", "vs"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615090920678561*^9, 3.615090923854763*^9}, {
  3.6150909551809072`*^9, 3.6150910276899233`*^9}, {3.615091088947281*^9, 
  3.61509118979114*^9}, {3.6150912703018303`*^9, 3.615091271412299*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"downstreamGraph", "[", 
    RowBox[{"g_Graph", ",", " ", "v_"}], "]"}], "/;", 
   RowBox[{"VertexQ", "[", 
    RowBox[{"g", ",", "v"}], "]"}]}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"getADag", "[", 
      RowBox[{"g", ",", "v"}], "]"}], "//", "toGraph"}], "//", 
    RowBox[{
     RowBox[{"HighlightGraph", "[", 
      RowBox[{"#", ",", "v"}], "]"}], "&"}]}], "//", "ornament"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.606690533181328*^9, 3.6066905713628187`*^9}, {
  3.606691333145142*^9, 3.606691337825416*^9}, {3.606692033986782*^9, 
  3.606692035345765*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"downstreamGraph", "[", 
   RowBox[{"g_Graph", ",", "vs_List"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"HighlightGraph", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Apply", "[", 
     RowBox[{"graphUnion2", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v", "\[Function]", 
         RowBox[{
          RowBox[{"getADag", "[", 
           RowBox[{"g", ",", "v"}], "]"}], "//", "toGraph"}]}], ")"}], "/@", 
       "vs"}]}], "]"}], ",", "\[IndentingNewLine]", "vs"}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.615091513961021*^9, 3.615091567719735*^9}}],

Cell["Differentiated from NeighborhoodGraph:", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.606692139509945*^9, 3.6066921525428553`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"highlightWithNeighborhood", "[", 
   RowBox[{"g_Graph", ",", " ", "vs_", ",", " ", "n_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"NeighborhoodGraph", "[", 
     RowBox[{"g", ",", "vs", ",", "n"}], "]"}], "//", 
    RowBox[{
     RowBox[{"HighlightGraph", "[", 
      RowBox[{"#", ",", "vs"}], "]"}], "&"}]}], "//", "ornament"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.606686112584881*^9, 3.606686203216716*^9}, {
  3.6066921853654633`*^9, 3.606692187092901*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"highlightWithNeighborhood", "[", 
   RowBox[{"g_Graph", ",", " ", "vs_"}], "]"}], ":=", " ", 
  RowBox[{"highlightWithNeighborhood", "[", 
   RowBox[{"g", ",", "vs", ",", "1"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6066862194729013`*^9, 3.606686229121888*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["qwik highlighting etc tools", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.606690858713327*^9, 3.606690868712439*^9}, {
  3.60669095078331*^9, 3.60669095367836*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"hlNeighborhood", ",", "hlUpstream", ",", "hlDownstream"}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606690915405899*^9, 3.606690928199394*^9}, {
  3.6066925730933123`*^9, 3.6066925763095512`*^9}, {3.6066927512252827`*^9, 
  3.606692767170117*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hlNeighborhood", "[", 
   RowBox[{"g_Graph", ",", " ", "vs_List", ",", " ", "n_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"NeighborhoodGraph", "[", 
     RowBox[{"g", ",", "vs", ",", "n"}], "]"}], "//", 
    RowBox[{
     RowBox[{"HighlightGraph", "[", 
      RowBox[{"g", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "Red"}], "]"}], "&"}], ")"}], "/@", "vs"}]}], 
      "]"}], "&"}]}], "//", "ornament"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606686112584881*^9, 3.606686203216716*^9}, {
  3.606690931992947*^9, 3.606690993826975*^9}, {3.6066913655974827`*^9, 
  3.606691368867545*^9}, {3.606692008386879*^9, 3.606692012224326*^9}, {
  3.606692624251309*^9, 3.606692624858033*^9}, {3.6066927688958597`*^9, 
  3.6066927775235662`*^9}, {3.6066930474653*^9, 3.606693129433517*^9}, {
  3.606693162276053*^9, 3.606693169173174*^9}, {3.6110949778248463`*^9, 
  3.611094984594631*^9}, {3.611095056796708*^9, 3.611095057167664*^9}, {
  3.611095103085005*^9, 3.611095108251101*^9}, {3.611095302364614*^9, 
  3.611095302779366*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hlNeighborhood", "[", 
   RowBox[{"g_Graph", ",", " ", "vs_List"}], "]"}], ":=", " ", 
  RowBox[{"hlNeighborhood", "[", 
   RowBox[{"g", ",", "vs", ",", "1"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6066862194729013`*^9, 3.606686229121888*^9}, {
  3.606690936648909*^9, 3.606690941369319*^9}, {3.6110950621867323`*^9, 
  3.6110950625347023`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hlUpstream", "[", 
   RowBox[{"g_Graph", ",", "v_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"upstreamGraph", "[", 
     RowBox[{"g", ",", "v"}], "]"}], "//", 
    RowBox[{
     RowBox[{"HighlightGraph", "[", 
      RowBox[{"g", ",", 
       RowBox[{"{", 
        RowBox[{"#", ",", 
         RowBox[{"Style", "[", 
          RowBox[{"v", ",", "Yellow"}], "]"}]}], "}"}]}], "]"}], "&"}]}], "//",
    "ornament"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6066907406159782`*^9, 3.6066907917134132`*^9}, {
  3.606690831449808*^9, 3.606690831727909*^9}, {3.606690996948062*^9, 
  3.6066909979137774`*^9}, {3.606691385812874*^9, 3.606691389412806*^9}, {
  3.606691440051093*^9, 3.6066914440021*^9}, {3.606691685952629*^9, 
  3.606691731258691*^9}, {3.606691805437715*^9, 3.606691823381867*^9}, {
  3.60669186137053*^9, 3.606691887963578*^9}, {3.606691939336166*^9, 
  3.606691940455555*^9}, {3.606692015696609*^9, 3.606692017982629*^9}, {
  3.6066925234678297`*^9, 3.60669253691954*^9}, {3.60669258236823*^9, 
  3.6066926043056517`*^9}, {3.6066927800597258`*^9, 3.6066927815558453`*^9}, {
  3.606692831921269*^9, 3.60669283216971*^9}, {3.606692863395248*^9, 
  3.606692894533387*^9}, {3.6066929322419147`*^9, 3.606692987791038*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hlDownstream", "[", 
   RowBox[{"g_Graph", ",", " ", "v_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"downstreamGraph", "[", 
     RowBox[{"g", ",", "v"}], "]"}], "//", 
    RowBox[{
     RowBox[{"HighlightGraph", "[", 
      RowBox[{"g", ",", 
       RowBox[{"{", 
        RowBox[{"#", ",", 
         RowBox[{"Style", "[", 
          RowBox[{"v", ",", "Yellow"}], "]"}]}], "}"}]}], "]"}], "&"}]}], "//",
    "ornament"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606690794196924*^9, 3.606690834728344*^9}, {
  3.606690999204464*^9, 3.606690999864732*^9}, {3.606691392685163*^9, 
  3.606691393852817*^9}, {3.6066920204806356`*^9, 3.606692022359515*^9}, {
  3.606692610506958*^9, 3.606692610739876*^9}, {3.606692708290753*^9, 
  3.6066927436575613`*^9}, {3.606692820961515*^9, 3.6066928211851873`*^9}, {
  3.6066929992121363`*^9, 3.6066929994580307`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RGBColor", "[", 
  RowBox[{".2", ",", ".6", ",", ".5", ",", "1"}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"RGBColor", "[", 
  RowBox[{"0.2`", ",", "0.6`", ",", "0.5`", ",", "1"}], "]"}]], "Output",
 CellChangeTimes->{3.6148907660601063`*^9, 3.614890890573551*^9, 
  3.614964593685931*^9, 3.61567153619387*^9, 3.615776257618815*^9, 
  3.617651565726322*^9, 3.6181564911207867`*^9, 3.6185016481634808`*^9, 
  3.619495950220976*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"hlUpDown", "[", 
   RowBox[{"g_Graph", ",", "v_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"let", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"up", "=", 
       RowBox[{"upstreamGraph", "[", 
        RowBox[{"g", ",", "v"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"down", "=", 
       RowBox[{"downstreamGraph", "[", 
        RowBox[{"g", ",", "v"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"intersect", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"GraphIntersection", "[", 
          RowBox[{"up", ",", "down"}], "]"}], "//", "EdgeList"}], "//", 
        "Graph"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"HighlightGraph", "[", 
      RowBox[{"g", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"v", ",", "Yellow"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"intersect", ",", 
           RowBox[{"RGBColor", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{".5", ",", ".2", ",", ".6"}], "}"}], "*", "1.5"}], 
             ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"down", ",", " ", 
           RowBox[{"Darker", "@", "Green"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"up", ",", 
           RowBox[{"Darker", "@", " ", "Red"}]}], "]"}]}], "}"}]}], "]"}], "//",
      "ornament"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606695511053245*^9, 3.606695586818173*^9}, {
   3.6066956914931297`*^9, 3.606695893194998*^9}, {3.6066959697234993`*^9, 
   3.606696007861003*^9}, {3.606696077232943*^9, 3.606696100514721*^9}, {
   3.606696486516241*^9, 3.6066964979341288`*^9}, {3.606696577376813*^9, 
   3.6066965818038893`*^9}, {3.606696627445784*^9, 3.6066966754966393`*^9}, 
   3.606696751028904*^9, {3.6066969493961267`*^9, 3.6066969495305233`*^9}, {
   3.606696990385104*^9, 3.606696991153418*^9}}],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.611095078306785*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Init", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.604247386379744*^9, 3.6042473866996202`*^9}}],

Cell["\<\
Looks like if we dropped clojure-1.5.1.jar rather than clojure-1.2.0.jar into \
lib we mux up JLink. Should probably get the latest version of JLink.jar, or \
something. Ideally we could get it from some repo and handle this via \
Leiningen.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6042522907574673`*^9, 3.604252372922873*^9}}],

Cell[CellGroupData[{

Cell["load", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610394468296975*^9, 3.610394470975211*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "$Path", ",", 
    "\"\</Users/timothygardner/code/ClojureLink/src/mathematica\>\""}], "]"}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.504139157507572*^9, 3.50413917164657*^9}, {
   3.5041392671130657`*^9, 3.504139315312611*^9}, 3.6024467761494827`*^9, {
   3.604247240962201*^9, 3.60424726349481*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<ClojureLink`\>\"", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.50413914098973*^9, 3.5041391451790648`*^9}, 
   3.5041393175179462`*^9, {3.610395196408408*^9, 3.610395201918747*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InstallClojureLink", "[", 
   RowBox[{
   "\"\</Users/timothygardner/code/ClojureLink\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "{", "\"\</Users/timothygardner/code/ClojureLink/src/clj\>\"", "}"}]}], 
   "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.504139433014282*^9, 3.504139440081815*^9}, {
   3.504139744383008*^9, 3.504139758328649*^9}, {3.5056215253299723`*^9, 
   3.505621532411501*^9}, {3.5056223422736397`*^9, 3.505622343063479*^9}, {
   3.505622390936513*^9, 3.505622411510468*^9}, {3.505622553537956*^9, 
   3.505622554706108*^9}, {3.505623349783263*^9, 3.505623350227833*^9}, {
   3.5056234031786547`*^9, 3.505623422798609*^9}, {3.5056237219126053`*^9, 
   3.50562373556535*^9}, {3.602446781887697*^9, 3.602446818802354*^9}, 
   3.60424724608107*^9, {3.604247931052925*^9, 3.604247948931633*^9}}],

Cell[BoxData[
 RowBox[{"SetClojureLinkAutoReplacements", "[", 
  RowBox[{"EvaluationNotebook", "[", "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6107265454877462`*^9, 3.610726556620234*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["qmark", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.60506299473174*^9, 3.6050630025027323`*^9}}],

Cell["\<\
Actually this is a bug. Totally doesn\[CloseCurlyQuote]t work, play around \
with question marks to see how\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.605063352444273*^9, 3.6050633666976013`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qmark", "=", "\"\<\:2047\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60506283082257*^9, 3.6050628419453707`*^9}}],

Cell[BoxData["\<\"\:2047\"\>"], "Output",
 CellChangeTimes->{3.614890770393486*^9, 3.614890894977249*^9, 
  3.614964598736031*^9, 3.615086657736648*^9, 3.615671541378168*^9, 
  3.615776262504005*^9, 3.6176515707502537`*^9, 3.618156496169815*^9, 
  3.618501653465248*^9, 3.619495955118352*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"addQmark", "[", "s_String", "]"}], ":=", " ", 
  RowBox[{"s", "<>", "qmark"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605062904093499*^9, 3.605062920127*^9}, {
  3.6050629579356947`*^9, 3.6050629593028507`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"addQmark", "[", "s_Symbol", "]"}], ":=", " ", 
  RowBox[{"Symbol", "@", 
   RowBox[{"addQmark", "@", 
    RowBox[{"ToString", "@", "s"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6050628540070744`*^9, 3.6050629676926107`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["does it float", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610393616367358*^9, 3.610393617526086*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", "\[IndentingNewLine]", 
  RowBox[{"with\:2011out\:2011str", "[", "\[IndentingNewLine]", 
   RowBox[{"print", "@", 
    RowBox[{"eval", "@", 
     RowBox[{"load\:2011string", "@", "\"\<*clojure-version*\>\""}]}]}], 
   "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604250479412196*^9, 3.604250529676876*^9}, {
   3.604250639830553*^9, 3.604250645989959*^9}, 3.610394416906205*^9, 
   3.610394450052643*^9}],

Cell[BoxData["\<\"{:qualifier nil, :minor 5, :incremental 1, :major 1}\"\>"], \
"Output",
 CellChangeTimes->{3.614890770663495*^9, 3.614890895168901*^9, 
  3.614964598920919*^9, 3.6150866581370993`*^9, 3.6156715415697937`*^9, 
  3.615776262692071*^9, 3.617651570961574*^9, 3.618156496386983*^9, 
  3.618501653654909*^9, 3.619495955311675*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Namespaces", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.604348436405394*^9, 3.60434844149152*^9}}],

Cell[CellGroupData[{

Cell["Problem", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.604364177308529*^9, 3.604364178138789*^9}}],

Cell["\<\
in-ns doesn\[CloseCurlyQuote]t work, getting it to work would require \
rewriting the clojure side of ClojureLink somewhat.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.604348372410725*^9, 3.604348410157895*^9}, {
  3.604348457362369*^9, 3.604348482279851*^9}, {3.604348690764203*^9, 
  3.6043487142891197`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"currentNamespace", "[", "]"}], ":=", 
  RowBox[{"ClojureEvaluate", "[", 
   RowBox[{"with\:2011out\:2011str", "[", 
    RowBox[{"print", "[", 
     RowBox[{"load\:2011string", "[", "\"\<*ns*\>\"", "]"}], "]"}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604348253074171*^9, 3.60434826354874*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"currentNamespace", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604348355996788*^9, 3.604348357235903*^9}}],

Cell[BoxData["\<\"#<Namespace user>\"\>"], "Output",
 CellChangeTimes->{3.6148907708143263`*^9, 3.614890895211814*^9, 
  3.614964598970764*^9, 3.615671541645376*^9, 3.6157762627536497`*^9, 
  3.6176515710282707`*^9, 3.618156496453884*^9, 3.6185016537204723`*^9, 
  3.619495955386855*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"coreSymbol", "=", " ", 
  RowBox[{"ClojureSymbol", "@", "\"\<ClojureLink.core\>\""}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604247975837233*^9, 3.604247985773625*^9}}],

Cell[BoxData[
 RowBox[{"ClojureSymbol", "[", "\<\"ClojureLink.core\"\>", "]"}]], "Output",
 CellChangeTimes->{3.614890770844029*^9, 3.614890895245331*^9, 
  3.614964599002894*^9, 3.615671541679644*^9, 3.615776262804062*^9, 
  3.617651571062909*^9, 3.618156496485783*^9, 3.6185016537498713`*^9, 
  3.6194959554377003`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", 
  RowBox[{"in\:2011ns", "@", 
   RowBox[{"quote", "@", "coreSymbol"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\[LeftGuillemet]", 
   RowBox[{"JavaObject", "[", 
    RowBox[{"clojure", ".", "lang", ".", "Namespace"}], "]"}], 
   "\[RightGuillemet]"}],
  JLink`Objects`vm1`JavaObject7570415186608129]], "Output",
 CellChangeTimes->{3.614890770964518*^9, 3.6148908952777157`*^9, 
  3.614964599036916*^9, 3.615671541727881*^9, 3.615776262838121*^9, 
  3.617651571100539*^9, 3.6181564965207577`*^9, 3.618501653782138*^9, 
  3.6194959554708*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"currentNamespace", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6043486091326017`*^9, 3.6043486103741302`*^9}}],

Cell[BoxData["\<\"#<Namespace user>\"\>"], "Output",
 CellChangeTimes->{3.614890771086768*^9, 3.614890895310918*^9, 
  3.614964599069933*^9, 3.6156715417776127`*^9, 3.615776262888219*^9, 
  3.6176515711499147`*^9, 3.6181564965572367`*^9, 3.618501653815658*^9, 
  3.619495955503893*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", 
  RowBox[{"in\:2011ns", "@", 
   RowBox[{"quote", "@", 
    RowBox[{"ClojureSymbol", "[", "\"\<clojure.tools.analyzer\>\"", "]"}]}]}],
   "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604248284326832*^9, 3.604248305845849*^9}, {
  3.604345652485627*^9, 3.604345652687806*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\[LeftGuillemet]", 
   RowBox[{"JavaObject", "[", 
    RowBox[{"clojure", ".", "lang", ".", "Namespace"}], "]"}], 
   "\[RightGuillemet]"}],
  JLink`Objects`vm1`JavaObject13348292721115137]], "Output",
 CellChangeTimes->{3.614890771208198*^9, 3.614890895345002*^9, 
  3.614964599103045*^9, 3.615671541827998*^9, 3.6157762629368763`*^9, 
  3.617651571295061*^9, 3.618156496588529*^9, 3.618501653848933*^9, 
  3.619495955539398*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"currentNamespace", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604348365798819*^9, 3.604348367067008*^9}}],

Cell[BoxData["\<\"#<Namespace user>\"\>"], "Output",
 CellChangeTimes->{3.61489077132898*^9, 3.614890895377295*^9, 
  3.614964599136745*^9, 3.615671541879199*^9, 3.6157762629885406`*^9, 
  3.617651571328487*^9, 3.6181564966212683`*^9, 3.618501653881969*^9, 
  3.6194959555713253`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", 
  RowBox[{"require", "[", 
   RowBox[{"quote", "@", "coreSymbol"}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604247993672173*^9, 3.604248006324918*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"analysisSymbol", " ", "=", " ", 
  RowBox[{"ClojureSymbol", "@", "\"\<ClojureLink.analysis\>\""}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604247514286664*^9, 3.604247529951985*^9}, {
  3.604346148913241*^9, 3.6043461493631973`*^9}}],

Cell[BoxData[
 RowBox[{"ClojureSymbol", "[", "\<\"ClojureLink.analysis\"\>", 
  "]"}]], "Output",
 CellChangeTimes->{3.614890771577825*^9, 3.61489089542047*^9, 
  3.6149645991881*^9, 3.61567154194704*^9, 3.6157762630692883`*^9, 
  3.6176515713963823`*^9, 3.618156496688065*^9, 3.6185016539323893`*^9, 
  3.6194959556364927`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", 
  RowBox[{"require", "[", 
   RowBox[{"quote", "[", "analysisSymbol", "]"}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604348202703631*^9, 3.604348215552595*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", 
  RowBox[{"in\:2011ns", "[", 
   RowBox[{"quote", "[", "analysisSymbol", "]"}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60434822157169*^9, 3.604348232820772*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\[LeftGuillemet]", 
   RowBox[{"JavaObject", "[", 
    RowBox[{"clojure", ".", "lang", ".", "Namespace"}], "]"}], 
   "\[RightGuillemet]"}],
  JLink`Objects`vm1`JavaObject32269879826448385]], "Output",
 CellChangeTimes->{3.6148907718192*^9, 3.614890896002368*^9, 
  3.6149645998217907`*^9, 3.61567154260787*^9, 3.615776263670205*^9, 
  3.617651572177744*^9, 3.61815649728938*^9, 3.618501654514789*^9, 
  3.619495956254974*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"currentNamespace", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6043482678417673`*^9, 3.604348269072772*^9}}],

Cell[BoxData["\<\"#<Namespace user>\"\>"], "Output",
 CellChangeTimes->{3.614890771940383*^9, 3.614890896027412*^9, 
  3.614964599869898*^9, 3.6156715426611557`*^9, 3.615776263702558*^9, 
  3.6176515722616158`*^9, 3.6181564973225527`*^9, 3.618501654548596*^9, 
  3.619495956289068*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Work-around", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.604349630805613*^9, 3.604349632026394*^9}}],

Cell[TextData[{
 "Use: ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"nsreq", "[", "\"\<ClojureLink.analysis\>\"", "]"}], ";", 
   RowBox[{"nsreq", "[", "\"\<clojure.jvm.tools.analyzer\>\"", "]"}], ";"}]], 
  "Input",
  CellChangeTimes->{{3.604355241521142*^9, 3.604355249122266*^9}, {
   3.604362896085126*^9, 3.60436293267015*^9}, {3.605053749189436*^9, 
   3.605053749859435*^9}}]
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.608005289115169*^9, 3.608005291615572*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsreq", "[", "ns_ClojureSymbol", "]"}], ":=", 
  RowBox[{"ClojureEvaluate", "@", 
   RowBox[{"require", "@", 
    RowBox[{"quote", "@", "ns"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604349640923064*^9, 3.604349716123522*^9}, {
  3.60435027365521*^9, 3.6043502763968487`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsreq", "[", "ns_String", "]"}], ":=", " ", 
  RowBox[{"nsreq", "[", 
   RowBox[{"ClojureSymbol", "[", "ns", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6043502784641438`*^9, 3.60435030121754*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsq", "[", 
   RowBox[{"ns_", ",", " ", "x_"}], "]"}], ":=", " ", 
  RowBox[{"ClojureSymbol", "[", 
   RowBox[{"StringJoin", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ns", ",", "\"\</\>\"", ",", "x"}], "}"}], "/.", 
      RowBox[{
       RowBox[{"ClojureSymbol", "[", "y_", "]"}], "\[RuleDelayed]", " ", 
       "y"}]}], ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604349259296501*^9, 3.604349322760928*^9}, {
  3.604349380154913*^9, 3.604349420063553*^9}, {3.604349460997456*^9, 
  3.60434948377182*^9}, {3.604349522224559*^9, 3.6043495321021976`*^9}}],

Cell[BoxData[""], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.610572678585537*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Parse Project", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.6103952921037397`*^9, 3.6103952937583323`*^9}}],

Cell["\<\
Just whack it with the predefined instaparse thing (for all its many warts)\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.610395296710569*^9, 3.610395315302187*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsreq", "[", "\"\<ClojureLink.parser\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610395345023979*^9, 3.6103953552270823`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"parseFile", ",", "parseString"}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6103953810669527`*^9, 3.6103953883458014`*^9}, {
  3.610396819622137*^9, 3.610396821712673*^9}, {3.6106446648737173`*^9, 
  3.610644667691845*^9}, {3.610644785906567*^9, 3.610644786321948*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseFile", "[", "f_String", "]"}], ":=", " ", 
  RowBox[{"ClojureEvaluate", "[", 
   RowBox[{
   "ClojureLink\:2024parser`parse\:2011clojure\:2011file", "[", "f", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.608008045292636*^9, 3.608008074088542*^9}, {
  3.608008106231945*^9, 3.6080081227485*^9}, {3.614890217673031*^9, 
  3.614890219401512*^9}, {3.614964266802423*^9, 3.614964267489718*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseFile", "[", 
   RowBox[{"f_String", ",", " ", "start_"}], "]"}], ":=", 
  RowBox[{"ClojureEvaluate", "[", 
   RowBox[{"ClojureLink\:2024parser`parse\:2011clojure\:2011file", "[", 
    RowBox[{"f", ",", " ", "start"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6150548701346207`*^9, 3.615054888265872*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseFile", "[", 
   RowBox[{"f_String", ",", " ", "start_", ",", "end_"}], "]"}], ":=", 
  RowBox[{"ClojureEvaluate", "[", 
   RowBox[{"ClojureLink\:2024parser`parse\:2011clojure\:2011file", "[", 
    RowBox[{"f", ",", " ", "start", ",", "end"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.61505489927766*^9, 3.615054903987095*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseString", "[", "s_String", "]"}], ":=", " ", 
  RowBox[{"ClojureEvaluate", "[", 
   RowBox[{
   "ClojureLink\:2024parser`parse\:2011clojure\:2011string", "[", "s", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610396831072607*^9, 3.6103968480297527`*^9}, {
  3.614890212635556*^9, 3.614890214897026*^9}}],

Cell["Extend this for ClojureScript & whatever", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6104474311710443`*^9, 3.6104474408599863`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"clojureFiles", "[", "path_String", "]"}], ":=", 
  RowBox[{"FileNames", "[", 
   RowBox[{
    RowBox[{"__", "~~", "\"\<.clj\>\""}], ",", "path", ",", "\[Infinity]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610572654031527*^9, 3.610572667983527*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseProject", "[", "path_String", "]"}], ":=", 
  RowBox[{"ClojureEvaluate", "[", 
   RowBox[{"ClojureLink\:2024parser`parse\:2011clojure\:2011files", "@@", 
    RowBox[{"clojureFiles", "[", "path", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610447287140325*^9, 3.6104472894926777`*^9}, {
   3.610447322280044*^9, 3.610447324271474*^9}, {3.610447363687046*^9, 
   3.610447409191861*^9}, {3.6104474495082912`*^9, 3.610447449782939*^9}, {
   3.6104477843744583`*^9, 3.6104477857975273`*^9}, {3.610572672469282*^9, 
   3.610572675641975*^9}, {3.6149643525620728`*^9, 3.614964374767761*^9}, 
   3.614964626665752*^9}],

Cell[CellGroupData[{

Cell["Tests", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610395426168159*^9, 3.6103954274481993`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseProjectTest", "=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"is", "[", 
      RowBox[{"True", ",", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"parseString", "[", "\"\<[bla]\>\"", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"\:0589top", ",", 
           RowBox[{"{", 
            RowBox[{"\:0589vector", ",", 
             RowBox[{"{", 
              RowBox[{"\:0589name", ",", "\"\<bla\>\""}], "}"}]}], "}"}]}], 
          "}"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"is", "[", 
      RowBox[{"True", ",", " ", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{
         "parseFile", "[", 
          "\"\</Users/timothygardner/code/mathematica-clojure-analysis/clj-\
test-project/src/clj_test_project/core.clj\>\"", "]"}], ",", "_List"}], 
        "]"}]}], "]"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6103954342379847`*^9, 3.610395442474114*^9}, {
  3.610395493746976*^9, 3.610395494172647*^9}, {3.610396655662456*^9, 
  3.610396777891797*^9}, {3.6103968751397533`*^9, 3.610396891943015*^9}, {
  3.610731602246356*^9, 3.6107316330890408`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "/@", 
   RowBox[{"runTests", "[", "parseProjectTest", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610396781365239*^9, 3.610396784103044*^9}, {
  3.6103968994149837`*^9, 3.610396906303134*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"failed", "[", 
  RowBox[{
   RowBox[{"\<\"path\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"\<\"expected\"\>", "\[Rule]", 
    RowBox[{"Hold", "[", 
     RowBox[{"True", "===", 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"parseString", "[", "\<\"[bla]\"\>", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\:0589top", ",", 
          RowBox[{"{", 
           RowBox[{"\:0589vector", ",", 
            RowBox[{"{", 
             RowBox[{"\:0589name", ",", "\<\"bla\"\>"}], "}"}]}], "}"}]}], 
         "}"}]}], "]"}]}], "]"}]}], ",", 
   RowBox[{"\<\"got\"\>", "\[Rule]", 
    RowBox[{"Hold", "[", 
     RowBox[{"True", "===", "False"}], "]"}]}]}], "]"}]], "Print",
 CellChangeTimes->{
  3.614890772865346*^9, 3.6148908968017*^9, {3.614964600673389*^9, 
   3.614964602758049*^9}, 3.615671543522468*^9, 3.615776264550335*^9, 
   3.617651573428236*^9, 3.61815649817766*^9, 3.618501655366848*^9, 
   3.619495957138731*^9}],

Cell[BoxData[
 RowBox[{"passed", "[", 
  RowBox[{
   RowBox[{"\<\"path\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"Hold", "[", 
    RowBox[{"True", "===", 
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{
       "parseFile", 
        "[", "\<\"/Users/timothygardner/code/mathematica-clojure-analysis/clj-\
test-project/src/clj_test_project/core.clj\"\>", "]"}], ",", "_List"}], 
      "]"}]}], "]"}]}], "]"}]], "Print",
 CellChangeTimes->{
  3.614890772865346*^9, 3.6148908968017*^9, {3.614964600673389*^9, 
   3.614964602758049*^9}, 3.615671543522468*^9, 3.615776264550335*^9, 
   3.617651573428236*^9, 3.61815649817766*^9, 3.618501655366848*^9, 
   3.619495957140253*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["AST Reference Graph", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.610380516707426*^9, 3.610380541802712*^9}}],

Cell[CellGroupData[{

Cell["basic grammar patterns", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.60800974132269*^9, 3.608009747238162*^9}, {
  3.610381996243292*^9, 3.610381996736763*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"whitespaceP", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\:0589whitespace", ",", " ", "___"}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.608009724589842*^9, 3.608009752585112*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["symb", "Subsection",
 CellChangeTimes->{{3.620733283895885*^9, 3.62073328442766*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stringify", "[", 
   RowBox[{"symb", "[", "s_String", "]"}], "]"}], ":=", "s"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6104456318054323`*^9, 3.610445653207426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stringify", "[", 
   RowBox[{"symb", "[", 
    RowBox[{"ns_String", ",", "s_String"}], " ", "]"}], "]"}], ":=", 
  RowBox[{"ns", "<>", "\"\</\>\"", "<>", "s"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6104456557427673`*^9, 3.610445680359713*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["nodify", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6107312986840467`*^9, 3.610731299194854*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsPrefixSplit", "[", "s_String", "]"}], ":=", " ", 
  RowBox[{"StringSplit", "[", 
   RowBox[{"s", ",", "\"\</\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.611012331289899*^9, 3.61101237613424*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"defStringPatterns", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<def\>\"", "~~", "___"}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.62073319111436*^9, 3.620733222264535*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nodifyRules", "=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"whitespaceP", "\[RuleDelayed]", " ", 
      RowBox[{"Sequence", "[", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\:0589symbol", ",", " ", "n_String"}], "}"}], " ", 
      "\[RuleDelayed]", 
      RowBox[{"symb", "@@", 
       RowBox[{"nsPrefixSplit", "[", "n", "]"}]}]}], ",", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"note", " ", "this", " ", 
        RowBox[{"doesn", "'"}], "t", " ", "cover", " ", "clr"}], "-", 
       RowBox[{"type", " ", "expressions", " ", "yet"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\:0589keyword", ",", " ", "s_String"}], "}"}], 
      "\[RuleDelayed]", " ", "\[IndentingNewLine]", 
      RowBox[{"First", "[", "\[IndentingNewLine]", 
       RowBox[{"StringCases", "[", 
        RowBox[{"s", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"colon", ":", 
            RowBox[{"(", 
             RowBox[{"\"\<:\>\"", ".."}], ")"}]}], "~~", "rst__"}], 
          "\[RuleDelayed]", " ", "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", 
           RowBox[{"colon", ",", "\[IndentingNewLine]", "\"\<:\>\"", ",", " ", 
            RowBox[{"keyword", "@@", 
             RowBox[{"nsPrefixSplit", "[", "rst", "]"}]}], ",", 
            "\[IndentingNewLine]", "\"\<::\>\"", ",", 
            RowBox[{"keyword", "[", 
             RowBox[{"\"\<:\>\"", ",", "rst"}], "]"}]}], "]"}]}]}], "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sequence", "@@", "\[IndentingNewLine]", 
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "pfn", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"listForm", "[", 
            RowBox[{
             RowBox[{"s_symb", "/;", " ", 
              RowBox[{"StringMatchQ", "[", 
               RowBox[{
                RowBox[{"stringify", "[", "s", "]"}], ",", "pfn"}], "]"}]}], 
             ",", " ", "n_symb", ",", " ", "body___"}], "]"}], 
           "\[RuleDelayed]", " ", "\[IndentingNewLine]", 
           RowBox[{"definingForm", "[", 
            RowBox[{
             RowBox[{"\"\<type\>\"", "\[Rule]", " ", 
              RowBox[{"stringify", "[", "s", "]"}]}], ",", " ", 
             RowBox[{"\"\<definiendum\>\"", "\[Rule]", " ", "n"}], ",", " ", 
             RowBox[{"\"\<body\>\"", "\[Rule]", 
              RowBox[{"{", "body", "}"}]}]}], "]"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", "defStringPatterns"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Sequence", "@@", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"spec", "/.", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tag_", ",", "typ_"}], " ", "}"}], "\[RuleDelayed]", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tag", ",", "body___"}], "}"}], "\[RuleDelayed]", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"typ", "@@", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "body", "}"}], ",", " ", 
               RowBox[{"Except", "[", "whitespaceP", "]"}]}], "]"}]}]}], 
           ")"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"spec", ",", " ", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\:0589vector", ",", " ", "vectorForm"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\:0589list", ",", " ", "listForm"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\:0589map", ",", " ", "mapForm"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\:0589set", ",", " ", "setForm"}], "}"}]}], "}"}]}], 
         "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "not", " ", "at", " ", "all", " ", "sure", " ", "about", " ", "this", 
       " ", "next", " ", 
       RowBox[{"bit", ".", " ", "see"}], " ", "eg", " ", 
       RowBox[{"core_deftype", ".", "clj"}], " ", "for", " ", "motivation"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"listForm", "[", 
       RowBox[{
        RowBox[{"symb", "[", "\"\<in-ns\>\"", "]"}], ",", "___", ",", 
        "nm_symb"}], "]"}], "\[RuleDelayed]", " ", "\[IndentingNewLine]", 
      RowBox[{"nsForm", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<namespaceName\>\"", " ", "\[Rule]", " ", "nm"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<body\>\"", " ", "\[Rule]", " ", 
         RowBox[{"{", "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"listForm", "[", 
       RowBox[{
        RowBox[{"symb", "[", "\"\<ns\>\"", "]"}], ",", " ", "___", ",", 
        "nm_symb", ",", " ", "body___"}], "]"}], "\[RuleDelayed]", 
      "\[IndentingNewLine]", 
      RowBox[{"nsForm", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<namespaceName\>\"", "\[Rule]", " ", "nm"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<body\>\"", "\[Rule]", " ", 
         RowBox[{"{", "body", "}"}]}]}], "]"}]}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdy19IEwEAx/FzqQ+Sin8w5lAxswvdlLbUSsVOKjFRcIrQ8mFIE4mcQTo1
w8Ipgoo52EPRQA3xL4jozGz4MBP2oOm1CraD/SEw5baURFNPc97vHr58nr7J
NQ1KjYggiFQ+aFesxLC/WYoJdJDQ9kabDumzogx4RdYrh/9GPFlQo/XXQI7O
qIWvqikOJg9VCa6RjjPhm3se5OPdVznDoMm+HQXlP+rjoFeni4c3AmNX4du6
hyRkur4q4UZUugomfptqgmvKJzpYOK9+D0NjM03wewE3CB/syYZhe45lHH64
Xj4BjSEvFuHd7e4vkBgetEH362InHGg9dEHLJ90mPF5a9sOjLOYPfBcwB/l5
Oy/Qgsax1VKovt1SBtOKxm/+5c3mDgSfXj6RPttiqR5RrgLe/7/uZnZYKtYj
8cDZ/JkIF6/b0BwJJfoFCRRNEUmw3+pLgebql9dgbXmrFFb4xDLY9/hWSu4u
S4WT2jQoSQiWQ2OLXnB0sfQR7DA51JC+ZJ0OHLNUpd4rKPX+mocJnaQF9uQb
rPB0TrMMVc13bDBvqUJw8nP0T2gX0wzsL7kYTHAs1bggD4H3DG3R8GO7UgzP
AXMnaG8=
  "]],

Cell["\<\
Seems we have to break the following out to deal with some evaluation order \
weirdness. Also less ugly this way.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6107385739770107`*^9, 3.610738596351281*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"listOrVectorHP", "=", 
   RowBox[{"listForm", "|", "vectorForm"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610735106579444*^9, 3.610735119020155*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "dotJoin", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610736425208778*^9, 3.6107364287344027`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dotJoin", "[", 
   RowBox[{
    RowBox[{"symb", "[", "a_", "]"}], ",", " ", 
    RowBox[{"symb", "[", "b_", "]"}]}], "]"}], ":=", " ", 
  RowBox[{"symb", "[", 
   RowBox[{"a", "<>", "\"\<.\>\"", "<>", "b"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610736298989551*^9, 3.6107363063129463`*^9}, {
  3.610736352147744*^9, 3.610736437298697*^9}, {3.610737586093446*^9, 
  3.610737587204777*^9}, {3.6107448872639503`*^9, 3.610744889681342*^9}, {
  3.610744928316441*^9, 3.610744937347218*^9}}],

Cell["\<\
Tip o the day: consider breaking rule lists used in RewriteRepeated into \
chain of RewriteRepeated calls on single rules. Much easier to reason about.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.610744547874054*^9, 3.610744647078911*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"refineRequire", "[", 
   RowBox[{"listOrVectorHP", "[", 
    RowBox[{
     RowBox[{"keyword", "[", "\"\<require\>\"", "]"}], ",", "body___"}], 
    "]"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", "body", "}"}], "/.", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"listOrVectorHP", "[", "x_symb", "]"}], "\[RuleDelayed]", " ", 
        RowBox[{"requireForm", "[", "x", "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"listOrVectorHP", "[", 
         RowBox[{"x_symb", ",", " ", 
          RowBox[{"keyword", "[", "\"\<as\>\"", "]"}], ",", " ", "a_symb"}], 
         "]"}], "\[RuleDelayed]", " ", 
        RowBox[{"requireForm", "[", 
         RowBox[{"x", ",", 
          RowBox[{"keyword", "[", "\"\<as\>\"", "]"}], ",", " ", "a"}], 
         "]"}]}]}], "}"}]}], "//.", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"listOrVectorHP", "[", 
      RowBox[{"x_symb", ",", "ys__"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"{", "ys", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"y_symb", "\[RuleDelayed]", " ", 
          RowBox[{"requireForm", "[", 
           RowBox[{"x", ",", " ", "y"}], "]"}]}], ",", " ", 
         RowBox[{"y_requireForm", "\[RuleDelayed]", " ", 
          RowBox[{"Prepend", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "]"}]}]}], "//.", 
   RowBox[{
    RowBox[{"requireForm", "[", 
     RowBox[{"x_symb", ",", " ", "y_symb", ",", " ", "rst___"}], "]"}], 
    "\[RuleDelayed]", " ", 
    RowBox[{"requireForm", "[", 
     RowBox[{
      RowBox[{"dotJoin", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", " ", "rst"}], 
     "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610735287413632*^9, 3.6107353145832767`*^9}, {
   3.6107353701717052`*^9, 3.610735414582951*^9}, {3.610735621873644*^9, 
   3.610735626303762*^9}, {3.610735658308918*^9, 3.610735659660083*^9}, {
   3.6107357618335648`*^9, 3.61073590603118*^9}, {3.610735937152668*^9, 
   3.6107359506075993`*^9}, {3.6107360143932257`*^9, 3.610736026489064*^9}, {
   3.61073607306196*^9, 3.610736251390873*^9}, {3.6107364744428368`*^9, 
   3.610736527874729*^9}, {3.610736568674261*^9, 3.610736572138917*^9}, {
   3.610737357939131*^9, 3.610737366020123*^9}, {3.610737483026243*^9, 
   3.610737491894567*^9}, 3.6107376223964357`*^9, {3.6107376654165573`*^9, 
   3.610737692997312*^9}, {3.6107378846269693`*^9, 3.610737887010515*^9}, {
   3.61073793989734*^9, 3.6107381089452553`*^9}, {3.610738248744295*^9, 
   3.610738254103159*^9}, {3.610738292947707*^9, 3.6107383226661158`*^9}, {
   3.6107383632114267`*^9, 3.6107383726888523`*^9}, {3.610738414428162*^9, 
   3.610738492457061*^9}, {3.6107386498856373`*^9, 3.610738690859728*^9}, {
   3.610739004591279*^9, 3.6107390443494873`*^9}, {3.6107391353954067`*^9, 
   3.6107391398433313`*^9}, {3.610739188140965*^9, 3.6107391931244097`*^9}, {
   3.610739320643567*^9, 3.610739335130712*^9}, {3.61074347796661*^9, 
   3.610743517912011*^9}, {3.610743580251616*^9, 3.61074358508363*^9}, {
   3.610743660413315*^9, 3.610743698500031*^9}, {3.610744256170288*^9, 
   3.610744318513414*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"refineNsForms", "[", "x_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"x", "/.", 
   RowBox[{"nsf_nsForm", "\[RuleDelayed]", " ", "\[IndentingNewLine]", 
    RowBox[{"Replace", "[", 
     RowBox[{"nsf", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\"\<body\>\"", "\[Rule]", " ", "b_"}], ")"}], 
       "\[RuleDelayed]", " ", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         AdjustmentBox["\"\<requireForms\>\"",
          
          BoxMargins->{{0.07689766002823586, -0.07689766002823586}, {0., 
           0.}}], "\[Rule]", " ", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Cases", "[", 
            RowBox[{"b", ",", " ", 
             RowBox[{
              TagBox[
               StyleBox[
                RowBox[{"r", ":", 
                 RowBox[{"listOrVectorHP", "[", 
                  RowBox[{
                   RowBox[{"keyword", "[", "\"\<require\>\"", "]"}], ",", " ",
                    "___"}], "]"}]}],
                ShowSpecialCharacters->False,
                ShowStringCharacters->True,
                NumberMarks->True],
               FullForm], "\[RuleDelayed]", " ", 
              RowBox[{"refineRequire", "[", "r", "]"}]}]}], "]"}]}], ")"}]}], 
        ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "1", "}"}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610730850988106*^9, 3.61073103758223*^9}, {
   3.610731269390586*^9, 3.6107312701076736`*^9}, 3.6107349560374403`*^9, {
   3.610735024675544*^9, 3.610735045850903*^9}, 3.610735103350326*^9, {
   3.610735135629401*^9, 3.6107351530118856`*^9}, {3.610735241249571*^9, 
   3.610735277713626*^9}, {3.610735310360325*^9, 3.610735310776204*^9}, {
   3.610736829186371*^9, 3.610736830887623*^9}, {3.610737019844137*^9, 
   3.610737021157399*^9}, {3.6107371188490953`*^9, 3.610737204863133*^9}, {
   3.610737334090947*^9, 3.610737334705407*^9}, {3.610737736805439*^9, 
   3.610737772676878*^9}, {3.610737819901196*^9, 3.610737822962838*^9}, {
   3.6107378967140303`*^9, 3.610737898755393*^9}, {3.610738700346332*^9, 
   3.61073870697021*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nodify", "[", "x_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"x", "//.", "nodifyRules"}], "//", "refineNsForms"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610730515100505*^9, 3.610730530180799*^9}, {
  3.610730566522615*^9, 3.6107306663328648`*^9}, {3.6107308368962927`*^9, 
  3.61073084829309*^9}, {3.610731219239406*^9, 3.610731237798872*^9}, {
  3.610736718293187*^9, 3.610736719941839*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["definingForm", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610998313792354*^9, 3.610998314924244*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getDefiniendum", "[", "df_definingForm", "]"}], ":=", " ", 
  RowBox[{"lookup", "[", 
   RowBox[{"df", ",", " ", "\"\<definiendum\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610998318121359*^9, 3.6109983414054403`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getBody", "[", "df_definingForm", "]"}], ":=", " ", 
  RowBox[{"lookup", "[", 
   RowBox[{"df", ",", " ", "\"\<body\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610998381809515*^9, 3.610998393572196*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["nsData", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.609855333414425*^9, 3.6098553405834227`*^9}, {
  3.610124103648223*^9, 3.6101241041672792`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"topDefs", "[", "nsd_nsData", "]"}], ":=", 
  RowBox[{"lookup", "[", 
   RowBox[{"nsd", ",", "\"\<topDefs\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610124129854991*^9, 3.610124141344013*^9}}],

Cell[CellGroupData[{

Cell["toNsData", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6101241122487707`*^9, 3.6101241142951317`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"defsByNamespace", "[", "asts_List", "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"groupBy", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"qwikReap", "[", "\[IndentingNewLine]", 
      RowBox[{"Fold", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ns", ",", " ", "x"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{"x", ",", " ", "_nsForm"}], "]"}], ",", 
            "\[IndentingNewLine]", "x", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Sow", "[", 
              RowBox[{"{", 
               RowBox[{"ns", ",", "x"}], "}"}], "]"}], ";", "ns"}]}], "]"}]}],
          "]"}], ",", "\[IndentingNewLine]", "\"\<user\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Cases", "[", 
         RowBox[{"asts", ",", 
          RowBox[{"(", 
           RowBox[{"_nsForm", "|", "_definingForm"}], ")"}], " ", ",", 
          "\[Infinity]"}], "]"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
     "First"}], "]"}], "/.", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"lhs_", " ", "\[Rule]", " ", "rhs_"}], ")"}], "\[RuleDelayed]", 
    " ", 
    RowBox[{"(", 
     RowBox[{"lhs", "\[Rule]", " ", 
      RowBox[{"rhs", "\[LeftDoubleBracket]", 
       RowBox[{";;", ",", "2"}], "\[RightDoubleBracket]"}]}], 
     ")"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.609857006565221*^9, 3.6098570930440407`*^9}, 
   3.609872150217127*^9, {3.6100451789555893`*^9, 3.610045199241926*^9}, {
   3.610045248433338*^9, 3.610045250985991*^9}, 3.610073591124558*^9, {
   3.610073847015432*^9, 3.6100738965104933`*^9}, {3.610075386842208*^9, 
   3.6100754554698772`*^9}, {3.610075702867852*^9, 3.610075705779415*^9}, {
   3.6104388747000427`*^9, 3.610438890048876*^9}, {3.6104421735718927`*^9, 
   3.6104421789693127`*^9}, {3.610443075134761*^9, 3.610443082176201*^9}, {
   3.6107332695563726`*^9, 3.610733276738502*^9}}],

Cell["\<\
Extend the following to deal with \[OpenCurlyDoubleQuote]user\
\[CloseCurlyDoubleQuote] case when we know more about nsForms:\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.610046127879725*^9, 3.610046142260689*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"toNsData", "[", "asts_List", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"defsByNamespace", "[", "asts", "]"}], "/.", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lhs_", "\[Rule]", " ", "rhs_"}], ")"}], "\[RuleDelayed]", 
     RowBox[{"nsData", "[", 
      RowBox[{
       RowBox[{"\"\<nsForm\>\"", "\[Rule]", " ", "lhs"}], ",", 
       RowBox[{"\"\<topDefs\>\"", "\[Rule]", " ", "rhs"}]}], "]"}]}], 
    "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.609856579204216*^9, 3.6098569940827913`*^9}, 
   3.609857032414054*^9, {3.609872201299589*^9, 3.609872201659171*^9}, {
   3.610045562864251*^9, 3.610045668311777*^9}, {3.610045761444873*^9, 
   3.610045890721991*^9}, {3.6100460488807783`*^9, 3.6100460795593233`*^9}, {
   3.610046112582726*^9, 3.610046123344037*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getNamespaceName", "[", "nsf_nsForm", "]"}], ":=", 
  RowBox[{"lookup", "[", 
   RowBox[{"nsf", ",", " ", "\"\<namespaceName\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610443859321344*^9, 3.610443878774343*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getNamespaceName", "[", "nsdt_nsData", "]"}], ":=", " ", 
  RowBox[{"getNamespaceName", "[", 
   RowBox[{"lookup", "[", 
    RowBox[{"nsdt", ",", " ", "\"\<nsForm\>\""}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610045914137578*^9, 3.6100459477681017`*^9}, {
  3.6104438353111553`*^9, 3.610443905744766*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["expandVars", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.609855287468993*^9, 3.609855289268463*^9}}],

Cell[CellGroupData[{

Cell["expandIntranamespaceVars", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6098152185964193`*^9, 3.609815223027438*^9}, {
  3.609851639972869*^9, 3.609851640564426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"varMap", "[", "nsd_nsData", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ns", "=", 
      RowBox[{"First", "@", 
       RowBox[{"getNamespaceName", "[", "nsd", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", "/.", 
        RowBox[{
         RowBox[{"s", ":", 
          RowBox[{"symb", "[", "v_", "]"}]}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"s", "\[Rule]", " ", 
           RowBox[{"symb", "[", 
            RowBox[{"ns", ",", " ", "v"}], "]"}]}], ")"}]}]}], "&"}], ")"}], "/@", 
     RowBox[{"getDefiniendum", "/@", 
      RowBox[{"lookup", "[", 
       RowBox[{"nsd", ",", "\"\<topDefs\>\""}], "]"}]}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.609815315819428*^9, 3.6098153168268137`*^9}, {
   3.6098153650400143`*^9, 3.609815399185444*^9}, {3.609850419698848*^9, 
   3.609850469002906*^9}, {3.6098505027528677`*^9, 3.609850645201371*^9}, 
   3.609850802192239*^9, 3.6098509462584047`*^9, {3.6098510285632153`*^9, 
   3.609851169399253*^9}, {3.610439429637796*^9, 3.610439430682074*^9}, {
   3.610443354379652*^9, 3.610443358529284*^9}, {3.6104439189652357`*^9, 
   3.610443920220604*^9}, {3.61044397519024*^9, 3.610444017869234*^9}, {
   3.610444079975271*^9, 3.610444173544627*^9}, {3.6104442372058163`*^9, 
   3.610444260141432*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandIntranamespaceVars", "[", 
   RowBox[{"nsds", ":", 
    RowBox[{"{", "___nsData", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Map", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"nsd", ",", "\[IndentingNewLine]", 
      RowBox[{"update", "[", 
       RowBox[{"nsd", ",", " ", "\"\<topDefs\>\"", ",", " ", 
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{"varMap", "[", "nsd", "]"}]}], "&"}]}], "]"}]}], "]"}], ",",
     "\[IndentingNewLine]", "nsds"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.609815225491095*^9, 3.6098153076208353`*^9}, {
   3.609815408537516*^9, 3.609815458935131*^9}, {3.609815592775528*^9, 
   3.6098156015023823`*^9}, {3.6098156460241537`*^9, 3.609815650381631*^9}, {
   3.6098491326564283`*^9, 3.6098491529232693`*^9}, 3.610441513803277*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["expandAliasedVars", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.60981514956483*^9, 3.609815169300709*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "expandAliasedVars", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6104406807215443`*^9, 3.610440683562714*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"aliasMap", "[", "nsd_nsData", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"qwikCases", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lookupIn", "[", 
     RowBox[{"nsd", ",", " ", 
      RowBox[{"{", 
       RowBox[{"\"\<nsForm\>\"", ",", " ", "\"\<requireForms\>\""}], "}"}]}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"requireForm", "[", 
      RowBox[{"ns_symb", ",", " ", 
       RowBox[{"keyword", "[", "\"\<as\>\"", "]"}], ",", " ", "a_symb"}], 
      "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"a", "\[Rule]", " ", "ns"}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.609812578526408*^9, 3.609812580023767*^9}, {
  3.60981270214229*^9, 3.609812735518283*^9}, {3.609815388225656*^9, 
  3.609815393808457*^9}, {3.610439932352984*^9, 3.61044004672849*^9}, {
  3.61044008284297*^9, 3.6104400961178713`*^9}, {3.610440128041992*^9, 
  3.610440295963243*^9}, {3.610450261341729*^9, 3.610450266652048*^9}, {
  3.6107395719978733`*^9, 3.610739573168202*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"aliasVarMap", "[", "nsd_nsData", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"aliasMap", "[", "nsd", "]"}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"symb", "[", "a_", "]"}], " ", "\[Rule]", " ", 
      RowBox[{"symb", "[", "ns_", "]"}]}], ")"}], "\[RuleDelayed]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"symb", "[", 
       RowBox[{"a", ",", " ", "nm_"}], "]"}], 
      AdjustmentBox["\[RuleDelayed]",
       BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 0.}}], 
      AdjustmentBox[" ",
       BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 0.}}], 
      RowBox[{
       AdjustmentBox["symb",
        BoxMargins->{{-0.2306929800847076, 0.2306929800847076}, {0., 0.}}], 
       AdjustmentBox["[",
        BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 0.}}], 
       
       AdjustmentBox[
        RowBox[{"ns", ",", " ", "nm"}],
        BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 0.}}], 
       
       AdjustmentBox["]",
        BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 
         0.}}]}]}], 
     AdjustmentBox[")",
      BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 
       0.}}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6097945619550743`*^9, 3.609794567004404*^9}, {
   3.609794649130281*^9, 3.60979465053793*^9}, 3.6097947549991198`*^9, {
   3.609795044201004*^9, 3.609795089312398*^9}, {3.609795504470194*^9, 
   3.609795722082026*^9}, {3.6097957932446527`*^9, 3.609795799598997*^9}, {
   3.6097959068441133`*^9, 3.609796209669504*^9}, {3.6097964195712633`*^9, 
   3.609796446320644*^9}, {3.609796702690351*^9, 3.609796730994379*^9}, {
   3.60979680012842*^9, 3.6097968196793213`*^9}, {3.6097969502383003`*^9, 
   3.60979695226099*^9}, {3.609796987100778*^9, 3.609797008330043*^9}, {
   3.6097972286472893`*^9, 3.609797228877557*^9}, {3.609797435352722*^9, 
   3.6097974427525806`*^9}, {3.609812233048337*^9, 3.6098122589750423`*^9}, {
   3.609813038418571*^9, 3.609813132990275*^9}, {3.609813193002799*^9, 
   3.609813196827655*^9}, {3.6098134113079643`*^9, 3.6098134313049803`*^9}, {
   3.609814268737215*^9, 3.609814271735549*^9}, {3.610440387411509*^9, 
   3.610440392785549*^9}, {3.61101138183171*^9, 3.611011419359302*^9}, {
   3.612394318839374*^9, 3.61239432115814*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandAliasedVars", "[", 
   RowBox[{"nsds", ":", 
    RowBox[{"{", "___nsData", "}"}]}], "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Map", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"nsd", ",", "\[IndentingNewLine]", 
      RowBox[{"update", "[", 
       RowBox[{"nsd", ",", " ", "\"\<topDefs\>\"", ",", " ", 
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{"aliasVarMap", "[", "nsd", "]"}]}], "&"}]}], "]"}]}], "]"}],
     ",", "\[IndentingNewLine]", "nsds"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.609794011345903*^9, 3.609794232188349*^9}, {
   3.609794294595677*^9, 3.609794322082171*^9}, {3.609794363137237*^9, 
   3.609794364802099*^9}, {3.609794395297037*^9, 3.609794558268877*^9}, {
   3.609794747552103*^9, 3.6097948070785017`*^9}, {3.6097950346178417`*^9, 
   3.609795040377336*^9}, {3.609795763603141*^9, 3.6097957895130053`*^9}, {
   3.6097960781384783`*^9, 3.6097960793499527`*^9}, {3.609796656051499*^9, 
   3.6097966965552464`*^9}, {3.6098140238352623`*^9, 
   3.6098140239859037`*^9}, {3.6098148470005283`*^9, 3.609814847727777*^9}, 
   3.610440665683219*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["expandVars", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.609855308477116*^9, 3.609855310395756*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandVars", "[", 
   RowBox[{"nsds", ":", 
    RowBox[{"{", "___nsData", "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"nsds", "//", "expandAliasedVars"}], "//", 
   "expandIntranamespaceVars"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.609793257408784*^9, 3.609793282927454*^9}, 
   3.609793313689014*^9, {3.609793378103998*^9, 3.60979341903165*^9}, {
   3.6097935374926043`*^9, 3.609793548052568*^9}, {3.60979724048482*^9, 
   3.609797251773683*^9}, {3.6097972883234043`*^9, 3.609797290619759*^9}, {
   3.609811934567346*^9, 3.609811936418545*^9}, {3.609813121693036*^9, 
   3.6098131238855743`*^9}, {3.610740487872706*^9, 3.610740488951466*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["nsGraph", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6100774110303507`*^9, 3.6100774126282797`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"defrefs", "[", "df_definingForm", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"qwikCases", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getBody", "[", "df", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", ":", 
      RowBox[{"symb", "[", 
       RowBox[{"_", ",", "_"}], "]"}]}], "\[RuleDelayed]", 
     RowBox[{"stringify", "[", "s", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610077914602257*^9, 3.610077923103558*^9}, {
  3.610078010667119*^9, 3.610078026165422*^9}, {3.6100780632672586`*^9, 
  3.610078073473043*^9}, {3.610079796783955*^9, 3.610079797612877*^9}, {
  3.610439780150536*^9, 3.610439781186903*^9}, {3.6104455177743187`*^9, 
  3.610445520504147*^9}, {3.61044555724335*^9, 3.610445618079688*^9}, {
  3.610450330995612*^9, 3.6104503577309303`*^9}, {3.610450401946204*^9, 
  3.6104504042034273`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"defGraph", "[", "df_definingForm", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d", "=", 
      RowBox[{"stringify", "[", 
       RowBox[{"getDefiniendum", "[", "df", "]"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graph", "[", 
     RowBox[{
      RowBox[{"{", "d", "}"}], ",", 
      RowBox[{"Union", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", "\[DirectedEdge]", "#"}], "&"}], ")"}], "/@", 
        RowBox[{"defrefs", "[", "df", "]"}]}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610077780496315*^9, 3.610077870134404*^9}, {
  3.610078322625333*^9, 3.6100783319600363`*^9}, {3.6100784357058372`*^9, 
  3.610078436586287*^9}, {3.610439775184567*^9, 3.610439776585741*^9}, {
  3.61044436487989*^9, 3.61044437073256*^9}, {3.6104444498918133`*^9, 
  3.610444453858474*^9}, {3.61044562401705*^9, 3.61044563024793*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsGraph", "[", "nsdt_nsData", "]"}], ":=", 
  RowBox[{"graphUnion2", " ", "@@", 
   RowBox[{"(", 
    RowBox[{"defGraph", "/@", 
     RowBox[{"topDefs", "[", "nsdt", "]"}]}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610077500196782*^9, 3.610077513611018*^9}, {
  3.610077547370698*^9, 3.610077548268529*^9}, {3.610077594518313*^9, 
  3.6100777774720297`*^9}, {3.610079015592778*^9, 3.610079025654418*^9}, {
  3.610444615408032*^9, 3.610444616871752*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsGraph", "[", 
   RowBox[{"nsdts", ":", 
    RowBox[{"{", "___nsData", "}"}]}], "]"}], ":=", 
  RowBox[{"graphUnion2", " ", "@@", 
   RowBox[{"(", 
    RowBox[{"nsGraph", "/@", "nsdts"}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610077426069775*^9, 3.610077493530346*^9}, {
  3.61007903158296*^9, 3.610079045541662*^9}, {3.610444618759241*^9, 
  3.610444620416692*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["graphProject", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.609855294524439*^9, 3.6098552974999743`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphProject", "[", "asts_List", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"asts", "//", "nodify"}], "//", "toNsData"}], "//", 
    "expandVars"}], "//", "nsGraph"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60979342796974*^9, 3.609793453469955*^9}, {
  3.60979349000483*^9, 3.609793562452132*^9}, {3.609856608212119*^9, 
  3.60985660992583*^9}, {3.610124022356863*^9, 3.6101240400660267`*^9}, {
  3.610133015296801*^9, 3.610133017512093*^9}, {3.610389733251082*^9, 
  3.610389737163827*^9}, {3.6103898426864243`*^9, 3.610389844553645*^9}, {
  3.610398104316517*^9, 3.610398105532381*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphProject", "[", "projectPath_String", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"projectPath", "//", "parseProject"}], "//", 
   "graphProject"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6097936669693937`*^9, 3.609793723904351*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphFile", "[", "f_String", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "//", "parseFile"}], "//", "List"}], "//", 
   "graphProject"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6107407319944677`*^9, 3.610740734136409*^9}, {
  3.6107407887181396`*^9, 3.610740818436824*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Review & Todo", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.610450647129668*^9, 3.610450653039413*^9}}],

Cell["\<\
This file could be much shorter, and would have been faster to write, if the \
parse tree had been more to the point originally. We definitely want to \
nodify, but the rules could have been much simpler, it seems to me. (Maybe \
not.)

We also lost a fair amount of time dithering over the correct representation, \
and whether it makes sense to nodify things or just recalculate using some \
globally defined patterns without modifying the tree at all. The later course \
of action proved intractably cumbersome with no clear advantages other than \
an appeal to knee-jerk conservatism, stupid in the presence of immutability.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.610450748725988*^9, 3.6104509210892076`*^9}}],

Cell["\<\
We\[CloseCurlyQuote]ll want some way to tag vars we\[CloseCurlyQuote]re \
graphing with their general type (defrecord, defprotcol, multimethod, \
function, just a thing, etc). Also need some treatment for more subtle \
defining forms like multimethods, protocols, etc.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.610450649599959*^9, 3.610450730469689*^9}}],

Cell["\<\
Also \[OpenCurlyDoubleQuote]projectGraph\[CloseCurlyDoubleQuote] would be a \
better name than \[OpenCurlyDoubleQuote]graphProject.\[CloseCurlyDoubleQuote]\
\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6104521421564417`*^9, 3.610452153866802*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Smush", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.6104504321906776`*^9, 3.610450434869288*^9}}],

Cell[CellGroupData[{

Cell["Namespace Communities", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610450447759166*^9, 3.610450449969255*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getNamespaceName", "[", "s_String", "]"}], ":=", 
  RowBox[{
   RowBox[{"StringCases", "[", 
    RowBox[{"s", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ns__", "~~", "\"\</\>\"", "~~", "__"}], "\[RuleDelayed]", 
        " ", "ns"}], ",", " ", 
       RowBox[{"_", "\[Rule]", " ", "Null"}]}], "}"}]}], "]"}], "//", 
   "First"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610451219236598*^9, 3.610451300063017*^9}, {
  3.610451696364637*^9, 3.6104517415832*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"varsByNamespace", "[", "g_Graph", "]"}], ":=", 
  RowBox[{"groupBy", "[", 
   RowBox[{
    RowBox[{"VertexList", "[", "g", "]"}], ",", "getNamespaceName"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610450467072275*^9, 3.610450511468999*^9}, {
   3.6104512161361322`*^9, 3.610451216943095*^9}, {3.610451671864397*^9, 
   3.6104516876892776`*^9}, {3.610451753410536*^9, 3.6104517544198437`*^9}, 
   3.610559033286332*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"namespaceCommunities", "[", "g_Graph", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"varsByNamespace", "[", "g", "]"}], "/.", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"ns_", " ", "\[Rule]", " ", "vs_"}], ")"}], "\[RuleDelayed]", 
    " ", 
    RowBox[{"Labeled", "[", 
     RowBox[{"vs", ",", "ns"}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6105688799120817`*^9, 3.610568892305365*^9}}],

Cell["\<\
Could make this subtler to preserve other styles, if it becomes an issue:\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.611000329829915*^9, 3.611000345236788*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"colorVertsByNamespace", "[", "g_Graph", "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"let", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vbn", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"varsByNamespace", "[", "g", "]"}], ",", " ", "First"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"cf", "=", 
       RowBox[{"ColorData", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<DarkRainbow\>\"", ",", "\"\<Reverse\>\""}], "}"}], 
        "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"addGraphOpts", "[", "\[IndentingNewLine]", 
     RowBox[{"g", ",", "\[IndentingNewLine]", 
      RowBox[{"VertexStyle", "\[Rule]", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{"qwikMapIndexed", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"nsv", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"nsv", "/.", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ns_", "\[Rule]", " ", "vs_"}], ")"}], 
              "\[RuleDelayed]", " ", "\[IndentingNewLine]", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"c", "=", 
                  RowBox[{"cf", "[", 
                   FractionBox["i", 
                    RowBox[{"Length", "[", "vbn", "]"}]], "]"}]}], "}"}], ",", 
                RowBox[{"Replace", "[", 
                 RowBox[{"vs", ",", " ", 
                  RowBox[{"v_", " ", "\[RuleDelayed]", " ", 
                   RowBox[{"(", 
                    RowBox[{"v", "\[Rule]", "c"}], ")"}]}], ",", 
                  RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}]}]}], "]"}], ",",
           "\[IndentingNewLine]", "vbn"}], "]"}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610998573211959*^9, 3.610998616817216*^9}, {
   3.610998657246208*^9, 3.610998697933797*^9}, {3.610998756864399*^9, 
   3.610998851143195*^9}, {3.610998891234967*^9, 3.6109990036707067`*^9}, {
   3.61099951994842*^9, 3.610999718983132*^9}, {3.610999764545557*^9, 
   3.6109998321280203`*^9}, {3.611000378153893*^9, 3.6110005023392763`*^9}, {
   3.6110006941462793`*^9, 3.611000708597493*^9}, 3.611007953014205*^9, {
   3.6110083384054317`*^9, 3.611008350610318*^9}, {3.6110083893616667`*^9, 
   3.611008406233789*^9}, {3.611008443522596*^9, 3.61100846109695*^9}, {
   3.61577690084205*^9, 3.615776904627035*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unqualified Names", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610561376171624*^9, 3.610561379433832*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"unqualifiedName", "[", "s_String", "]"}], ":=", " ", 
  RowBox[{"StringReplace", "[", 
   RowBox[{"s", ",", 
    RowBox[{
     RowBox[{"__", "~~", "\"\</\>\"", "~~", "n__"}], "\[RuleDelayed]", " ", 
     "n"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6105610410401163`*^9, 3.610561134993113*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"unqualifiedName", "[", "x_", "]"}], ":=", "x"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610561200468191*^9, 3.6105612056994467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"addUnqualifiedNameLabels", "[", "g_Graph", "]"}], ":=", 
  RowBox[{"addGraphOpts", "[", 
   RowBox[{"g", ",", " ", 
    RowBox[{"VertexLabels", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Rule]", " ", 
         RowBox[{"unqualifiedName", "[", "#", "]"}]}], "&"}], "/@", 
       RowBox[{"VertexList", "[", "g", "]"}]}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610560867351274*^9, 3.610560869878811*^9}, {
  3.610560962612029*^9, 3.610561031132012*^9}, {3.610561156592494*^9, 
  3.61056119377938*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Glam", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.612394501775454*^9, 3.6123945051399183`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ornamentProject", "[", "g_Graph", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"g", "//", "ornament"}], "//", "colorVertsByNamespace"}], "//", 
   "addUnqualifiedNameLabels"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612394457696207*^9, 3.612394475299385*^9}, {
  3.612397214432919*^9, 3.612397214811243*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vertex nabbing", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6123978766737947`*^9, 3.612397879168398*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vertSelect", "[", 
   RowBox[{"g_Graph", ",", " ", "pred_"}], "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"VertexList", "@", "g"}], ",", "pred"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612397467799613*^9, 3.6123975077079163`*^9}, {
  3.612398081885593*^9, 3.612398083205925*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vertCases", "[", 
   RowBox[{"g_Graph", ",", "p_"}], "]"}], ":=", " ", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"VertexList", "@", "g"}], ",", "p"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612397695367611*^9, 3.612397713284607*^9}, {
  3.612398091036993*^9, 3.612398101203575*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vertStringMatches", "[", 
   RowBox[{"g_Graph", ",", " ", "p_"}], "]"}], ":=", " ", 
  RowBox[{"vertSelect", "[", 
   RowBox[{"g", ",", " ", 
    RowBox[{"x", "\[Function]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"StringQ", "[", "x", "]"}], "\[And]", " ", 
       RowBox[{"StringMatchQ", "[", 
        RowBox[{"x", ",", "p"}], "]"}]}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6123975362819033`*^9, 3.612397590345786*^9}, {
  3.6123976434361753`*^9, 3.612397645532023*^9}, {3.612397721797194*^9, 
  3.612397727830462*^9}, {3.612397775635683*^9, 3.612397781339246*^9}, {
  3.6123978286847363`*^9, 3.6123978569971848`*^9}, {3.612398087189378*^9, 
  3.612398088398464*^9}, {3.612398152016493*^9, 3.6123981775171623`*^9}, {
  3.612398213247163*^9, 3.612398274033856*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vertStringMatches", "[", 
   RowBox[{"g_Graph", ",", " ", "ps_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Join", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"vertStringMatches", "[", 
       RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", "ps"}], 
    ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.618159162244836*^9, 3.618159226791403*^9}, {
  3.618512385698038*^9, 3.6185123960247087`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Edge Nabbing", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.614896932991982*^9, 3.614896940275976*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"edgeStringMatches", "[", 
   RowBox[{"g_Graph", ",", " ", "p1_", ",", " ", "p2_"}], "]"}], ":=", " ", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"EdgeList", "[", "g", "]"}], ",", 
    RowBox[{
     RowBox[{"_", "[", 
      RowBox[{"l_", ",", "r_"}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"StringMatchQ", "[", 
        RowBox[{"l", ",", "p1"}], "]"}], "\[And]", 
       RowBox[{"StringMatchQ", "[", 
        RowBox[{"r", ",", "p2"}], "]"}]}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612661050420208*^9, 3.6126611616905413`*^9}, {
   3.612661501215685*^9, 3.612661589334016*^9}, {3.612662178030319*^9, 
   3.612662207858614*^9}, 3.612662352227208*^9, {3.612662486975588*^9, 
   3.612662488283267*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Component Nabbing", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.612622862129237*^9, 3.612622864433592*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"componentWithVertex", "[", 
   RowBox[{"g_Graph", ",", " ", "vs_List"}], "]"}], ":=", " ", 
  RowBox[{"Subgraph", "[", 
   RowBox[{"g", ",", " ", 
    RowBox[{"WeaklyConnectedComponents", "[", 
     RowBox[{"g", ",", "vs"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612396868662723*^9, 3.612396966696204*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["CLR stuff", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.612462918073955*^9, 3.612462919520483*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"removeProbableCLRStatics", "[", "g_Graph", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"VertexDelete", "[", 
   RowBox[{"g", ",", 
    RowBox[{"vertStringMatches", "[", 
     RowBox[{"g", ",", 
      RowBox[{"RegularExpression", "[", "\"\<[A-Z].*/.*\>\"", "]"}]}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612462669117148*^9, 3.612462811960257*^9}, {
  3.612462940159107*^9, 3.612462941909457*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sloppy", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.614896916713455*^9, 3.614896917984445*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"patternForSubstring", "[", "s_String", "]"}], ":=", " ", 
  RowBox[{"___", "~~", "s", "~~", "___"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612661750769816*^9, 3.6126617861819057`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pfs", "=", "patternForSubstring"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612661788842353*^9, 3.612661792870392*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"regex", "=", "RegularExpression"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.61246273729249*^9, 3.612462741406743*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rpclrs", "=", "removeProbableCLRStatics"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612462840757883*^9, 3.6124628480110683`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vsm", "=", "vertStringMatches"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612663264667663*^9, 3.612663270946165*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sloppyEdgeAdd", "[", 
   RowBox[{"g_Graph", ",", " ", "es_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"EdgeAdd", "[", 
   RowBox[{"g", ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Tuples", "/@", 
      RowBox[{"Replace", "[", 
       RowBox[{"es", ",", 
        RowBox[{"x_", "\[RuleDelayed]", " ", 
         RowBox[{"vsm", "[", 
          RowBox[{"g", ",", "x"}], "]"}]}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6126635319438477`*^9, 3.612663602853861*^9}, {
  3.612663714153637*^9, 3.612663778961193*^9}, {3.612663822031548*^9, 
  3.6126638264752274`*^9}, {3.612663889158257*^9, 3.612663896949793*^9}, {
  3.612664548589522*^9, 3.612664571661318*^9}, {3.612664665937681*^9, 
  3.6126646661357393`*^9}, {3.612664777356161*^9, 3.612664807736454*^9}, {
  3.6126650703705463`*^9, 3.612665123460739*^9}, {3.6126651713505573`*^9, 
  3.612665173884782*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sloppyEdgeDelete", "[", 
   RowBox[{"g_Graph", ",", " ", "es_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"EdgeDelete", "[", 
   RowBox[{"g", ",", 
    RowBox[{"qwikCases", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"edgeStringMatches", "[", 
         RowBox[{"g", ",", "##"}], "]"}], "&"}], "@@@", "es"}], ",", 
      "_DirectedEdge"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6126635319438477`*^9, 3.612663602853861*^9}, {
  3.612663714153637*^9, 3.612663778961193*^9}, {3.612663822031548*^9, 
  3.6126638264752274`*^9}, {3.612663889158257*^9, 3.612663896949793*^9}, {
  3.612664548589522*^9, 3.612664571661318*^9}, {3.612664665937681*^9, 
  3.6126646661357393`*^9}, {3.612664777356161*^9, 3.612664807736454*^9}, {
  3.6126650703705463`*^9, 3.612665123460739*^9}, {3.6126651713505573`*^9, 
  3.612665173884782*^9}, {3.6127115838914013`*^9, 3.612711585034382*^9}, {
  3.612711650800474*^9, 3.612711688222591*^9}, {3.612711720015526*^9, 
  3.612711731666054*^9}, {3.61271177578198*^9, 3.612711797701847*^9}, {
  3.612711828471561*^9, 3.61271183550143*^9}, {3.612711903193315*^9, 
  3.612711909834234*^9}, {3.6127120943753967`*^9, 3.612712095071714*^9}, {
  3.614899146621483*^9, 3.6148991468786793`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sloppyVertexDelete", "[", 
   RowBox[{"g_Graph", ",", "es_List"}], "]"}], ":=", 
  RowBox[{"VertexDelete", "[", 
   RowBox[{"g", ",", 
    RowBox[{"DeleteDuplicates", "@", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vertStringMatches", "[", 
         RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", "es"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6148994279296093`*^9, 3.614899467641119*^9}, {
  3.614963057583568*^9, 3.614963168610524*^9}, {3.617823334617865*^9, 
  3.6178233368658857`*^9}, {3.6181579876188183`*^9, 3.618157991419222*^9}}],

Cell[CellGroupData[{

Cell["vsmpfs", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.62012850086769*^9, 3.620128502050921*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vsmpfs", "[", 
   RowBox[{"g_Graph", ",", 
    RowBox[{"s_", "?", "stringishQ"}]}], "]"}], ":=", " ", 
  RowBox[{"vsm", "[", 
   RowBox[{"g", ",", 
    RowBox[{"pfs", "@", "s"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.619461607609006*^9, 3.6194616503856688`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vsmpfs", "[", 
   RowBox[{"g_Graph", ",", "ss_List"}], "]"}], ":=", " ", 
  RowBox[{"vsm", "[", 
   RowBox[{"g", ",", 
    RowBox[{"pfs", "/@", "ss"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.619461652153893*^9, 3.619461667784573*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
sloppyHighlight, sloppyNeighborhoodGraph\
\>", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6201284871564913`*^9, 3.620128496058958*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sloppyHighlight", "[", 
   RowBox[{"g_Graph", ",", " ", 
    RowBox[{"s", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"_", "?", "stringishQ"}], "|", "List_"}], ")"}]}]}], "]"}], ":=", 
  RowBox[{"HighlightGraph", "[", 
   RowBox[{"g", ",", 
    RowBox[{"Subgraph", "[", 
     RowBox[{"g", ",", 
      RowBox[{"vsmpfs", "[", 
       RowBox[{"g", ",", "s"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.618806404302909*^9, 3.6188064050156727`*^9}, {
  3.619455152336134*^9, 3.619455213332818*^9}, {3.619455628228817*^9, 
  3.6194556387667017`*^9}, {3.619456356859542*^9, 3.61945636645938*^9}, {
  3.6194616711620007`*^9, 3.619461727879364*^9}, {3.619462156288303*^9, 
  3.6194621613594503`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sloppyNeighborhoodGraph", "[", 
   RowBox[{"g_Graph", ",", " ", 
    RowBox[{"s", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"_", "?", "stringishQ"}], "|", "List_"}], ")"}]}], ",", " ", 
    "n___"}], "]"}], ":=", " ", 
  RowBox[{"NeighborhoodGraph", "[", 
   RowBox[{"g", ",", 
    RowBox[{"vsmpfs", "[", 
     RowBox[{"g", ",", "s"}], "]"}], ",", "n"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.619456294298457*^9, 3.6194563015231657`*^9}, {
  3.619456390479701*^9, 3.619456415947279*^9}, {3.6194564613946743`*^9, 
  3.619456483940576*^9}, {3.619461271963933*^9, 3.619461289484234*^9}, {
  3.6194613456241093`*^9, 3.6194614231934557`*^9}, {3.619461502345592*^9, 
  3.619461533299203*^9}, {3.619461564451126*^9, 3.619461593609644*^9}, {
  3.619461766058503*^9, 3.619461788941882*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Subgraphs", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.615778221760912*^9, 3.6157782229038153`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphCycles", "[", 
   RowBox[{"g_Graph", ",", " ", "args___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Subgraph", "[", 
     RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"ConnectedComponents", "[", 
      RowBox[{"g", ",", "args"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "#", "]"}], ">", "1"}], "&"}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615777855374001*^9, 3.6157778707027493`*^9}, {
  3.615777974293791*^9, 3.6157780535478573`*^9}, {3.615778495582624*^9, 
  3.615778495930047*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphDifference2", "[", 
   RowBox[{"gAll_Graph", ",", " ", "gs___Graph"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Subgraph", "[", 
   RowBox[{"gAll", ",", 
    RowBox[{"Complement", "[", 
     RowBox[{
      RowBox[{"VertexList", "[", "gAll", "]"}], ",", " ", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"(", 
        RowBox[{"VertexList", "/@", 
         RowBox[{"{", "gs", "}"}]}], ")"}]}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615779116483562*^9, 3.615779233067151*^9}, {
  3.615779395979979*^9, 3.61577939845961*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sexy abstract functions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6157826635977793`*^9, 3.615782666324596*^9}, {
  3.615782711847163*^9, 3.6157827167171917`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapAgainstOthers", "[", 
   RowBox[{"f_", ",", "stuff_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"qwikMapIndexed", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "i"}], "}"}], "\[Function]", 
     RowBox[{"f", "[", 
      RowBox[{"x", ",", 
       RowBox[{"stuff", "\[LeftDoubleBracket]", 
        RowBox[{";;", 
         RowBox[{"i", "-", "1"}]}], "\[RightDoubleBracket]"}], ",", " ", 
       RowBox[{"stuff", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"i", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", "stuff"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615781626685569*^9, 3.61578174053032*^9}, {
  3.615781813566596*^9, 3.615781824294341*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples, glutch", "Section",
 CellChangeTimes->{{3.610448418558507*^9, 3.610448422475556*^9}, {
  3.6106491691562767`*^9, 3.6106491745319233`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "graphProject", "[", 
   "\"\</Users/timothygardner/code/mathematica-clojure-analysis/clj-test-\
project/src/\>\"", "]"}], "//", "ornament"}]], "Input",
 CellChangeTimes->{{3.610447471751474*^9, 3.61044747221865*^9}, {
  3.610447713007024*^9, 3.610447740406928*^9}, {3.61044779927914*^9, 
  3.61044780079723*^9}}],

Cell[BoxData[
 RowBox[{"let", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"g", "=", 
      RowBox[{
      "graphProject", "[", 
       "\"\</Users/timothygardner/code/mathematica-clojure-analysis/clj-test-\
project/src/\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"nsm", "=", " ", 
      RowBox[{"varsByNamespace", "[", "g", "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"CommunityGraphPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "//", "addToolTips"}], "//", "addUnqualifiedNameLabels"}], 
     ",", 
     RowBox[{"nsm", "/.", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ns_", " ", "\[Rule]", " ", "vs_"}], ")"}], "\[RuleDelayed]", 
       " ", 
       RowBox[{"Labeled", "[", 
        RowBox[{"vs", ",", "ns"}], "]"}]}]}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.610447471751474*^9, 3.61044747221865*^9}, {
  3.610447713007024*^9, 3.610447740406928*^9}, {3.61044779927914*^9, 
  3.61044780079723*^9}, {3.61045179864142*^9, 3.6104518634165163`*^9}, {
  3.610451906916009*^9, 3.610451973133786*^9}, {3.61045206369525*^9, 
  3.610452103821458*^9}, {3.610561390366461*^9, 3.6105613937163143`*^9}, {
  3.610561671300583*^9, 3.610561692523582*^9}}],

Cell[BoxData[
 RowBox[{"let", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"g", "=", 
     RowBox[{
     "graphProject", "[", "\"\</Users/timothygardner/code/ClojureLink\>\"", 
      "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"CommunityGraphPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "//", "addToolTips"}], "//", "addUnqualifiedNameLabels"}], 
     ",", 
     RowBox[{"namespaceCommunities", "[", "g", "]"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.610447471751474*^9, 3.61044747221865*^9}, {
  3.610447713007024*^9, 3.610447740406928*^9}, {3.61044779927914*^9, 
  3.61044780079723*^9}, {3.61045179864142*^9, 3.6104518634165163`*^9}, {
  3.610451906916009*^9, 3.610451973133786*^9}, {3.61045206369525*^9, 
  3.610452103821458*^9}, {3.610455748209303*^9, 3.610455750806202*^9}, {
  3.610484308443912*^9, 3.61048432789806*^9}, {3.610484385136224*^9, 
  3.610484387063624*^9}, {3.610561418714509*^9, 3.610561420361993*^9}, {
  3.610568721733883*^9, 3.610568725401903*^9}, {3.6105689243759336`*^9, 
  3.610568946132617*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6105255455662003`*^9, 3.610525552328529*^9}}],

Cell[BoxData[
 RowBox[{"let", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"g", "=", 
      RowBox[{
      "graphProject", "[", "\"\</Users/timothygardner/code/quil\>\"", "]"}]}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"nsm", "=", " ", 
      RowBox[{"varsByNamespace", "[", "g", "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Column", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"CommunityGraphPlot", "[", 
       RowBox[{
        RowBox[{"g", "//", "addToolTips"}], ",", 
        RowBox[{"nsm", "/.", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ns_", " ", "\[Rule]", " ", "vs_"}], ")"}], 
          "\[RuleDelayed]", " ", 
          RowBox[{"Labeled", "[", 
           RowBox[{"vs", ",", "ns"}], "]"}]}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"g", "//", "EdgeList"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.610447471751474*^9, 3.61044747221865*^9}, {
  3.610447713007024*^9, 3.610447740406928*^9}, {3.61044779927914*^9, 
  3.61044780079723*^9}, {3.61045179864142*^9, 3.6104518634165163`*^9}, {
  3.610451906916009*^9, 3.610451973133786*^9}, {3.61045206369525*^9, 
  3.610452103821458*^9}, {3.610455748209303*^9, 3.610455750806202*^9}, {
  3.610484308443912*^9, 3.61048432789806*^9}, {3.610484385136224*^9, 
  3.610484387063624*^9}, {3.61052555921926*^9, 3.6105255720104837`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"let", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"path", "=", 
       RowBox[{"$HomeDirectory", "<>", "\"\</code/tools.nrepl\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"cfs", "=", 
       RowBox[{"path", "//", "clojureFiles"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", " ", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"parseFile", "[", "#", "]"}], ",", 
               RowBox[{
                RowBox[{"er", ":", "\:0589index"}], "\[RuleDelayed]", " ", 
                "er"}], ",", "\[Infinity]"}], "]"}]}], "}"}], "&"}], "/@", 
          "cfs"}], ")"}], "//", "Grid"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"path", "//", "graphProject"}], "//", 
        "addUnqualifiedNameLabels"}]}], "}"}], "]"}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.610572610558305*^9, 3.61057262215063*^9}, {
  3.610572694724393*^9, 3.61057279416717*^9}, {3.6105728347355328`*^9, 
  3.610573007132886*^9}, {3.610573064775188*^9, 3.610573094413515*^9}, {
  3.610573149970067*^9, 3.6105731546392517`*^9}, {3.6106415323235617`*^9, 
  3.610641584300267*^9}, {3.610641625143992*^9, 3.610641701892809*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "\"\</Users/timothygardner/code/tools.nrepl/src/main/clojure/clojure/tools/\
nrepl/bencode.clj\>\"", "//", "parseFile"}], "//", "nodify"}]], "Input",
 CellChangeTimes->{{3.610641763996476*^9, 3.61064176519385*^9}, {
  3.6107396235025883`*^9, 3.610739626990603*^9}}],

Cell[BoxData[
 RowBox[{"let", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vbn", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"varsByNamespace", "[", "nreplGraph", "]"}], ",", " ", 
        "First"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"cf", "=", 
      RowBox[{"ColorData", "[", "\"\<DarkRainbow\>\"", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"vclr", "=", " ", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", ",", "i"}], "}"}], ",", " ", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"c", "=", 
              RowBox[{"cf", "[", 
               FractionBox[
                RowBox[{"First", "[", "i", "]"}], 
                RowBox[{"Length", "[", "vbn", "]"}]], "]"}]}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#", "\[Rule]", " ", "c"}], "&"}], ")"}], "/@", 
               RowBox[{
               "r", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
              ")"}]}]}], "]"}]}], "]"}], ",", "vbn"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"setGraphOpts", "[", 
      RowBox[{"nreplGraph", ",", " ", 
       RowBox[{"VertexStyle", "\[Rule]", " ", "vclr"}]}], "]"}], "//", 
     "addUnqualifiedNameLabels"}], "//", "addToolTips"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.610648223700913*^9, 3.610648336409252*^9}, {
  3.6106484194713306`*^9, 3.6106488590605297`*^9}, {3.6106496096599607`*^9, 
  3.610649613815805*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.610649263869487*^9, 3.610649263984744*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"varsByNamespace", "[", "nreplGraph", "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}], "//", "Sort"}], "//", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"Print", ",", "#"}], "]"}], "&"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6106500864094267`*^9, 3.610650111153758*^9}, 
   3.610650181253422*^9, {3.614894830229122*^9, 3.614894834891363*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"upperCaseStartQ", "[", "s_String", "]"}], ":=", " ", 
  RowBox[{"StringMatchQ", "[", 
   RowBox[{"s", ",", 
    RowBox[{
     RowBox[{"_", "?", "UpperCaseQ"}], "~~", "___"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6106504066184607`*^9, 3.610650482189412*^9}, {
  3.610650519045073*^9, 3.610650556515773*^9}}],

Cell[BoxData[
 RowBox[{"StringMatchQ", "[", 
  RowBox[{"\"\<Bla\>\"", ",", 
   RowBox[{
    RowBox[{"_", "?", "UpperCaseQ"}], "~~", "___"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.610650602185617*^9, 3.610650607609894*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"varsByNamespace", "[", "nreplGraph", "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}], "//", "Sort"}], "//", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"#", ",", " ", 
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"upperCaseStartQ", "[", "#", "]"}]}], "&"}]}], "]"}], 
     "&"}]}], "//", 
   RowBox[{
    RowBox[{"Print", "/@", "#"}], "&"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6106500864094267`*^9, 3.610650111153758*^9}, 
   3.610650181253422*^9, {3.610650232639723*^9, 3.6106503371449537`*^9}, {
   3.610650377529264*^9, 3.610650401327703*^9}, {3.610650466302096*^9, 
   3.610650477333137*^9}, {3.61065062499671*^9, 3.6106506536822968`*^9}}],

Cell[BoxData[
 RowBox[{"?", "addToolTips"}]], "Input",
 CellChangeTimes->{{3.61065266142118*^9, 3.610652664042603*^9}}],

Cell[BoxData[
 RowBox[{"Graph", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Tooltip", "[", 
     RowBox[{
     "\"\<fish\>\"", ",", " ", 
      "\"\<Now is the winter\\n of our discontent\>\""}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", "\[DirectedEdge]", "b"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.610652652436116*^9, 3.610652747297868*^9}, {
  3.610653731861341*^9, 3.610653732979477*^9}}],

Cell[BoxData[
 RowBox[{"?", "Graph"}]], "Input",
 CellChangeTimes->{{3.6106535525097523`*^9, 3.610653553444936*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Scan", "[", 
   RowBox[{"Print", ",", " ", 
    RowBox[{"{", 
     RowBox[{"ns", "[", 
      RowBox[{"bla", ",", " ", 
       RowBox[{"ns", "[", "gra", "]"}]}], "]"}], "}"}], ",", "\[Infinity]"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.610733354686872*^9, 3.6107333973033447`*^9}}],

Cell[BoxData[
 RowBox[{"let", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nss", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"nreplGraph", "//", "VertexList"}], "//", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"getNamespaceName", ",", "#"}], "]"}], "&"}]}], "//", 
       "Union"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"cf", "=", " ", 
      RowBox[{"ColorData", "[", "\"\<DarkRainbow\>\"", "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
    RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "pos"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cf", "[", 
           FractionBox[
            RowBox[{"First", "[", "pos", "]"}], 
            RowBox[{"Length", "[", "nss", "]"}]], "]"}], ",", " ", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"First", "[", "pos", "]"}], ",", "5"}], "]"}], ",", 
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"First", "[", "pos", "]"}], "/", "5"}], "]"}]}], " ", 
             "}"}], ",", ".5"}], "]"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "nss"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6106466330673513`*^9, 3.610646659471971*^9}, {
  3.61064671123146*^9, 3.610646760487574*^9}, {3.610646881607209*^9, 
  3.610646889755896*^9}, {3.610646920294633*^9, 3.6106471830263033`*^9}, {
  3.610647217072461*^9, 3.610647285939272*^9}, {3.610647323125719*^9, 
  3.6106473290438004`*^9}, {3.6106474133198967`*^9, 3.610647501305564*^9}, {
  3.6106476467114973`*^9, 3.610647685846614*^9}, {3.610647730398947*^9, 
  3.6106477832293987`*^9}}]
}, Closed]]
},
WindowSize->{960, 852},
WindowMargins->{{Automatic, 343}, {Automatic, 139}},
ShowSelection->True,
InputAutoReplacements->{
 "\\" -> "\:2024", "--" -> "\:2011", "-=" -> "\:02cd", "''" -> "\:0589", "**" -> 
  "\:204e", "\[DownQuestion]" -> "\:2047", "!!" -> "\:203c"},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"menloExperiment.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 95, 1, 30, "Input"],
Cell[655, 23, 177, 3, 33, "Input",
 InitializationCell->True],
Cell[835, 28, 274, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[1134, 35, 119, 2, 80, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1278, 41, 133, 2, 44, "Subsection",
 InitializationCell->True],
Cell[1414, 45, 372, 9, 33, "Input",
 InitializationCell->True],
Cell[1789, 56, 819, 21, 170, "Input",
 InitializationCell->True],
Cell[2611, 79, 232, 5, 31, "Input",
 InitializationCell->True],
Cell[2846, 86, 185, 4, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[3068, 95, 118, 2, 36, "Subsection",
 InitializationCell->True],
Cell[3189, 99, 155, 3, 33, "Input",
 InitializationCell->True],
Cell[3347, 104, 196, 4, 33, "Input",
 InitializationCell->True],
Cell[3546, 110, 891, 23, 75, "Input",
 InitializationCell->True],
Cell[4440, 135, 244, 7, 31, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[4709, 146, 278, 8, 30, "Input",
 InitializationCell->True],
Cell[4990, 156, 291, 5, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[5330, 167, 240, 4, 36, "Subsection",
 InitializationCell->True],
Cell[5573, 173, 192, 4, 30, "Input",
 InitializationCell->True],
Cell[5768, 179, 275, 7, 31, "Input",
 InitializationCell->True],
Cell[6046, 188, 237, 6, 33, "Input",
 InitializationCell->True],
Cell[6286, 196, 244, 7, 30, "Input",
 InitializationCell->True],
Cell[6533, 205, 284, 8, 33, "Input",
 InitializationCell->True],
Cell[6820, 215, 270, 7, 30, "Input",
 InitializationCell->True],
Cell[7093, 224, 208, 5, 30, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[7338, 234, 127, 2, 36, "Subsection",
 InitializationCell->True],
Cell[7468, 238, 162, 3, 33, "Input",
 InitializationCell->True],
Cell[7633, 243, 654, 15, 31, "Input",
 InitializationCell->True],
Cell[8290, 260, 256, 6, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[8583, 271, 180, 3, 36, "Subsection",
 InitializationCell->True],
Cell[8766, 276, 364, 8, 31, "Input",
 InitializationCell->True],
Cell[9133, 286, 436, 11, 31, "Input",
 InitializationCell->True],
Cell[9572, 299, 392, 9, 31, "Input",
 InitializationCell->True],
Cell[9967, 310, 430, 11, 33, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[10434, 326, 123, 2, 36, "Subsection",
 InitializationCell->True],
Cell[10560, 330, 301, 6, 30, "Text",
 InitializationCell->True],
Cell[10864, 338, 617, 13, 53, "Input",
 InitializationCell->True],
Cell[11484, 353, 1598, 32, 103, "Input",
 InitializationCell->True],
Cell[13085, 387, 701, 15, 30, "Input",
 InitializationCell->True],
Cell[13789, 404, 466, 13, 31, "Input",
 InitializationCell->True],
Cell[14258, 419, 2318, 50, 131, "Input",
 InitializationCell->True],
Cell[16579, 471, 1213, 22, 31, "Input",
 InitializationCell->True],
Cell[17795, 495, 278, 7, 30, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[18110, 507, 120, 2, 36, "Subsection",
 InitializationCell->True],
Cell[18233, 511, 258, 7, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[18528, 523, 122, 2, 36, "Subsection",
 InitializationCell->True],
Cell[18653, 527, 284, 8, 31, "Input",
 InitializationCell->True],
Cell[18940, 537, 1045, 25, 94, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[20010, 566, 1215, 31, 125, "Input",
 InitializationCell->True],
Cell[21228, 599, 1575, 43, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[22852, 648, 123, 2, 36, "Subsection",
 InitializationCell->True],
Cell[22978, 652, 221, 6, 31, "Input",
 InitializationCell->True],
Cell[23202, 660, 531, 14, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[23770, 679, 125, 2, 36, "Subsection",
 InitializationCell->True],
Cell[23898, 683, 164, 3, 31, "Input",
 InitializationCell->True],
Cell[24065, 688, 227, 6, 31, "Input",
 InitializationCell->True],
Cell[24295, 696, 187, 4, 31, "Input",
 InitializationCell->True],
Cell[24485, 702, 276, 6, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[24798, 713, 133, 2, 36, "Subsection",
 InitializationCell->True],
Cell[24934, 717, 248, 5, 30, "Text",
 InitializationCell->True],
Cell[25185, 724, 637, 15, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[25859, 744, 127, 2, 36, "Subsection",
 InitializationCell->True],
Cell[25989, 748, 189, 4, 31, "Input",
 InitializationCell->True],
Cell[26181, 754, 237, 6, 32, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[26467, 766, 183, 3, 50, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[26675, 773, 131, 2, 44, "Subsection",
 InitializationCell->True],
Cell[26809, 777, 375, 8, 31, "Input",
 InitializationCell->True],
Cell[27187, 787, 461, 12, 31, "Input",
 InitializationCell->True],
Cell[27651, 801, 438, 10, 31, "Input",
 InitializationCell->True],
Cell[28092, 813, 623, 13, 49, "Input",
 InitializationCell->True],
Cell[28718, 828, 1090, 27, 85, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[29833, 859, 450, 13, 33, "Input",
 InitializationCell->True],
Cell[30286, 874, 425, 10, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30748, 889, 414, 12, 33, "Input",
 InitializationCell->True],
Cell[31165, 903, 2130, 50, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33332, 958, 600, 15, 33, "Input",
 InitializationCell->True],
Cell[33935, 975, 428, 10, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[34412, 991, 133, 2, 36, "Subsection",
 InitializationCell->True],
Cell[34548, 995, 476, 12, 31, "Input",
 InitializationCell->True],
Cell[35027, 1009, 384, 10, 31, "Input",
 InitializationCell->True],
Cell[35414, 1021, 327, 6, 49, "Text",
 InitializationCell->True],
Cell[35744, 1029, 548, 15, 33, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[36329, 1049, 147, 2, 36, "Subsection",
 InitializationCell->True],
Cell[36479, 1053, 258, 5, 31, "Input",
 InitializationCell->True],
Cell[36740, 1060, 2160, 49, 222, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[38925, 1113, 836, 23, 74, "Input",
 InitializationCell->True],
Cell[39764, 1138, 2834, 66, 70, "Output"]
}, Open  ]],
Cell[42613, 1207, 1090, 19, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[43740, 1231, 140, 2, 36, "Subsection",
 InitializationCell->True],
Cell[43883, 1235, 373, 9, 33, "Input",
 InitializationCell->True],
Cell[44259, 1246, 326, 8, 33, "Input",
 InitializationCell->True],
Cell[44588, 1256, 2443, 59, 233, "Input",
 InitializationCell->True],
Cell[47034, 1317, 447, 9, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[47518, 1331, 129, 2, 36, "Subsection",
 InitializationCell->True],
Cell[47650, 1335, 257, 5, 33, "Input",
 InitializationCell->True],
Cell[47910, 1342, 1057, 26, 112, "Input",
 InitializationCell->True],
Cell[48970, 1370, 229, 5, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[49224, 1379, 547, 11, 33, "Input",
 InitializationCell->True],
Cell[49774, 1392, 403, 8, 70, "Output"]
}, Open  ]],
Cell[50192, 1403, 3118, 67, 347, "Input",
 InitializationCell->True],
Cell[53313, 1472, 656, 17, 53, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[54006, 1494, 139, 2, 36, "Subsection",
 InitializationCell->True],
Cell[54148, 1498, 399, 8, 53, "Input",
 InitializationCell->True],
Cell[54550, 1508, 497, 12, 53, "Input",
 InitializationCell->True],
Cell[55050, 1522, 404, 9, 49, "Input",
 InitializationCell->True],
Cell[55457, 1533, 350, 7, 31, "Input",
 InitializationCell->True],
Cell[55810, 1542, 648, 14, 49, "Input",
 InitializationCell->True],
Cell[56461, 1558, 436, 10, 49, "Input",
 InitializationCell->True],
Cell[56900, 1570, 1304, 24, 109, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[58241, 1599, 170, 3, 36, "Subsection",
 InitializationCell->True],
Cell[58414, 1604, 162, 3, 31, "Input",
 InitializationCell->True],
Cell[58579, 1609, 153, 2, 30, "Text",
 InitializationCell->True],
Cell[58735, 1613, 216, 5, 31, "Input",
 InitializationCell->True],
Cell[58954, 1620, 190, 4, 31, "Input",
 InitializationCell->True],
Cell[59147, 1626, 233, 6, 33, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[59417, 1637, 125, 2, 36, "Subsection",
 InitializationCell->True],
Cell[59545, 1641, 191, 4, 31, "Input",
 InitializationCell->True],
Cell[59739, 1647, 328, 8, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[60104, 1660, 131, 2, 36, "Subsection",
 InitializationCell->True],
Cell[60238, 1664, 148, 2, 30, "Text",
 InitializationCell->True],
Cell[60389, 1668, 203, 5, 31, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[60617, 1677, 290, 6, 33, "Input",
 InitializationCell->True],
Cell[60910, 1685, 723, 14, 70, "Message"],
Cell[61636, 1701, 263, 4, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[61948, 1711, 130, 2, 36, "Subsection",
 InitializationCell->True],
Cell[62081, 1715, 191, 4, 31, "Input",
 InitializationCell->True],
Cell[62275, 1721, 335, 9, 31, "Input",
 InitializationCell->True],
Cell[62613, 1732, 2404, 53, 145, "Input",
 InitializationCell->True],
Cell[65020, 1787, 2566, 58, 232, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[67623, 1850, 220, 3, 36, "Subsection",
 InitializationCell->True],
Cell[67846, 1855, 348, 6, 31, "Input",
 InitializationCell->True],
Cell[68197, 1863, 1246, 28, 49, "Input",
 InitializationCell->True],
Cell[69446, 1893, 916, 21, 107, "Input",
 InitializationCell->True],
Cell[70365, 1916, 652, 19, 31, "Input",
 InitializationCell->True],
Cell[71020, 1937, 666, 17, 107, "Input",
 InitializationCell->True],
Cell[71689, 1956, 149, 2, 30, "Text",
 InitializationCell->True],
Cell[71841, 1960, 537, 14, 31, "Input",
 InitializationCell->True],
Cell[72381, 1976, 326, 7, 31, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[72744, 1988, 189, 3, 44, "Subsection",
 InitializationCell->True],
Cell[72936, 1993, 327, 7, 33, "Input",
 InitializationCell->True],
Cell[73266, 2002, 1177, 26, 51, "Input",
 InitializationCell->True],
Cell[74446, 2030, 410, 9, 31, "Input",
 InitializationCell->True],
Cell[74859, 2041, 1315, 27, 51, "Input",
 InitializationCell->True],
Cell[76177, 2070, 941, 22, 51, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[77143, 2096, 134, 3, 30, "Input",
 InitializationCell->True],
Cell[77280, 2101, 346, 6, 70, "Output"]
}, Open  ]],
Cell[77641, 2110, 2163, 50, 204, "Input",
 InitializationCell->True],
Cell[79807, 2162, 69, 1, 30, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[79925, 2169, 118, 2, 50, "Section",
 InitializationCell->True],
Cell[80046, 2173, 360, 7, 49, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[80431, 2184, 119, 2, 44, "Subsection",
 InitializationCell->True],
Cell[80553, 2188, 397, 10, 33, "Input",
 InitializationCell->True],
Cell[80953, 2200, 245, 4, 33, "Input",
 InitializationCell->True],
Cell[81201, 2206, 886, 17, 53, "Input",
 InitializationCell->True],
Cell[82090, 2225, 218, 4, 33, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[82345, 2234, 121, 2, 36, "Subsection",
 InitializationCell->True],
Cell[82469, 2238, 226, 5, 30, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[82720, 2247, 160, 3, 31, "Input",
 InitializationCell->True],
Cell[82883, 2252, 292, 4, 30, "Output"]
}, Open  ]],
Cell[83190, 2259, 268, 6, 31, "Input",
 InitializationCell->True],
Cell[83461, 2267, 285, 7, 33, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[83783, 2279, 128, 2, 44, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[83936, 2285, 479, 10, 73, "Input",
 InitializationCell->True],
Cell[84418, 2297, 342, 5, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[84821, 2309, 121, 2, 80, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[84967, 2315, 122, 2, 44, "Subsection",
 InitializationCell->True],
Cell[85092, 2319, 340, 7, 49, "Text",
 InitializationCell->True],
Cell[85435, 2328, 367, 9, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[85827, 2341, 157, 3, 31, "Input",
 InitializationCell->True],
Cell[85987, 2346, 287, 4, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86311, 2355, 214, 4, 31, "Input",
 InitializationCell->True],
Cell[86528, 2361, 321, 5, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86886, 2371, 164, 4, 33, "Input",
 InitializationCell->True],
Cell[87053, 2377, 474, 10, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87564, 2392, 161, 3, 31, "Input",
 InitializationCell->True],
Cell[87728, 2397, 285, 4, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88050, 2406, 344, 8, 33, "Input",
 InitializationCell->True],
Cell[88397, 2416, 475, 10, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88909, 2431, 157, 3, 31, "Input",
 InitializationCell->True],
Cell[89069, 2436, 284, 4, 70, "Output"]
}, Open  ]],
Cell[89368, 2443, 232, 5, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[89625, 2452, 278, 5, 31, "Input",
 InitializationCell->True],
Cell[89906, 2459, 328, 6, 70, "Output"]
}, Open  ]],
Cell[90249, 2468, 241, 5, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[90515, 2477, 243, 5, 33, "Input",
 InitializationCell->True],
Cell[90761, 2484, 471, 10, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91269, 2499, 159, 3, 31, "Input",
 InitializationCell->True],
Cell[91431, 2504, 285, 4, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[91765, 2514, 126, 2, 36, "Subsection",
 InitializationCell->True],
Cell[91894, 2518, 482, 12, 34, "Text",
 InitializationCell->True],
Cell[92379, 2532, 337, 8, 33, "Input",
 InitializationCell->True],
Cell[92719, 2542, 263, 6, 33, "Input",
 InitializationCell->True],
Cell[92985, 2550, 654, 16, 33, "Input",
 InitializationCell->True],
Cell[93642, 2568, 95, 2, 30, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[93786, 2576, 129, 2, 50, "Section",
 InitializationCell->True],
Cell[93918, 2580, 192, 4, 30, "Text",
 InitializationCell->True],
Cell[94113, 2586, 196, 4, 33, "Input",
 InitializationCell->True],
Cell[94312, 2592, 364, 7, 33, "Input",
 InitializationCell->True],
Cell[94679, 2601, 463, 10, 33, "Input",
 InitializationCell->True],
Cell[95145, 2613, 351, 7, 33, "Input"],
Cell[95499, 2622, 373, 7, 33, "Input"],
Cell[95875, 2631, 376, 9, 33, "Input",
 InitializationCell->True],
Cell[96254, 2642, 153, 2, 30, "Text",
 InitializationCell->True],
Cell[96410, 2646, 317, 8, 33, "Input",
 InitializationCell->True],
Cell[96730, 2656, 683, 12, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[97438, 2672, 122, 2, 44, "Subsection",
 InitializationCell->True],
Cell[97563, 2676, 1226, 30, 152, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[98814, 2710, 267, 6, 31, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[99106, 2720, 982, 25, 46, "Print"],
Cell[100091, 2747, 702, 18, 66, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[100866, 2773, 131, 2, 50, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[101022, 2779, 185, 3, 44, "Subsection",
 InitializationCell->True],
Cell[101210, 2784, 246, 6, 31, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[101493, 2795, 91, 1, 44, "Subsection"],
Cell[101587, 2798, 220, 5, 31, "Input",
 InitializationCell->True],
Cell[101810, 2805, 302, 7, 31, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[102149, 2817, 123, 2, 44, "Subsection",
 InitializationCell->True],
Cell[102275, 2821, 264, 6, 31, "Input",
 InitializationCell->True],
Cell[102542, 2829, 237, 6, 31, "Input",
 InitializationCell->True],
Cell[102782, 2837, 6209, 142, 660, "Input",
 InitializationCell->True],
Cell[108994, 2981, 232, 5, 30, "Text",
 InitializationCell->True],
Cell[109229, 2988, 213, 5, 31, "Input",
 InitializationCell->True],
Cell[109445, 2995, 162, 3, 30, "Input",
 InitializationCell->True],
Cell[109610, 3000, 551, 12, 31, "Input",
 InitializationCell->True],
Cell[110164, 3014, 268, 5, 49, "Text",
 InitializationCell->True],
Cell[110435, 3021, 3321, 70, 128, "Input",
 InitializationCell->True],
Cell[113759, 3093, 2217, 47, 149, "Input",
 InitializationCell->True],
Cell[115979, 3142, 450, 9, 31, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[116466, 3156, 127, 2, 44, "Subsection",
 InitializationCell->True],
Cell[116596, 3160, 286, 6, 31, "Input",
 InitializationCell->True],
Cell[116885, 3168, 270, 6, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[117192, 3179, 174, 3, 36, "Subsection",
 InitializationCell->True],
Cell[117369, 3184, 259, 6, 31, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[117653, 3194, 130, 2, 35, "Subsubsection",
 InitializationCell->True],
Cell[117786, 3198, 2138, 48, 239, "Input",
 InitializationCell->True],
Cell[119927, 3248, 242, 5, 30, "Text",
 InitializationCell->True],
Cell[120172, 3255, 885, 19, 69, "Input",
 InitializationCell->True],
Cell[121060, 3276, 279, 6, 31, "Input",
 InitializationCell->True],
Cell[121342, 3284, 377, 8, 33, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[121768, 3298, 125, 2, 36, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[121918, 3304, 193, 3, 35, "Subsubsection",
 InitializationCell->True],
Cell[122114, 3309, 1462, 34, 71, "Input",
 InitializationCell->True],
Cell[123579, 3345, 900, 19, 103, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[124516, 3369, 134, 2, 35, "Subsubsection",
 InitializationCell->True],
Cell[124653, 3373, 172, 3, 33, "Input",
 InitializationCell->True],
Cell[124828, 3378, 1084, 23, 89, "Input",
 InitializationCell->True],
Cell[125915, 3403, 2406, 50, 49, "Input",
 InitializationCell->True],
Cell[128324, 3455, 1210, 25, 111, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[129571, 3485, 128, 2, 35, "Subsubsection",
 InitializationCell->True],
Cell[129702, 3489, 703, 14, 49, "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[130454, 3509, 126, 2, 44, "Subsection",
 InitializationCell->True],
Cell[130583, 3513, 919, 19, 85, "Input",
 InitializationCell->True],
Cell[131505, 3534, 1025, 26, 67, "Input",
 InitializationCell->True],
Cell[132533, 3562, 518, 11, 31, "Input",
 InitializationCell->True],
Cell[133054, 3575, 434, 11, 31, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[133525, 3591, 129, 2, 44, "Subsection",
 InitializationCell->True],
Cell[133657, 3595, 670, 14, 31, "Input",
 InitializationCell->True],
Cell[134330, 3611, 291, 7, 31, "Input",
 InitializationCell->True],
Cell[134624, 3620, 345, 9, 31, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[135018, 3635, 125, 2, 80, "Section",
 InitializationCell->True],
Cell[135146, 3639, 747, 13, 163, "Text",
 InitializationCell->True],
Cell[135896, 3654, 385, 7, 68, "Text",
 InitializationCell->True],
Cell[136284, 3663, 276, 6, 30, "Text",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[136597, 3674, 119, 2, 50, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[136741, 3680, 136, 2, 44, "Subsection",
 InitializationCell->True],
Cell[136880, 3684, 545, 15, 33, "Input",
 InitializationCell->True],
Cell[137428, 3701, 485, 11, 31, "Input",
 InitializationCell->True],
Cell[137916, 3714, 457, 12, 31, "Input",
 InitializationCell->True],
Cell[138376, 3728, 190, 4, 30, "Text",
 InitializationCell->True],
Cell[138569, 3734, 2644, 57, 323, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[141250, 3796, 132, 2, 44, "Subsection",
 InitializationCell->True],
Cell[141385, 3800, 361, 9, 31, "Input",
 InitializationCell->True],
Cell[141749, 3811, 188, 4, 31, "Input",
 InitializationCell->True],
Cell[141940, 3817, 615, 15, 51, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[142592, 3837, 121, 2, 36, "Subsection",
 InitializationCell->True],
Cell[142716, 3841, 374, 9, 31, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[143127, 3855, 131, 2, 44, "Subsection",
 InitializationCell->True],
Cell[143261, 3859, 364, 9, 31, "Input",
 InitializationCell->True],
Cell[143628, 3870, 354, 9, 31, "Input",
 InitializationCell->True],
Cell[143985, 3881, 851, 18, 31, "Input",
 InitializationCell->True],
Cell[144839, 3901, 485, 14, 49, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[145361, 3920, 127, 2, 44, "Subsection",
 InitializationCell->True],
Cell[145491, 3924, 805, 20, 33, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[146333, 3949, 132, 2, 44, "Subsection",
 InitializationCell->True],
Cell[146468, 3953, 380, 9, 33, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[146885, 3967, 124, 2, 44, "Subsection",
 InitializationCell->True],
Cell[147012, 3971, 481, 12, 51, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[147530, 3988, 121, 2, 44, "Subsection",
 InitializationCell->True],
Cell[147654, 3992, 242, 5, 31, "Input",
 InitializationCell->True],
Cell[147899, 3999, 180, 4, 31, "Input",
 InitializationCell->True],
Cell[148082, 4005, 179, 4, 31, "Input",
 InitializationCell->True],
Cell[148264, 4011, 190, 4, 31, "Input",
 InitializationCell->True],
Cell[148457, 4017, 178, 4, 31, "Input",
 InitializationCell->True],
Cell[148638, 4023, 994, 22, 51, "Input",
 InitializationCell->True],
Cell[149635, 4047, 1314, 26, 49, "Input",
 InitializationCell->True],
Cell[150952, 4075, 650, 16, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[151627, 4095, 123, 2, 35, "Subsubsection",
 InitializationCell->True],
Cell[151753, 4099, 329, 9, 31, "Input",
 InitializationCell->True],
Cell[152085, 4110, 300, 8, 31, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[152422, 4123, 168, 4, 35, "Subsubsection",
 InitializationCell->True],
Cell[152593, 4129, 781, 19, 32, "Input",
 InitializationCell->True],
Cell[153377, 4150, 859, 19, 32, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[154285, 4175, 126, 2, 44, "Subsection",
 InitializationCell->True],
Cell[154414, 4179, 659, 19, 31, "Input",
 InitializationCell->True],
Cell[155076, 4200, 616, 16, 53, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[155729, 4221, 191, 3, 44, "Subsection",
 InitializationCell->True],
Cell[155923, 4226, 832, 20, 85, "Input",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[156804, 4252, 154, 2, 50, "Section"],
Cell[156961, 4256, 350, 8, 71, "Input"],
Cell[157314, 4266, 1228, 30, 155, "Input"],
Cell[158545, 4298, 1063, 23, 74, "Input"],
Cell[159611, 4323, 94, 1, 30, "Input"],
Cell[159708, 4326, 1417, 33, 116, "Input"],
Cell[161128, 4361, 1484, 36, 155, "Input"],
Cell[162615, 4399, 302, 6, 49, "Input"],
Cell[162920, 4407, 1779, 46, 214, "Input"],
Cell[164702, 4455, 92, 1, 30, "Input"],
Cell[164797, 4458, 473, 12, 33, "Input"],
Cell[165273, 4472, 347, 8, 31, "Input"],
Cell[165623, 4482, 225, 5, 33, "Input"],
Cell[165851, 4489, 815, 21, 51, "Input"],
Cell[166669, 4512, 119, 2, 31, "Input"],
Cell[166791, 4516, 419, 11, 33, "Input"],
Cell[167213, 4529, 116, 2, 31, "Input"],
Cell[167332, 4533, 327, 9, 33, "Input"],
Cell[167662, 4544, 1968, 47, 225, "Input"]
}, Closed]]
}
]
*)

(* End of internal cache information *)
