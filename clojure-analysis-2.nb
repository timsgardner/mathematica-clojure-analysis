(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    218291,       6066]
NotebookOptionsPosition[    190765,       5173]
NotebookOutlinePosition[    191319,       5193]
CellTagsIndexPosition[    191276,       5190]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Clojure Analysis", "Title",
 CellChangeTimes->{{3.6328609781046762`*^9, 3.632860979776128*^9}, 
   3.633202902062005*^9}],

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.61039017736975*^9, 3.610390177870949*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<AssociativeUtils`\>\"", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610123880820364*^9, 3.6101238866531343`*^9}}],

Cell["Basically a big map-reduce. Like everything.", "Text",
 CellChangeTimes->{{3.609797485921159*^9, 3.6097974999096317`*^9}, {
  3.609813155635564*^9, 3.6098131579152527`*^9}, {3.610079925420598*^9, 
  3.61007993204767*^9}, {3.6101239253032837`*^9, 3.61012392733926*^9}}],

Cell[CellGroupData[{

Cell["Utils", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.610380546882833*^9, 3.6103805472338943`*^9}, {
  3.633202192405037*^9, 3.6332021941811113`*^9}}],

Cell[CellGroupData[{

Cell["General Predicates", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.597034006338381*^9, 3.597034043144265*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"notFalseQ", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"!", 
   RowBox[{"(", 
    RowBox[{"x", "  ", "===", " ", "False"}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.596812217777191*^9, 3.596812243885096*^9}, {
  3.596812285218401*^9, 3.596812338290038*^9}, {3.599210785039962*^9, 
  3.599210795757633*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"everyQ", "[", 
   RowBox[{"pred_", ",", " ", "xs_"}], "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "sentinel", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Catch", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Fold", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"pred", "[", "#2", "]"}], ",", " ", "True", ",", " ", 
           RowBox[{"Throw", "[", 
            RowBox[{"False", ",", " ", "sentinel"}], "]"}]}], "]"}], "&"}], 
        ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
        "xs"}], "]"}], ",", "\[IndentingNewLine]", "sentinel"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"thingQ", "[", "]"}], ":=", " ", "False"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598385035980755*^9, 3.5983850379279013`*^9}, {
  3.59838515429491*^9, 3.5983851684288387`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"thingQ", "[", "__", "]"}], ":=", " ", "True"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598385170015087*^9, 3.598385179306218*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["let", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.598144549488331*^9, 3.598144552679078*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "let", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598144556156847*^9, 3.5981445587366447`*^9}}],

Cell[BoxData[
 RowBox[{"SetAttributes", "[", 
  RowBox[{"let", ",", " ", "HoldAll"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.59814456764146*^9, 3.5981445840324793`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"let", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"HoldPattern", "[", 
       RowBox[{"Set", "[", 
        RowBox[{"lhs_", " ", ",", " ", "rhs_"}], "]"}], "]"}], ",", " ", 
      "rst___"}], "}"}], ",", " ", "body___"}], "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lhs", " ", "=", " ", "rhs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"let", "[", 
     RowBox[{
      RowBox[{"{", "rst", "}"}], ",", " ", "body"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598144588165823*^9, 3.598144588720389*^9}, {
   3.598144632230338*^9, 3.598144822971513*^9}, 3.598144954215612*^9, {
   3.610390258256772*^9, 3.610390271647736*^9}, {3.6103903506519003`*^9, 
   3.610390393691846*^9}, {3.610390656296183*^9, 3.610390724617317*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"let", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", " ", "body___"}], "]"}], " ", ":=", " ", 
  "body"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.598144825527643*^9, 3.598144838775177*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"let", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "=", "b"}], ",", 
     RowBox[{"c", "=", "a"}]}], "}"}], ",", " ", "c"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610390285858336*^9, 3.610390293410934*^9}}],

Cell[BoxData["b"], "Output",
 CellChangeTimes->{3.623681856546417*^9, 3.624456163363256*^9, 
  3.628049561087894*^9, 3.632126986259411*^9, 3.6328615496205473`*^9, 
  3.633199967330193*^9, 3.633201343753622*^9, 3.633202204104677*^9, 
  3.633202907068562*^9, 3.633204740011606*^9, 3.63320477437398*^9, 
  3.633204832483595*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["cons car cdr, motherfuckers", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.601820276801179*^9, 3.601820279936575*^9}, {
  3.601821679757131*^9, 3.601821679899549*^9}, {3.603580761464801*^9, 
  3.603580763439166*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"cons", ",", "car", ",", "cdr"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60358083664914*^9, 3.60358084056183*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cons", "[", 
   RowBox[{"x_", ",", " ", "ys_"}], "]"}], ":=", " ", 
  RowBox[{"Prepend", "[", 
   RowBox[{"ys", ",", " ", "x"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.601820283310053*^9, 3.601820296545106*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cons", "[", 
   RowBox[{"x_", ",", " ", "Null"}], "]"}], ":=", " ", 
  RowBox[{"{", "x", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603580943873818*^9, 3.6035809506518097`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"car", "[", 
   RowBox[{"_", "[", 
    RowBox[{"x_", ",", " ", "___"}], "]"}], "]"}], ":=", " ", "x"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.603580768994233*^9, 3.6035807888061028`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"car", "[", 
   RowBox[{
    RowBox[{"_", "[", "]"}], "|", "Null"}], "]"}], ":=", " ", 
  "Null"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603580792195797*^9, 3.603580833730596*^9}, {
  3.60358097401762*^9, 3.603580977856132*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cdr", "[", 
   RowBox[{"h_", "[", 
    RowBox[{"_", ",", " ", "xs___"}], "]"}], "]"}], ":=", " ", 
  RowBox[{"h", "[", "xs", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60358084760105*^9, 3.603580920499197*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cdr", "[", 
   RowBox[{"h_", "[", "]"}], "]"}], ":=", " ", "Null"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6035809070870857`*^9, 3.603580928533145*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["repeatedly", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.603593114724972*^9, 3.6035931170831127`*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "repeatedly", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603593390290503*^9, 3.60359339519314*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"repeatedly", "[", 
   RowBox[{"f_", ",", " ", "args___", ",", " ", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Reap", "[", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"Sow", "[", 
       RowBox[{"f", "[", "args", "]"}], "]"}], ",", 
      RowBox[{"{", "n", "}"}]}], "]"}], "]"}], "\[LeftDoubleBracket]", 
   RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603495404951297*^9, 3.603495469265127*^9}, {
  3.603593128932502*^9, 3.603593159289372*^9}, {3.603593218026534*^9, 
  3.6035933021551456`*^9}, {3.60359334045612*^9, 3.603593349502874*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"repeatedly", "[", 
   RowBox[{"f_", ",", " ", "args___", ",", " ", "0"}], "]"}], ":=", " ", 
  RowBox[{"{", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603593353087674*^9, 3.6035933614890957`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Other Shit", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6103888288639107`*^9, 3.6103888296379347`*^9}, {
  3.610394373657957*^9, 3.6103943752964363`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qwikCases", "[", 
   RowBox[{"expr_", ",", " ", "frm_"}], "]"}], ":=", 
  RowBox[{"Cases", "[", 
   RowBox[{"expr", ",", " ", "frm", ",", " ", "\[Infinity]", ",", " ", 
    RowBox[{"Heads", "\[Rule]", " ", "True"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610078125264853*^9, 3.610078163563168*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qwikPartition", "[", 
   RowBox[{"x_", ",", "n_", ",", "off_"}], "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{"x", ",", "n", ",", "off", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610387596067012*^9, 3.610387609416251*^9}, {
  3.610391801024932*^9, 3.6103918085904016`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qwikPartition", "[", 
   RowBox[{"x_", ",", " ", "n_"}], "]"}], ":=", " ", 
  RowBox[{"qwikPartition", "[", 
   RowBox[{"x", ",", "n", ",", "n"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.61038752155919*^9, 3.610387550698324*^9}, {
  3.610387581863616*^9, 3.610387586880423*^9}, {3.6103876215757504`*^9, 
  3.610387627990704*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"columnate", "[", 
   RowBox[{"x_", ",", " ", "rows_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"Partition", "[", 
    RowBox[{"x", ",", "rows", ",", "rows", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", "Null", "}"}]}], "]"}], "//", "Transpose"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610388342265007*^9, 3.610388400090472*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.60287912501143*^9, 3.6028791294169083`*^9}}],

Cell["\<\
Dependency-free (associative utils may help construct test batteries, though).\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6029019081698933`*^9, 3.6029019221833897`*^9}, {
  3.602902121458291*^9, 3.602902121729105*^9}, {3.6037398631089163`*^9, 
  3.6037398868866987`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "testWalk", ",", "runTests", ",", " ", "is", ",", " ", "notFound", ",", 
    "passed", ",", "failed"}], "]"}], ";", 
  RowBox[{
   RowBox[{"Attributes", "[", "is", "]"}], "=", " ", 
   RowBox[{"{", "HoldAll", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60289721224224*^9, 3.602897235034136*^9}, {
   3.602901109624857*^9, 3.602901112614876*^9}, {3.602902492834633*^9, 
   3.6029024963810883`*^9}, {3.602902724011547*^9, 3.6029027289262123`*^9}, {
   3.6029067835510406`*^9, 3.602906798016685*^9}, 3.610395158262672*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testWalk", "[", 
   RowBox[{"tests_", ",", "behind_", ",", " ", "ahead_"}], " ", "]"}], ":=", 
  " ", "\[IndentingNewLine]", 
  RowBox[{"testWalk", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "[", "ahead", "]"}], "/.", 
     RowBox[{"Append", "[", 
      RowBox[{"tests", ",", " ", 
       RowBox[{"_", " ", "\[RuleDelayed]", " ", 
        RowBox[{"Throw", "[", 
         RowBox[{"notFound", "[", 
          RowBox[{
           RowBox[{"\"\<behind\>\"", "\[Rule]", "behind"}], ",", " ", 
           RowBox[{"\"\<ahead\>\"", "\[Rule]", " ", "ahead"}]}], " ", "]"}], 
         "]"}]}]}], "]"}]}], ",", " ", 
    RowBox[{"Append", "[", 
     RowBox[{"behind", ",", " ", 
      RowBox[{"First", "[", "ahead", "]"}]}], "]"}], ",", " ", 
    RowBox[{"Rest", "[", "ahead", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.602897489731139*^9, 3.602897638201522*^9}, {
   3.6028976866089153`*^9, 3.602897699774631*^9}, 3.602897831244113*^9, {
   3.6028983761544943`*^9, 3.602898382074605*^9}, {3.602898424774269*^9, 
   3.602898444494355*^9}, {3.602898745659721*^9, 3.602898859893244*^9}, {
   3.602898895604669*^9, 3.602898919290853*^9}, {3.6028990821227837`*^9, 
   3.602899119593362*^9}, {3.60289915474638*^9, 3.602899232028389*^9}, {
   3.602899334625546*^9, 3.602899335169456*^9}, {3.60290193407292*^9, 
   3.602901939267617*^9}, {3.6029020900389233`*^9, 3.602902110551862*^9}, {
   3.6029023490362453`*^9, 3.6029023616421328`*^9}, {3.602902480513864*^9, 
   3.6029024862113533`*^9}, {3.602902645079198*^9, 3.602902658496421*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testWalk", "[", 
   RowBox[{"tests_", ",", " ", "behind_", ",", " ", 
    RowBox[{"{", "}"}]}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"testWalk", "[", 
     RowBox[{"#", ",", "behind", ",", 
      RowBox[{"{", "}"}]}], "]"}], "&"}], "/@", "tests"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.602897833142717*^9, 3.602897868811491*^9}, {
  3.602898583820779*^9, 3.6028986232873793`*^9}, {3.6028986611938133`*^9, 
  3.6028986911617002`*^9}, {3.602901183668252*^9, 3.602901186307152*^9}, {
  3.602905943236911*^9, 3.602905958675108*^9}, {3.602906047681364*^9, 
  3.602906048785495*^9}, {3.6029061166709948`*^9, 3.602906149332719*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testWalk", "[", 
   RowBox[{
    RowBox[{"r_", " ", "\[Rule]", " ", "m_"}], ",", " ", "behind_", ",", " ", 
    
    RowBox[{"{", "}"}]}], "]"}], ":=", 
  RowBox[{"testWalk", "[", 
   RowBox[{"m", ",", " ", 
    RowBox[{"Append", "[", 
     RowBox[{"behind", ",", " ", "r"}], "]"}], ",", " ", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.602898445575198*^9, 3.602898564319623*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testWalk", "[", 
   RowBox[{"isForm_is", ",", " ", "behind_", ",", " ", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"SameQ", "@@", "isForm"}], ")"}], ",", "\[IndentingNewLine]", 
    RowBox[{"passed", "[", 
     RowBox[{
      RowBox[{"\"\<path\>\"", "\[Rule]", "behind"}], ",", 
      RowBox[{"Replace", "[", 
       RowBox[{"isForm", ",", " ", 
        RowBox[{
         RowBox[{"is", "[", "xs___", "]"}], "\[RuleDelayed]", " ", 
         RowBox[{"Hold", "[", 
          RowBox[{"SameQ", "[", "xs", "]"}], "]"}]}]}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"failed", "[", 
     RowBox[{
      RowBox[{"\"\<path\>\"", "\[Rule]", "behind"}], ",", " ", 
      RowBox[{"\"\<expected\>\"", "\[Rule]", 
       RowBox[{"Replace", "[", 
        RowBox[{"isForm", ",", " ", 
         RowBox[{
          RowBox[{"is", "[", "xs___", "]"}], "\[RuleDelayed]", " ", 
          RowBox[{"Hold", "[", 
           RowBox[{"SameQ", "[", "xs", "]"}], "]"}]}]}], "]"}]}], ",", " ", 
      RowBox[{"\"\<got\>\"", "\[Rule]", " ", 
       RowBox[{"Replace", "[", 
        RowBox[{"isForm", ",", " ", 
         RowBox[{
          RowBox[{"is", "[", "xs___", "]"}], "\[RuleDelayed]", " ", 
          RowBox[{"SameQ", "@@@", 
           RowBox[{"Hold", "@@", 
            RowBox[{"{", 
             RowBox[{"{", "xs", "}"}], "}"}]}]}]}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.602897732169285*^9, 3.602897741133698*^9}, {
  3.602897780248303*^9, 3.602897827899831*^9}, {3.602899289643446*^9, 
  3.602899292019123*^9}, {3.602900973694463*^9, 3.602900973896867*^9}, {
  3.602903042411746*^9, 3.602903129280582*^9}, {3.6029035435947323`*^9, 
  3.6029036167077703`*^9}, {3.602903798062684*^9, 3.602903806284136*^9}, {
  3.6029039787472258`*^9, 3.602903981188623*^9}, {3.602904014619079*^9, 
  3.602904056622548*^9}, {3.602904167806541*^9, 3.602904290333337*^9}, {
  3.602904329962532*^9, 3.602904330066905*^9}, {3.602904412274497*^9, 
  3.602904449106001*^9}, {3.602904548254447*^9, 3.602904557613105*^9}, {
  3.602904634678146*^9, 3.602904674869893*^9}, {3.602967213710788*^9, 
  3.602967249599634*^9}, {3.602988969614584*^9, 3.602988969831164*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"runTests", "[", 
   RowBox[{"tests_", ",", 
    RowBox[{"path", ":", 
     RowBox[{"{", "___String", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"testWalk", "[", 
    RowBox[{"tests", ",", 
     RowBox[{"{", "}"}], ",", "path"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.602883993289528*^9, 3.60288402123695*^9}, {
   3.602884054016261*^9, 3.602884106887703*^9}, {3.602884201999894*^9, 
   3.6028842164892797`*^9}, {3.6028842887707863`*^9, 3.602884386426284*^9}, {
   3.6028844527040243`*^9, 3.60288445372865*^9}, {3.602884489792293*^9, 
   3.602884632752591*^9}, {3.602884670403162*^9, 3.6028847272943573`*^9}, {
   3.6028847616471148`*^9, 3.602884781248773*^9}, {3.602884907163056*^9, 
   3.602884933247778*^9}, {3.6028971832918158`*^9, 3.602897185491177*^9}, {
   3.602901068824445*^9, 3.60290108396953*^9}, 3.602901314245582*^9, {
   3.6029013545204163`*^9, 3.602901404292858*^9}, {3.602901636940619*^9, 
   3.602901653280682*^9}, {3.60290171959732*^9, 3.6029017733143873`*^9}, {
   3.602902323493698*^9, 3.602902330323978*^9}, {3.602905965653892*^9, 
   3.6029059667546453`*^9}, 3.6029060312542267`*^9, 3.602906121982332*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"runTests", "[", "tests_", "]"}], ":=", " ", 
  RowBox[{"runTests", "[", 
   RowBox[{"tests", ",", " ", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6029017213023987`*^9, 3.602901741888188*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Mapper", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.60838720903561*^9, 3.608387213867951*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapper", "[", "f_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{"f", ",", "#"}], "]"}], "&"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6084024652451963`*^9, 3.608402482791486*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["asMap", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.608401914279929*^9, 3.6084019164063807`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"asMap", "[", "x_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"lookup", "[", 
    RowBox[{"x", ",", "##"}], "]"}], "&"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60840071125609*^9, 3.608400739659273*^9}, 
   3.608403401871502*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"asMap", "[", 
   RowBox[{"x_", ",", " ", "default_"}], "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"{", "##", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "k_", "}"}], "\[RuleDelayed]", 
        RowBox[{"lookup", "[", 
         RowBox[{"x", ",", "k", ",", " ", "default"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", " ", 
        RowBox[{"lookup", "[", 
         RowBox[{"x", ",", " ", "##"}], "]"}]}]}], "}"}]}], "]"}], 
   "&"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6084033592373734`*^9, 3.608403373013782*^9}, {
  3.608403414115053*^9, 3.6084035487285547`*^9}, {3.6084039986454773`*^9, 
  3.608404015886221*^9}, {3.608404060500169*^9, 3.6084041202079973`*^9}, {
  3.6084041783472424`*^9, 3.608404188919306*^9}, {3.6084043442843723`*^9, 
  3.6084043478342457`*^9}, {3.6084044058839703`*^9, 3.608404413194457*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"runTests", "[", "\[IndentingNewLine]", 
  RowBox[{"let", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m1", " ", "=", " ", 
      RowBox[{"someStructure", "[", 
       RowBox[{"\"\<a\>\"", "\[Rule]", " ", "\"\<A\>\""}], "]"}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"is", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"asMap", "[", "m1", "]"}], "[", "\"\<a\>\"", "]"}], ",", 
        "\"\<A\>\""}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"is", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"asMap", "[", 
          RowBox[{"m1", ",", "\"\<C\>\""}], "]"}], "[", "\"\<c\>\"", "]"}], 
        ",", " ", "\"\<C\>\""}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"is", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"asMap", "[", "m1", "]"}], "[", 
         RowBox[{"\"\<b\>\"", ",", " ", "\"\<C\>\""}], "]"}], ",", 
        "\"\<C\>\""}], "]"}]}], "}"}]}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.608403556962121*^9, 3.608403719622596*^9}, {
  3.608403750262039*^9, 3.608403887389125*^9}, {3.608403945577671*^9, 
  3.608403946782501*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"passed", "[", 
    RowBox[{
     RowBox[{"\<\"path\"\>", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Hold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"asMap", "[", 
         RowBox[{"someStructure", "[", 
          RowBox[{"\<\"a\"\>", "\[Rule]", "\<\"A\"\>"}], "]"}], "]"}], 
        "[", "\<\"a\"\>", "]"}], "===", "\<\"A\"\>"}], "]"}]}], "]"}], ",", 
   RowBox[{"passed", "[", 
    RowBox[{
     RowBox[{"\<\"path\"\>", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Hold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"asMap", "[", 
         RowBox[{
          RowBox[{"someStructure", "[", 
           RowBox[{"\<\"a\"\>", "\[Rule]", "\<\"A\"\>"}], "]"}], 
          ",", "\<\"C\"\>"}], "]"}], "[", "\<\"c\"\>", "]"}], 
       "===", "\<\"C\"\>"}], "]"}]}], "]"}], ",", 
   RowBox[{"passed", "[", 
    RowBox[{
     RowBox[{"\<\"path\"\>", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Hold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"asMap", "[", 
         RowBox[{"someStructure", "[", 
          RowBox[{"\<\"a\"\>", "\[Rule]", "\<\"A\"\>"}], "]"}], "]"}], "[", 
        RowBox[{"\<\"b\"\>", ",", "\<\"C\"\>"}], "]"}], "===", "\<\"C\"\>"}], 
      "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.62368185696745*^9, 3.624456163798478*^9, 
  3.628049561384623*^9, 3.632126986732712*^9, 3.632861550236661*^9, 
  3.633199968004698*^9, 3.633201344367621*^9, 3.633202204670479*^9, 
  3.633202907749592*^9, 3.6332047406782923`*^9, 3.633204775077573*^9, 
  3.633204832998193*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["qwikReap", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610441920675005*^9, 3.610441921810149*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "qwikReap", "]"}], "=", " ", "HoldAll"}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6105594860445547`*^9, 3.610559497818672*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qwikReap", "[", "expr_", "]"}], ":=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Reap", "[", "expr", "]"}], "\[LeftDoubleBracket]", "2", 
     "\[RightDoubleBracket]"}], ",", " ", 
    RowBox[{
     RowBox[{"{", "x_", "}"}], "\[RuleDelayed]", " ", "x"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6104419230773478`*^9, 3.610441925219699*^9}, {
  3.610441971564928*^9, 3.610441978923195*^9}, {3.610442010792502*^9, 
  3.610442123216238*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["graphUnion2", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.61044451885425*^9, 3.610444527126739*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "graphUnion2", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610444553760187*^9, 3.610444557548291*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphUnion2", "[", "]"}], ":=", 
  RowBox[{"Graph", "[", 
   RowBox[{"{", "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610444473180801*^9, 3.610444534303081*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphUnion2", "[", "g_Graph", "]"}], ":=", "g"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610444645556431*^9, 3.610444650517311*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphUnion2", "[", "gs__Graph", "]"}], ":=", 
  RowBox[{"GraphUnion", "[", "gs", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610444492434156*^9, 3.610444500835123*^9}, {
  3.610444536142065*^9, 3.610444582448309*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["qwikMapIndexed", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6109994454201097`*^9, 3.6109994487789173`*^9}}],

Cell["\<\
Like mapIndexed, but just maps over first level and passes in unwrapped index.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.610999464226767*^9, 3.6109994867992887`*^9}, {
  3.611002181622118*^9, 3.6110021848939953`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qwikMapIndexed", "[", 
   RowBox[{"f_", ",", "expr_"}], "]"}], ":=", 
  RowBox[{"MapIndexed", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"#1", ",", 
       RowBox[{"#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
       "]"}], "&"}], ",", " ", "expr"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6109990340319443`*^9, 3.610999098257277*^9}, {
  3.610999177700493*^9, 3.61099917802055*^9}, {3.610999317013129*^9, 
  3.6109993175555*^9}, {3.610999381669405*^9, 3.610999422341877*^9}, {
  3.6110021865512867`*^9, 3.6110021877099323`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["stringishQ", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.620128242012344*^9, 3.6201282438477077`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stringishQ", "[", "_", "]"}], ":=", " ", "False"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.619456334288252*^9, 3.619456342689041*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stringishQ", "[", 
   RowBox[{"String_", "|", "StringExpression_"}], "]"}], ":=", " ", 
  "True"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.619456313356526*^9, 3.619456345673558*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["compBy", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6212967974794407`*^9, 3.621296800342162*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"compBy", "[", 
   RowBox[{"f_", ",", "comp_", ",", " ", "xs_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Replace", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Fold", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bldg", ",", "x"}], "}"}], "\[Function]", 
       "\[IndentingNewLine]", 
       RowBox[{"let", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xn", "=", 
           RowBox[{"f", "[", "x", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"Replace", "[", 
          RowBox[{"bldg", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"prevval_", ",", " ", "prevn_"}], "}"}], 
              "\[RuleDelayed]", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"comp", "[", 
                 RowBox[{"xn", ",", "prevn"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "xn"}], "}"}], ",", "bldg"}], "]"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"_", " ", "\[RuleDelayed]", " ", 
              RowBox[{"{", 
               RowBox[{"x", ",", "xn"}], "}"}]}]}], "}"}]}], "]"}]}], "]"}]}],
       ",", "\[IndentingNewLine]", "Null", ",", "\[IndentingNewLine]", "xs"}],
      "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"val_", ",", "_"}], "}"}], "\[RuleDelayed]", " ", "val"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.621296567799543*^9, 3.621296630612829*^9}, {
  3.621296668581932*^9, 3.6212966754683657`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"maxBy", "[", 
   RowBox[{"f_", ",", "xs_List"}], "]"}], ":=", " ", 
  RowBox[{"compBy", "[", 
   RowBox[{"f", ",", "Greater", ",", "xs"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.621295810304902*^9, 3.6212964656666527`*^9}, {
  3.621296598422421*^9, 3.621296638356496*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"minBy", "[", 
   RowBox[{"f_", ",", "xs_List"}], "]"}], ":=", 
  RowBox[{"compBy", "[", 
   RowBox[{"f", ",", "Less", ",", "xs"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.621296768379779*^9, 3.6212967802713213`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["(more) Graph Utils", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.6035803971691837`*^9, 3.603580406103015*^9}, {
  3.604367219152766*^9, 3.6043672287683363`*^9}}],

Cell[CellGroupData[{

Cell["edgeyQ", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.622157932003516*^9, 3.622157934850361*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"edgeyQ", "[", 
   RowBox[{"_DirectedEdge", "|", "_UndirectedEdge", "|", "_Rule"}], "]"}], ":=",
   "True"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"edgeyQ", "[", "_", "]"}], ":=", "False"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["set graph things", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.604367214482707*^9, 3.604367218027431*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "setGraphOpts", ",", "setGraphVerts", ",", "setGraphEdges", ",", 
   "addGraphOpts", ",", "mapToGraphVerts"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60358456841325*^9, 3.603584571649242*^9}, {
  3.6035846865591593`*^9, 3.603584700238635*^9}, {3.6059648461071367`*^9, 
  3.605964850501925*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"setGraphOpts", "[", 
   RowBox[{"g_Graph", ",", " ", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "Graph", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Graph", "[", 
   RowBox[{
    RowBox[{"VertexList", "@", "g"}], ",", 
    RowBox[{"EdgeList", "@", "g"}], ",", " ", "opts"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603398996543165*^9, 3.6033990900779247`*^9}, 
   3.603580382423972*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"setGraphVerts", "[", 
   RowBox[{"g_Graph", ",", "verts_"}], "]"}], ":=", " ", 
  RowBox[{"Graph", "[", 
   RowBox[{"verts", ",", 
    RowBox[{"EdgeList", "[", "g", "]"}], ",", 
    RowBox[{"Options", "[", "g", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603567430333745*^9, 3.603567487270183*^9}, {
   3.605967255391979*^9, 3.605967259719266*^9}, 3.605967354726632*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"setGraphEdges", "[", 
   RowBox[{"g_Graph", ",", "edges_"}], "]"}], ":=", "\[IndentingNewLine]", 
  " ", 
  RowBox[{"Graph", "[", 
   RowBox[{
    RowBox[{"VertexList", "[", "g", "]"}], ",", " ", "edges", ",", " ", 
    RowBox[{"Options", "[", "g", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603567488542081*^9, 3.603567516292262*^9}, {
   3.603582361737074*^9, 3.603582396286066*^9}, {3.603582430288156*^9, 
   3.603582472662458*^9}, {3.6035833066404133`*^9, 3.60358330921525*^9}, {
   3.605967266334853*^9, 3.605967267807926*^9}, 3.605967352207353*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"addGraphOpts", "[", 
   RowBox[{"g_Graph", ",", " ", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "Graph", "]"}]}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"opts2", " ", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "opts", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Options", "[", "g", "]"}], "}"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graph", "[", 
     RowBox[{
      RowBox[{"VertexList", "@", "g"}], ",", 
      RowBox[{"EdgeList", "@", "g"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"Sequence", "@@", " ", "opts2"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603583996857383*^9, 3.603584043176469*^9}, {
  3.6035841028289223`*^9, 3.6035841355870523`*^9}, {3.603584221524501*^9, 
  3.603584274574106*^9}, {3.603584349436507*^9, 3.6035843834300337`*^9}, {
  3.603584528198731*^9, 3.60358455992328*^9}, {3.603584817730402*^9, 
  3.60358481809898*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Options", "@", 
  RowBox[{"Graph", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", "\[Rule]", "b"}], "}"}], ",", " ", 
    RowBox[{"EdgeLabels", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "\[Rule]", "b"}], ")"}], "\[Rule]", "\"\<bla\>\""}], 
      "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605967318763139*^9, 3.605967333440425*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"EdgeLabels", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[DirectedEdge]", "b"}], "\[Rule]", "\<\"bla\"\>"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6236818575016327`*^9, 3.624456164268544*^9, 
  3.628049561627557*^9, 3.632126987199478*^9, 3.632861550772356*^9, 
  3.633199968613296*^9, 3.63320134490357*^9, 3.633202205138667*^9, 
  3.633202908318874*^9, 3.633204741253365*^9, 3.633204775648328*^9, 
  3.633204833547722*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graph", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", "\[Rule]", "b"}], "}"}], ",", " ", 
   RowBox[{"EdgeLabels", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "\[Rule]", "b"}], ")"}], "\[Rule]", "\"\<bla\>\""}], 
     "}"}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6104450026785927`*^9, 3.610445014229933*^9}}],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{$CellContext`a, $CellContext`b}, {{{1, 2}}, Null}, {
      EdgeLabels -> {
        DirectedEdge[$CellContext`a, $CellContext`b] -> "bla"}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[0.041582132564841494`], 
        ArrowBox[{{1., 0.}, {0., 1.2246467991473532`*^-16}}, 0.01273], 
        InsetBox["\<\"bla\"\>", {0.5, 6.123233995736766*^-17}, ImageScaled[{0.5, 0.5}],
         BaseStyle->"Graphics"]}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
        DiskBox[{1., 0.}, 0.01273], 
        DiskBox[{0., 1.2246467991473532`*^-16}, 0.01273]}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FrameTicks->None,
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->15]], "Output",
 CellChangeTimes->{3.623681857549007*^9, 3.624456164350429*^9, 
  3.628049561671578*^9, 3.632126987297872*^9, 3.63286155098527*^9, 
  3.633199968743314*^9, 3.633201344995631*^9, 3.633202205228166*^9, 
  3.633202908404063*^9, 3.633204741347423*^9, 3.633204776348895*^9, 
  3.63320483363694*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Options", "[", 
  RowBox[{"Graph", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", "\[Rule]", "b"}], "}"}], ",", " ", 
    RowBox[{"EdgeLabels", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "\[Rule]", "b"}], ")"}], "\[Rule]", "\"\<bla\>\""}], 
      "}"}]}]}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605967227322589*^9, 3.60596723692071*^9}, {
  3.605967280716756*^9, 3.605967291711206*^9}, {3.610444953182314*^9, 
  3.610444953701166*^9}, {3.610445020430623*^9, 3.6104450217410717`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"EdgeLabels", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[DirectedEdge]", "b"}], "\[Rule]", "\<\"bla\"\>"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.623681857598888*^9, 3.624456164428968*^9, 
  3.628049561721363*^9, 3.632126987361068*^9, 3.632861551055698*^9, 
  3.6331999688154697`*^9, 3.633201345063066*^9, 3.633202205257949*^9, 
  3.6332029084320993`*^9, 3.6332047414260607`*^9, 3.633204776473233*^9, 
  3.63320483369762*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["get graph things", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6104448890144043`*^9, 3.610444891748629*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getEdgeLabels", "[", "g_Graph", "]"}], ":=", 
  RowBox[{"EdgeLabels", "/.", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"Options", "[", "g", "]"}], ",", 
     RowBox[{"_", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610444894993534*^9, 3.61044494449937*^9}, {
  3.610445371469236*^9, 3.610445378752927*^9}, {3.610445410221282*^9, 
  3.6104454239573727`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getVertexStyle", "[", "g_Graph", "]"}], ":=", " ", 
  RowBox[{"VertexStyle", "/.", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"Options", "[", "g", "]"}], ",", 
     RowBox[{"_", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610999892444475*^9, 3.610999948675439*^9}}],

Cell["\<\
Not sure if this is quite right, that is, maybe there\[CloseCurlyQuote]s a \
difference between having the empty list set as a vertex\[CloseCurlyQuote]s \
style and excluding it from the style thing altogether:\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.611000257828438*^9, 3.611000289506525*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getVertexStyle", "[", 
    RowBox[{"g_Graph", ",", " ", "v_"}], "]"}], "/;", 
   RowBox[{"VertexQ", "[", 
    RowBox[{"g", ",", "v"}], "]"}]}], ":=", " ", 
  RowBox[{"v", "/.", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"getVertexStyle", "[", "g", "]"}], ",", " ", 
     RowBox[{"_", "\[Rule]", 
      RowBox[{"{", "}"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6109999500399942`*^9, 3.611000081625045*^9}, {
  3.611000150383338*^9, 3.611000194030842*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["mapToGraphVerts, mapToGraphEdges", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.606517370731986*^9, 3.606517389170972*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"mapToGraphVerts", ",", "mapToGraphEdges"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605967436821666*^9, 3.6059674400295763`*^9}, {
  3.606517413067953*^9, 3.6065174159885387`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapToGraphVerts", "[", 
   RowBox[{"f_", ",", "g_Graph"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"let", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vs1", "=", 
       RowBox[{"VertexList", "@", "g"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"vs2", "=", 
       RowBox[{"f", "/@", "vs1"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"rs", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"vs1", "\[Rule]", " ", "vs2"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"es", "=", 
       RowBox[{"EdgeList", "@", "g"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"es2", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{"#", ",", "rs", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "&"}], ")"}], "/@", "es"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"ers", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"es", "\[Rule]", "es2"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graph", "[", 
     RowBox[{
     "vs2", ",", "\[IndentingNewLine]", "es2", ",", "\[IndentingNewLine]", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Options", "[", "g", "]"}], "/.", "ers"}], ")"}]}]}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605865943823989*^9, 3.6058660114518547`*^9}, {
   3.605866060271549*^9, 3.605866070097568*^9}, {3.605866168914658*^9, 
   3.605866292580434*^9}, {3.605866349416436*^9, 3.6058665389121723`*^9}, 
   3.605866953278452*^9, {3.605867137166171*^9, 3.605867146048127*^9}, {
   3.60586733528618*^9, 3.6058673604994164`*^9}, {3.6058674246377907`*^9, 
   3.605867518533333*^9}, {3.605867691810853*^9, 3.605867693465281*^9}, {
   3.605867937438654*^9, 3.605867968596799*^9}, {3.605868053822468*^9, 
   3.60586805497262*^9}, {3.605964981249983*^9, 3.6059650008149767`*^9}, {
   3.60596715402521*^9, 3.6059671860074*^9}, 3.6059673599602633`*^9, {
   3.605967446025722*^9, 3.605967447689454*^9}, {3.60596761003519*^9, 
   3.605967744402104*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"let", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"g", "=", 
     RowBox[{"Graph", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "\[Rule]", "b"}], ",", 
         RowBox[{"b", "\[Rule]", "c"}], ",", 
         RowBox[{"c", "\[Rule]", "a"}]}], "}"}], ",", " ", 
       RowBox[{"EdgeLabels", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "\[Rule]", "b"}], ")"}], "\[Rule]", " ", 
          "\"\<bla\>\""}], "}"}]}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"mapToGraphVerts", "[", 
    RowBox[{"foo", ",", "g"}], "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6059648980062523`*^9, 3.605964940572133*^9}, {
  3.605967374541745*^9, 3.60596741903363*^9}}],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
       $CellContext`foo[$CellContext`a], 
       $CellContext`foo[$CellContext`b], 
       $CellContext`foo[$CellContext`c]}, {{{1, 2}, {2, 3}, {3, 1}}, Null}, {
      EdgeLabels -> {DirectedEdge[
           $CellContext`foo[$CellContext`a], 
           $CellContext`foo[$CellContext`b]] -> "bla"}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        0.03555748430834104], {
         ArrowBox[{{-0.8660254037844384, -0.4999999999999994}, {
          0.8660254037844389, -0.5000000000000012}}, 0.020399597244776385`], 
         InsetBox["\<\"bla\"\>", {2.7755575615628914`*^-16, -0.5000000000000003},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, 
        ArrowBox[{{0.8660254037844389, -0.5000000000000012}, {
         1.8369701987210297`*^-16, 1.}}, 0.020399597244776385`], 
        ArrowBox[{{1.8369701987210297`*^-16, 
         1.}, {-0.8660254037844384, -0.4999999999999994}}, 
         0.020399597244776385`]}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
        DiskBox[{-0.8660254037844384, -0.4999999999999994}, 
         0.020399597244776385`], 
        DiskBox[{0.8660254037844389, -0.5000000000000012}, 
         0.020399597244776385`], 
        DiskBox[{1.8369701987210297`*^-16, 1.}, 0.020399597244776385`]}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FrameTicks->None,
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->15]], "Output",
 CellChangeTimes->{3.6236818577282047`*^9, 3.624456164600706*^9, 
  3.6280495619944963`*^9, 3.6321269875301733`*^9, 3.632861551269207*^9, 
  3.63319996902654*^9, 3.6332013452680693`*^9, 3.633202205484741*^9, 
  3.6332029086155853`*^9, 3.633204741650916*^9, 3.633204776578768*^9, 
  3.6332048338801403`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapToGraphEdges", "[", 
   RowBox[{"f_", ",", "g_Graph"}], "]"}], ":=", " ", 
  RowBox[{"setGraphEdges", "[", 
   RowBox[{"g", ",", " ", 
    RowBox[{"f", "/@", 
     RowBox[{"EdgeList", "[", "g", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605865943823989*^9, 3.6058660114518547`*^9}, {
   3.605866060271549*^9, 3.605866070097568*^9}, {3.605866168914658*^9, 
   3.605866292580434*^9}, {3.605866349416436*^9, 3.6058665389121723`*^9}, 
   3.605866953278452*^9, {3.605867137166171*^9, 3.605867146048127*^9}, {
   3.60586733528618*^9, 3.6058673604994164`*^9}, {3.6058674246377907`*^9, 
   3.605867518533333*^9}, {3.605867691810853*^9, 3.605867693465281*^9}, {
   3.605867937438654*^9, 3.605867968596799*^9}, {3.605868053822468*^9, 
   3.60586805497262*^9}, {3.605964981249983*^9, 3.6059650008149767`*^9}, {
   3.60596715402521*^9, 3.6059671860074*^9}, 3.6059673599602633`*^9, {
   3.605967446025722*^9, 3.605967447689454*^9}, {3.60596761003519*^9, 
   3.605967744402104*^9}, {3.6065174270774307`*^9, 3.606517465626741*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["decoration conveniences", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6052648599633093`*^9, 3.605264873153594*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"addToolTips", "[", "g_Graph", "]"}], ":=", 
  RowBox[{"setGraphVerts", "[", 
   RowBox[{"g", ",", 
    RowBox[{"Tooltip", "/@", 
     RowBox[{"VertexList", "[", "g", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604440173005361*^9, 3.6044402009985523`*^9}, 
   3.610194789043695*^9, 3.610444815185606*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"addNameLabels", "[", "g_Graph", "]"}], ":=", " ", 
  RowBox[{"addGraphOpts", "[", 
   RowBox[{"g", ",", " ", 
    RowBox[{"VertexLabels", "\[Rule]", " ", "\"\<Name\>\""}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605264874236197*^9, 3.6052649201111183`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"addEdgeToolTips", "[", "g_Graph", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"let", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"els", "=", 
      RowBox[{"getEdgeLabels", "[", "g", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Switch", "[", 
     RowBox[{"els", ",", "\[IndentingNewLine]", "Automatic", ",", 
      RowBox[{"setGraphEdges", "[", 
       RowBox[{"g", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Tooltip", "[", 
           RowBox[{"#", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"EdgeList", "[", "g", "]"}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
      RowBox[{"let", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tts", "=", "\[IndentingNewLine]", 
          RowBox[{"Append", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Replace", "[", 
             RowBox[{"els", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"e_", " ", "\[Rule]", " ", "l_"}], ")"}], 
               "\[RuleDelayed]", " ", 
               RowBox[{"(", 
                RowBox[{"e", "\[Rule]", " ", 
                 RowBox[{"Tooltip", "[", 
                  RowBox[{"e", ",", "l"}], "]"}]}], ")"}]}], ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"e_", "\[RuleDelayed]", " ", 
             RowBox[{"Tooltip", "[", 
              RowBox[{"e", ",", "e"}], "]"}]}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"setGraphEdges", "[", 
         RowBox[{"g", ",", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"EdgeList", "@", "g"}], ",", " ", "tts", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdy00ogwEAh/ERTrOY2tYIa8qQsCxbrX3bgSmtnaglzetAsY9yo5y0RnFY
EpmvtQNrtVJzmF2UTbPNKGlWVjbNDuRjLOH9v4en3+nhjc/oJ8ppNFojGVwP
2vocqbxSdLwqhuMtj1K4nbXJoZXo10Bua0kLI0mfizJhcMN5q9kLGTJxCEpH
Xi4gO2xJwGf6zw0UNg3dwaovWR7ypJoiXJIwKpZJiRMhB2ZkHTJYYK9RshvU
U677vFIxMkp5GsjNQmKOaYbTTIExQuoymcZgcwPBuCS1HGQoQyIDC+rno2yY
qg7UQ++mlw+jg842aMr5OiG9pBHCu0mRHK7Ydtwx0vfeWg+M18TyV6SRdLgA
n/wPRRh8S9UlSbs3uBx426XiQnGlgwcDPwo+THukArjwvdsOVTq7BA5vvg5A
3Z9/ayxL/rQ05S/9Yw9+Ghf3YfycdQh7Es4AVNfQz+CRwk7JJOTX0FGmpfwH
BEQUOw==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ornament", "[", "g_Graph", "]"}], ":=", " ", 
  RowBox[{"addEdgeToolTips", "@", 
   RowBox[{"addToolTips", "@", 
    RowBox[{"addNameLabels", "@", "g"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606591253435029*^9, 3.6065912692401257`*^9}, {
  3.606591299464514*^9, 3.606591307688456*^9}, {3.606591338594221*^9, 
  3.6065913405960207`*^9}, {3.606591403311872*^9, 3.6065914092313843`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["selfLoops, removeSelfLoops", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.623683549146394*^9, 3.6236835593684883`*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"selfLoops", ",", "removeSelfLoops"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.623683570406745*^9, 3.623683575442233*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"selfLoops", "[", "g_Graph", "]"}], ":=", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"EdgeList", "[", "g", "]"}], ",", 
    RowBox[{"_", "[", 
     RowBox[{"x_", ",", "x_"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.623683029027833*^9, 3.623683088354823*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"removeSelfLoops", "[", "g_Graph", "]"}], ":=", " ", 
  RowBox[{"EdgeDelete", "[", 
   RowBox[{"g", ",", 
    RowBox[{"selfLoops", "[", "g", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6236829573205347`*^9, 3.623683038020825*^9}, {
  3.623683176208301*^9, 3.623683179822475*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["singleEdgify", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6035804130145063`*^9, 3.603580423542552*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"singleEdgify", ",", "edgeListTransform"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603582204762931*^9, 3.6035822100317163`*^9}, {
  3.604426829705948*^9, 3.6044268308894567`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"edgeListTransform", "[", 
   RowBox[{"el_List", ",", 
    RowBox[{"v", ":", 
     RowBox[{"(", " ", 
      RowBox[{"Automatic", "|", "True", "|", "False"}], ")"}]}]}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Switch", "[", 
   RowBox[{
   "v", ",", "\[IndentingNewLine]", "Automatic", ",", " ", "el", ",", 
    "\[IndentingNewLine]", "True", ",", 
    RowBox[{"Replace", "[", 
     RowBox[{"el", ",", 
      RowBox[{"UndirectedEdge", "\[Rule]", "DirectedEdge"}], ",", 
      RowBox[{"{", "2", "}"}], ",", 
      RowBox[{"Heads", "\[Rule]", " ", "True"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "False", ",", " ", 
    RowBox[{"Replace", "[", 
     RowBox[{"el", ",", " ", 
      RowBox[{"DirectedEdge", "\[Rule]", " ", "UndirectedEdge"}], ",", 
      RowBox[{"{", "2", "}"}], ",", " ", 
      RowBox[{"Heads", "\[Rule]", " ", "True"}]}], "]"}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.603588459689472*^9, 3.603588525744934*^9}, {
  3.603597210178514*^9, 3.603597214727792*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"edgeListTransform", "[", 
   RowBox[{"Null", ",", " ", "_"}], "]"}], ":=", " ", "Null"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6035908321910677`*^9, 3.603590840138329*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Options", "[", "singleEdgify", "]"}], "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"DirectedEdges", "\[Rule]", " ", "Automatic"}], ",", 
    RowBox[{"allowSelfLoops", "\[Rule]", " ", "False"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603581986214396*^9, 3.603582033967548*^9}, {
  3.603589929810676*^9, 3.603589972477746*^9}, {3.603590144765624*^9, 
  3.6035901452063828`*^9}, {3.6035902129428263`*^9, 3.6035902232816896`*^9}, {
  3.603590636396448*^9, 3.603590636892146*^9}, {3.623683231494416*^9, 
  3.623683235476985*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"DirectedEdges", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"allowSelfLoops", "\[Rule]", "False"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6236818578801394`*^9, 3.62445616479678*^9, 
  3.628049562207511*^9, 3.632126987789823*^9, 3.6328615517376432`*^9, 
  3.633199969514451*^9, 3.633201345517337*^9, 3.6332022057608833`*^9, 
  3.633202909001966*^9, 3.6332047421200542`*^9, 3.633204776757279*^9, 
  3.633204834200427*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"singleEdgify", "[", 
   RowBox[{"el_List", ",", 
    RowBox[{"OptionsPattern", "[", "singleEdgify", "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"searcher", " ", "=", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "allowSelfLoops", "]"}], ",", 
        "\[IndentingNewLine]", "Identity", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "|", 
          RowBox[{"Reverse", "@", "#"}]}], "&"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"edgeListTransform", "[", 
       RowBox[{"#", ",", " ", 
        RowBox[{"OptionValue", "[", "DirectedEdges", "]"}]}], "]"}], "&"}], 
     "@", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "el", "]"}], "<", "2"}], ",", 
       "\[IndentingNewLine]", "el", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Reap", "[", "\[IndentingNewLine]", 
         RowBox[{"NestWhile", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"ahd", ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"e", "=", " ", 
                 RowBox[{"First", "[", "ahd", "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Sow", "[", "e", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"Rest", "@", "ahd"}], ",", 
                  RowBox[{"searcher", "@", "e"}]}], "]"}]}]}], "]"}]}], "]"}],
            ",", "\[IndentingNewLine]", "el", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"#", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], "&"}]}], "]"}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6034068049044333`*^9, 3.603406825150406*^9}, {
   3.603406953273291*^9, 3.6034069856194963`*^9}, {3.603407017888294*^9, 
   3.6034071682336893`*^9}, {3.6034599414856253`*^9, 
   3.6034599447666683`*^9}, {3.6034803045825577`*^9, 3.603480304782439*^9}, {
   3.603480453880095*^9, 3.60348045859828*^9}, {3.6035736193943157`*^9, 
   3.603573697554948*^9}, {3.603580326502701*^9, 3.6035803552816877`*^9}, {
   3.6035805035326567`*^9, 3.60358054338976*^9}, {3.603581978470222*^9, 
   3.603582010959361*^9}, {3.603582060655716*^9, 3.603582199015664*^9}, 
   3.603582242729188*^9, {3.603582673002977*^9, 3.60358267389986*^9}, {
   3.6035829340633583`*^9, 3.603582975531966*^9}, {3.603583055089085*^9, 
   3.603583056561221*^9}, {3.6035832314110622`*^9, 3.603583242865078*^9}, {
   3.6035885399876842`*^9, 3.603588581169072*^9}, {3.603590032147407*^9, 
   3.6035901223609943`*^9}, {3.603590239622054*^9, 3.6035902882245083`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"singleEdgify", "[", 
   RowBox[{"g_Graph", ",", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "singleEdgify", "]"}]}]}], "]"}], ":=", 
  " ", 
  RowBox[{"setGraphEdges", "[", 
   RowBox[{"g", ",", 
    RowBox[{"singleEdgify", "[", 
     RowBox[{
      RowBox[{"EdgeList", "[", "g", "]"}], ",", "opts"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6035804273701982`*^9, 3.603580452172338*^9}, {
   3.603582717801991*^9, 3.603582761940308*^9}, 3.6035828277638206`*^9, {
   3.603590464499312*^9, 3.603590556173889*^9}, {3.603590646987626*^9, 
   3.603590650142606*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["extractVertexCoordinates", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.605150033394562*^9, 3.605150051999166*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "extractVertexCoordinates", ",", " ", "extractVertexCoordinateRules", ",", 
   "extractGraphPlotCoordinates", ",", "overlaySubgraph"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605150889138006*^9, 3.6051508932734947`*^9}, {
  3.605152514429867*^9, 3.605152518941277*^9}, {3.605961914523106*^9, 
  3.605961914797936*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractGraphPlotCoordinates", "[", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"Annotation", "[", 
      RowBox[{"_", ",", 
       RowBox[{"VertexCoordinateRules", "\[Rule]", " ", "vcr_"}]}], "]"}], 
     ",", "___"}], "]"}], "]"}], ":=", "vcr"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605945874035026*^9, 3.6059458971700077`*^9}, {
  3.605945942323119*^9, 3.605945996426798*^9}, {3.605946111193595*^9, 
  3.605946159628414*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractVertexCoordinates", "[", "g_Graph", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"VertexCoordinates", "/.", 
   RowBox[{"AbsoluteOptions", "[", 
    RowBox[{"g", ",", " ", "VertexCoordinates"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605150037609029*^9, 3.605150077498467*^9}, {
  3.605150649812519*^9, 3.605150680185289*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractVertexCoordinates", "[", "g_Graphics", "]"}], ":=", 
  RowBox[{"extractGraphPlotCoordinates", "@", "g"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605150037609029*^9, 3.605150077498467*^9}, {
  3.605150649812519*^9, 3.605150680185289*^9}, {3.605961988560046*^9, 
  3.605961999783969*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractVertexCoordinates", "[", 
   RowBox[{"g_Graph", ",", " ", "verts_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"verts", "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"VertexList", "@", "g"}], "\[Rule]", " ", 
     RowBox[{"extractVertexCoordinates", "@", "g"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605150083031311*^9, 3.6051501419451227`*^9}, {
  3.605150235157872*^9, 3.6051503946888847`*^9}, {3.6051504833273697`*^9, 
  3.6051506084876966`*^9}, {3.605150767627833*^9, 3.60515077814573*^9}, {
  3.605150935838694*^9, 3.6051509427084084`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractVertexCoordinateRules", "[", "g_Graph", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"VertexList", "[", "g", "]"}], "\[Rule]", 
    RowBox[{"extractVertexCoordinates", "[", "g", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603587468326333*^9, 3.603587495450966*^9}, {
  3.6051522623372793`*^9, 3.605152288069463*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"overlaySubgraph", "[", 
   RowBox[{"g_Graph", ",", "sg_Graph"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Show", "[", 
   RowBox[{"g", ",", "\[IndentingNewLine]", 
    RowBox[{"addGraphOpts", "[", 
     RowBox[{"sg", ",", "\[IndentingNewLine]", 
      RowBox[{"VertexCoordinates", "\[Rule]", " ", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"VertexList", "[", "sg", "]"}], "/.", 
         RowBox[{"extractVertexCoordinateRules", "[", "g", "]"}]}], ")"}]}]}],
      "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60358366298326*^9, 3.603583808977558*^9}, {
  3.6035839359914007`*^9, 3.603583936526157*^9}, {3.603584947333624*^9, 
  3.603584948072948*^9}, {3.6035864820862207`*^9, 3.603586567383026*^9}, {
  3.6035866163978977`*^9, 3.603586770744676*^9}, {3.603586800856783*^9, 
  3.603586847772805*^9}, {3.6035868952409163`*^9, 3.6035869005818033`*^9}, {
  3.603586943626968*^9, 3.603586950983913*^9}, {3.603587055404976*^9, 
  3.603587119812211*^9}, {3.603587212152812*^9, 3.603587229469784*^9}, {
  3.6035872689546967`*^9, 3.603587326762968*^9}, {3.6035875289496737`*^9, 
  3.6035875402503033`*^9}, {3.6051521986846657`*^9, 3.605152199798333*^9}, {
  3.605152295502674*^9, 3.605152299374258*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["toGraph", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.60359110928476*^9, 3.603591111083811*^9}, {
  3.603591246176423*^9, 3.603591246320265*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "toGraph", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6066875688896227`*^9, 3.606687571559601*^9}}],

Cell["Not sure what the point of this is, whatever", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.606687554680064*^9, 3.606687558918105*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"toGraph", "[", "xs___", "]"}], ":=", 
  RowBox[{"Graph", "[", "xs", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6035912635719233`*^9, 3.603591270303437*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"toGraph", "[", "g_Graph", "]"}], ":=", " ", "g"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6035921463350897`*^9, 3.603592152809598*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"toGraph", "[", "Null", "]"}], ":=", 
  RowBox[{"Graph", "[", 
   RowBox[{"{", "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6035912486541557`*^9, 3.603591256152364*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["nullGraphQ", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.606688232264576*^9, 3.606688233489655*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nullGraphQ", "[", "_", "]"}], ":=", " ", "False"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606688498942009*^9, 3.6066885039395723`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nullGraphQ", "[", "g_Graph", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"VertexList", "[", "g", "]"}], "\[Equal]", 
   RowBox[{"{", "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606688234481072*^9, 3.60668823616019*^9}, {
  3.6066883014082212`*^9, 3.606688319134684*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["fix ReverseGraph", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.606688120268673*^9, 3.606688128763822*^9}}],

Cell["Note: unprotecting graph. Deal with it.", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.606688369291543*^9, 3.606688375290506*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unprotect", "[", "Graph", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606688129742612*^9, 3.606688174351755*^9}, 
   3.606688520215103*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graph", "/:", " ", 
  RowBox[{"ReverseGraph", "[", 
   RowBox[{"g_Graph", "?", "nullGraphQ"}], "]"}], ":=", "g"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606688186020666*^9, 3.606688190422337*^9}, {
  3.606688331186288*^9, 3.606688350322435*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"TagSetDelayed", "::", "write"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Tag \[NoBreak]\\!\\(Graph\\)\[NoBreak] in \
\[NoBreak]\\!\\(ReverseGraph[\\(\\(g_Graph ? nullGraphQ\\)\\)]\\)\[NoBreak] \
is Protected. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/write\\\", ButtonNote -> \
\\\"TagSetDelayed::write\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.623681858252224*^9, 3.624456165268667*^9, 
  3.62804956252264*^9, 3.632126988248644*^9, 3.632861552132022*^9, 
  3.633199970015677*^9, 3.633201346065703*^9, 3.633202206339302*^9, 
  3.633202909464293*^9, 3.6332047425931*^9, 3.63320477708182*^9, 
  3.6332048348045053`*^9}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.62368185825294*^9, 3.624456165269767*^9, 
  3.628049562528945*^9, 3.632126988260861*^9, 3.632861552148014*^9, 
  3.633199970027811*^9, 3.633201346079699*^9, 3.633202206353097*^9, 
  3.63320290947653*^9, 3.633204742606954*^9, 3.633204777094199*^9, 
  3.6332048348184147`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["edgeAdd2", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.622150569704082*^9, 3.6221506176445007`*^9}, {
  3.62215331377792*^9, 3.622153346218123*^9}}],

Cell["\<\
I HATE this shit. VertexAdd behaves correctly, so it\[CloseCurlyQuote]s just \
stupid inconsistent bullshit.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.622150303879808*^9, 3.622150305814767*^9}, {
  3.622150653029271*^9, 3.622150667676196*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "edgeAdd2", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.622150025106814*^9, 3.62215002777735*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"edgeAdd2", "[", 
    RowBox[{"g_Graph", ",", 
     RowBox[{"e", ":", 
      RowBox[{"Except", "[", "_List", "]"}]}]}], "]"}], "/;", 
   RowBox[{"\[Not]", 
    RowBox[{"EdgeQ", "[", 
     RowBox[{"g", ",", "e"}], "]"}]}]}], ":=", 
  RowBox[{"EdgeAdd", "[", 
   RowBox[{"g", ",", "e"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.622149753232683*^9, 3.622149867978944*^9}, {
  3.6221500136834507`*^9, 3.622150022379271*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"edgeAdd2", "[", 
   RowBox[{"g_Graph", ",", "es_List"}], "]"}], ":=", " ", 
  RowBox[{"Fold", "[", 
   RowBox[{"edgeAdd2", ",", "g", ",", "es"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6221499036723824`*^9, 3.622149920681531*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"edgeAdd2", "[", 
   RowBox[{"g_Graph", ",", "___"}], "]"}], ":=", " ", "g"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.622149873867544*^9, 3.6221499009610453`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["directedNeighborhoodGraph, upstreamDirectedNeighborhoodGraph", \
"Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6221506825034933`*^9, 3.622150691316536*^9}, {
  3.62215386329521*^9, 3.6221538688380623`*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "directedNeighborhoodGraph", ",", "upstreamDirectedNeighborhoodGraph", ",", 
   "edgeyQ"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.622150345770714*^9, 3.622150349001165*^9}, {
  3.622153873471105*^9, 3.622153885722167*^9}, {3.622157915989283*^9, 
  3.622157917598234*^9}}],

Cell[TextData[{
 "Replace this with something using nestwhile and a good test using the \
previous value so we can stop running when the ",
 StyleBox["graph",
  FontSlant->"Italic"],
 " hits a fixpoint, not just the lump of state we\[CloseCurlyQuote]re whaling \
on. That way we can specify \[Infinity] n\[CloseCurlyQuote]s, for example."
}], "Text",
 CellChangeTimes->{{3.6221583689668837`*^9, 3.622158467328086*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"directedNeighborhoodGraph", "[", 
   RowBox[{
    RowBox[{"g_", "?", "DirectedGraphQ"}], ",", "vs_List", ",", "n_"}], "]"}],
   ":=", "\[IndentingNewLine]", 
  RowBox[{"First", "[", "\[IndentingNewLine]", 
   RowBox[{"FixedPoint", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bldg", "\[Function]", "\[IndentingNewLine]", 
      RowBox[{"Replace", "[", 
       RowBox[{"bldg", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"g", ",", "___"}], "}"}], "\[RuleDelayed]", " ", "bldg"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"prevg_", ",", 
             RowBox[{"prevvs_", "/;", 
              RowBox[{"prevvs", "\[NotEqual]", 
               RowBox[{"{", "}"}]}]}], ",", 
             RowBox[{"level_", "/;", 
              RowBox[{"level", "<", "n"}]}]}], "}"}], "\[RuleDelayed]", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Join", "@@", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{"IncidenceList", "[", 
                    RowBox[{"g", ",", "#"}], "]"}], ",", 
                   RowBox[{"_", "[", 
                    RowBox[{"#", ",", "_"}], "]"}]}], "]"}], "&"}], "/@", 
                "prevvs"}], ")"}]}], "/.", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", "}"}], "|", 
                 RowBox[{"{", 
                  RowBox[{"{", "}"}], "}"}]}], "\[RuleDelayed]", " ", 
                RowBox[{"{", 
                 RowBox[{"prevg", ",", 
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{"level", "+", "1"}]}], "}"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"newEs_", "\[RuleDelayed]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"edgeAdd2", "[", 
                   RowBox[{"prevg", ",", "newEs"}], "]"}], ",", 
                  RowBox[{"newEs", "\[LeftDoubleBracket]", 
                   RowBox[{";;", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"level", "+", "1"}]}], "}"}]}]}], "}"}]}], 
            ")"}]}]}], "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Graph", "[", 
        RowBox[{"{", "}"}], "]"}], ",", "vs", ",", "0"}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.622147295120843*^9, 3.622147338737925*^9}, {
   3.6221473892929897`*^9, 3.6221474193388653`*^9}, {3.622147471294249*^9, 
   3.6221475687085123`*^9}, {3.622147661050931*^9, 3.622147758484333*^9}, {
   3.622147843654209*^9, 3.62214813614744*^9}, {3.622148191924411*^9, 
   3.6221482922956057`*^9}, {3.6221483501406107`*^9, 
   3.6221484000398693`*^9}, {3.622148542426383*^9, 3.622148550537785*^9}, {
   3.6221487365216618`*^9, 3.622148797917904*^9}, {3.6221488306282663`*^9, 
   3.6221488726978083`*^9}, {3.622148914836713*^9, 3.622148922915083*^9}, {
   3.6221489773342752`*^9, 3.6221489791106*^9}, {3.622149026927929*^9, 
   3.622149235163265*^9}, {3.622149277889868*^9, 3.62214939178362*^9}, {
   3.6221494857588778`*^9, 3.622149495461822*^9}, {3.622149543072567*^9, 
   3.622149570433279*^9}, {3.6221496231774597`*^9, 3.622149689128097*^9}, {
   3.622149733212167*^9, 3.6221497356041603`*^9}, {3.622149928596695*^9, 
   3.622149929461341*^9}, {3.622150387798732*^9, 3.622150521802343*^9}, {
   3.622153400597562*^9, 3.622153429317277*^9}, {3.622153489396267*^9, 
   3.622153494848233*^9}, {3.622153531924719*^9, 3.6221535621332483`*^9}, {
   3.6221540696167994`*^9, 3.622154091341193*^9}, 3.6221581934903927`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"directedNeighborhoodGraph", "[", 
   RowBox[{
    RowBox[{"g_", "?", "DirectedGraphQ"}], ",", "v_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"directedNeighborhoodGraph", "[", 
   RowBox[{"g", ",", 
    RowBox[{"{", "v", "}"}], ",", "n"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6221485625916843`*^9, 3.62214859486034*^9}, {
   3.622150874898082*^9, 3.6221508840487537`*^9}, 3.622150938664381*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"directedNeighborhoodGraph", "[", 
   RowBox[{"g_Graph", ",", "v_"}], "]"}], ":=", 
  RowBox[{"directedNeighborhoodGraph", "[", 
   RowBox[{"g", ",", "v", ",", "1"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6221508869166822`*^9, 3.622150931663415*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"directedNeighborhoodGraph", "[", "args___", "]"}], ":=", 
  RowBox[{"NeighborhoodGraph", "[", "args", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.622148404084216*^9, 3.6221484463443813`*^9}, {
  3.6221484893881617`*^9, 3.622148489571207*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"upstreamDirectedNeighborhoodGraph", "[", 
   RowBox[{"g_Graph", ",", "args___"}], "]"}], ":=", 
  RowBox[{"ReverseGraph", "[", 
   RowBox[{"directedNeighborhoodGraph", "[", 
    RowBox[{
     RowBox[{"ReverseGraph", "[", "g", "]"}], ",", "args"}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.622153891359095*^9, 3.6221539460396223`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["getATree, getADag", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.606687369118392*^9, 3.6066873737653*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"getATree", ",", "getADag"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6066875741898947`*^9, 3.60668758230453*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "getATree", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"DirectedEdges", "\[Rule]", " ", "Automatic"}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603588355433235*^9, 3.6035883877240257`*^9}, {
  3.60668739271264*^9, 3.606687393487979*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getATree", "[", 
   RowBox[{"g_Graph", ",", " ", "v_", ",", " ", 
    RowBox[{"OptionsPattern", "[", "getATree", "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"edgeListTransform", "[", 
     RowBox[{"#", ",", 
      RowBox[{"OptionValue", "[", "DirectedEdges", "]"}]}], "]"}], "&"}], "@",
    "\[IndentingNewLine]", 
   RowBox[{"car", "@", 
    RowBox[{"car", "@", 
     RowBox[{"cdr", "@", 
      RowBox[{"Reap", "[", "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cur", "=", "v"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"BreadthFirstScan", "[", 
          RowBox[{"g", ",", "v", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<PrevisitVertex\>\"", "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Set", "[", 
                 RowBox[{"cur", ",", "#"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<FrontierEdge\>\"", "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sow", "[", 
                 RowBox[{"#", "/.", 
                  RowBox[{
                   RowBox[{"e_", "[", 
                    RowBox[{"as___", ",", " ", "cur", ",", " ", "bs___"}], 
                    "]"}], "\[RuleDelayed]", 
                   RowBox[{"e", "[", 
                    RowBox[{"cur", ",", "as", ",", "bs"}], "]"}]}]}], " ", 
                 "]"}], "&"}], ")"}]}]}], "}"}]}], "]"}]}], "]"}], 
       "]"}]}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603575253456121*^9, 3.6035752550023518`*^9}, {
   3.6035752911608047`*^9, 3.603575383466587*^9}, {3.603575462071376*^9, 
   3.603575482682747*^9}, {3.6035756361917267`*^9, 3.603575680019202*^9}, {
   3.6035757205799294`*^9, 3.603575721641361*^9}, {3.6035807158054953`*^9, 
   3.6035807427546*^9}, {3.603581109769557*^9, 3.6035811156995573`*^9}, {
   3.603581179557386*^9, 3.6035811800676727`*^9}, {3.603588393083996*^9, 
   3.603588400341494*^9}, {3.603588675303671*^9, 3.603588714261238*^9}, 
   3.603589026315831*^9, {3.603589131150671*^9, 3.603589256198762*^9}, {
   3.6035893523944397`*^9, 3.603589358670869*^9}, {3.603589421148554*^9, 
   3.603589465480204*^9}, 3.603590798492489*^9}],

Cell["\<\
Note that DirectedEdge can actually take more than two arguments:\
\>", "Text",
 CellChangeTimes->{{3.622146245697028*^9, 3.622146347658095*^9}}],

Cell[BoxData[
 RowBox[{"DirectedEdge", "[", 
  RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e"}], "]"}]], "Input",
 CellChangeTimes->{{3.622146293941039*^9, 3.622146300378956*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getADag", "[", 
   RowBox[{"g_Graph", ",", "v_", ",", " ", 
    RowBox[{"OptionsPattern", "[", "getADag", "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Reap", "[", "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cur", "=", "v"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"BreadthFirstScan", "[", 
          RowBox[{"g", ",", "v", ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"edgeHandler", "=", 
               RowBox[{
                RowBox[{"Sow", "[", 
                 RowBox[{"#", "/.", 
                  RowBox[{
                   RowBox[{"_", "[", 
                    RowBox[{"as___", ",", " ", "cur", ",", " ", "bs___"}], 
                    "]"}], "\[RuleDelayed]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{"cur", ",", "as", ",", "bs"}], "]"}]}]}], " ", 
                 "]"}], "&"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<PrevisitVertex\>\"", "\[Rule]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Set", "[", 
                   RowBox[{"cur", ",", "#"}], "]"}], "&"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
               "\"\<FrontierEdge\>\"", "\[Rule]", " ", "edgeHandler"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<CycleEdge\>\"", "\[Rule]", " ", "edgeHandler"}]}],
               "}"}]}], "]"}]}], "]"}]}], "]"}], "]"}], "//", 
      "\[IndentingNewLine]", "cdr"}], "//", "car"}], "//", "car"}], "//", 
   RowBox[{
    RowBox[{"Replace", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Null", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}]}], "]"}], "&"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603575725873103*^9, 3.603575770667947*^9}, {
  3.6035811413275747`*^9, 3.6035811774923277`*^9}, {3.603583387132986*^9, 
  3.60358338728397*^9}, {3.603583418803656*^9, 3.603583489825976*^9}, {
  3.603583566381391*^9, 3.603583609742869*^9}, {3.60358564097344*^9, 
  3.60358564260713*^9}, {3.603585739164091*^9, 3.603585767864805*^9}, {
  3.603589546740637*^9, 3.6035896902259502`*^9}, {3.60359180782931*^9, 
  3.603591810266323*^9}, {3.606689038689724*^9, 3.606689040558901*^9}, {
  3.606689124144413*^9, 3.6066891889886703`*^9}, {3.622146174469635*^9, 
  3.622146176722578*^9}, {3.6221462405253468`*^9, 3.622146242388226*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["upstreamGraph, downstreamGraph, highlightWithNeighborhood", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.606690609203681*^9, 3.60669061955511*^9}, {
  3.606692203867044*^9, 3.606692210562401*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"upstreamGraph", ",", "downstreamGraph"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6066867470904293`*^9, 3.606686750780661*^9}, {
  3.60669039793141*^9, 3.606690406480338*^9}, {3.606690538738009*^9, 
  3.606690539255879*^9}, {3.606690574249092*^9, 3.606690578721747*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"upstreamGraph", "[", 
    RowBox[{"g_Graph", ",", "v_"}], "]"}], "/;", 
   RowBox[{"VertexQ", "[", 
    RowBox[{"g", ",", "v"}], "]"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"getADag", "[", 
       RowBox[{
        RowBox[{"ReverseGraph", "[", "g", "]"}], ",", "v"}], "]"}], "//", 
      "toGraph"}], "//", "ReverseGraph"}], "//", 
    RowBox[{
     RowBox[{"HighlightGraph", "[", 
      RowBox[{"#", ",", "v"}], "]"}], "&"}]}], "//", "ornament"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.606686397205988*^9, 3.6066864068936996`*^9}, {
  3.606686502441506*^9, 3.606686599921857*^9}, {3.606686632369534*^9, 
  3.6066866337522097`*^9}, {3.606686722397341*^9, 3.606686817417943*^9}, {
  3.606689936202182*^9, 3.606689951034383*^9}, {3.606690071303434*^9, 
  3.606690097996366*^9}, {3.606690132371478*^9, 3.606690132674377*^9}, {
  3.606690255204164*^9, 3.606690261533525*^9}, {3.606690296619896*^9, 
  3.606690375589738*^9}, {3.606690408513794*^9, 3.606690432364546*^9}, {
  3.606690530561627*^9, 3.606690542799708*^9}, {3.6066913245542316`*^9, 
  3.606691329761462*^9}, {3.6066920301303883`*^9, 3.6066920317646227`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"upstreamGraph", "[", 
   RowBox[{"g_Graph", ",", "vs_List"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"HighlightGraph", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Apply", "[", 
     RowBox[{"graphUnion2", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v", "\[Function]", 
         RowBox[{
          RowBox[{
           RowBox[{"getADag", "[", 
            RowBox[{
             RowBox[{"ReverseGraph", "[", "g", "]"}], ",", "v"}], "]"}], "//",
            "toGraph"}], "//", "ReverseGraph"}]}], ")"}], "/@", "vs"}]}], 
     "]"}], ",", "\[IndentingNewLine]", "vs"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615090920678561*^9, 3.615090923854763*^9}, {
  3.6150909551809072`*^9, 3.6150910276899233`*^9}, {3.615091088947281*^9, 
  3.61509118979114*^9}, {3.6150912703018303`*^9, 3.615091271412299*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"downstreamGraph", "[", 
    RowBox[{"g_Graph", ",", " ", "v_"}], "]"}], "/;", 
   RowBox[{"VertexQ", "[", 
    RowBox[{"g", ",", "v"}], "]"}]}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"getADag", "[", 
      RowBox[{"g", ",", "v"}], "]"}], "//", "toGraph"}], "//", 
    RowBox[{
     RowBox[{"HighlightGraph", "[", 
      RowBox[{"#", ",", "v"}], "]"}], "&"}]}], "//", "ornament"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.606690533181328*^9, 3.6066905713628187`*^9}, {
  3.606691333145142*^9, 3.606691337825416*^9}, {3.606692033986782*^9, 
  3.606692035345765*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"downstreamGraph", "[", 
   RowBox[{"g_Graph", ",", "vs_List"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"HighlightGraph", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Apply", "[", 
     RowBox[{"graphUnion2", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v", "\[Function]", 
         RowBox[{
          RowBox[{"getADag", "[", 
           RowBox[{"g", ",", "v"}], "]"}], "//", "toGraph"}]}], ")"}], "/@", 
       "vs"}]}], "]"}], ",", "\[IndentingNewLine]", "vs"}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.615091513961021*^9, 3.615091567719735*^9}}],

Cell["Differentiated from NeighborhoodGraph:", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.606692139509945*^9, 3.6066921525428553`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"highlightWithNeighborhood", "[", 
   RowBox[{"g_Graph", ",", " ", "vs_", ",", " ", "n_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"NeighborhoodGraph", "[", 
     RowBox[{"g", ",", "vs", ",", "n"}], "]"}], "//", 
    RowBox[{
     RowBox[{"HighlightGraph", "[", 
      RowBox[{"#", ",", "vs"}], "]"}], "&"}]}], "//", "ornament"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.606686112584881*^9, 3.606686203216716*^9}, {
  3.6066921853654633`*^9, 3.606692187092901*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"highlightWithNeighborhood", "[", 
   RowBox[{"g_Graph", ",", " ", "vs_"}], "]"}], ":=", " ", 
  RowBox[{"highlightWithNeighborhood", "[", 
   RowBox[{"g", ",", "vs", ",", "1"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6066862194729013`*^9, 3.606686229121888*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["qwik highlighting etc tools", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.606690858713327*^9, 3.606690868712439*^9}, {
  3.60669095078331*^9, 3.60669095367836*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"hlNeighborhood", ",", "hlUpstream", ",", "hlDownstream"}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606690915405899*^9, 3.606690928199394*^9}, {
  3.6066925730933123`*^9, 3.6066925763095512`*^9}, {3.6066927512252827`*^9, 
  3.606692767170117*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hlNeighborhood", "[", 
   RowBox[{"g_Graph", ",", " ", "vs_List", ",", " ", "n_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"NeighborhoodGraph", "[", 
    RowBox[{"g", ",", "vs", ",", "n"}], "]"}], "//", 
   RowBox[{
    RowBox[{"HighlightGraph", "[", 
     RowBox[{"g", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"#", ",", "Red"}], "]"}], "&"}], ")"}], "/@", "vs"}]}], 
     "]"}], "&"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606686112584881*^9, 3.606686203216716*^9}, {
  3.606690931992947*^9, 3.606690993826975*^9}, {3.6066913655974827`*^9, 
  3.606691368867545*^9}, {3.606692008386879*^9, 3.606692012224326*^9}, {
  3.606692624251309*^9, 3.606692624858033*^9}, {3.6066927688958597`*^9, 
  3.6066927775235662`*^9}, {3.6066930474653*^9, 3.606693129433517*^9}, {
  3.606693162276053*^9, 3.606693169173174*^9}, {3.6110949778248463`*^9, 
  3.611094984594631*^9}, {3.611095056796708*^9, 3.611095057167664*^9}, {
  3.611095103085005*^9, 3.611095108251101*^9}, {3.611095302364614*^9, 
  3.611095302779366*^9}, {3.632127332192253*^9, 3.6321273369372587`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hlNeighborhood", "[", 
   RowBox[{"g_Graph", ",", " ", "vs_List"}], "]"}], ":=", " ", 
  RowBox[{"hlNeighborhood", "[", 
   RowBox[{"g", ",", "vs", ",", "1"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6066862194729013`*^9, 3.606686229121888*^9}, {
  3.606690936648909*^9, 3.606690941369319*^9}, {3.6110950621867323`*^9, 
  3.6110950625347023`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hlUpstream", "[", 
   RowBox[{"g_Graph", ",", "v_"}], "]"}], ":=", 
  RowBox[{"HighlightGraph", "[", 
   RowBox[{"g", ",", 
    RowBox[{"downstreamGraph", "[", 
     RowBox[{"g", ",", "v"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6066907406159782`*^9, 3.6066907917134132`*^9}, {
  3.606690831449808*^9, 3.606690831727909*^9}, {3.606690996948062*^9, 
  3.6066909979137774`*^9}, {3.606691385812874*^9, 3.606691389412806*^9}, {
  3.606691440051093*^9, 3.6066914440021*^9}, {3.606691685952629*^9, 
  3.606691731258691*^9}, {3.606691805437715*^9, 3.606691823381867*^9}, {
  3.60669186137053*^9, 3.606691887963578*^9}, {3.606691939336166*^9, 
  3.606691940455555*^9}, {3.606692015696609*^9, 3.606692017982629*^9}, {
  3.6066925234678297`*^9, 3.60669253691954*^9}, {3.60669258236823*^9, 
  3.6066926043056517`*^9}, {3.6066927800597258`*^9, 3.6066927815558453`*^9}, {
  3.606692831921269*^9, 3.60669283216971*^9}, {3.606692863395248*^9, 
  3.606692894533387*^9}, {3.6066929322419147`*^9, 3.606692987791038*^9}, {
  3.632127328960259*^9, 3.6321273305677347`*^9}, {3.632128021989276*^9, 
  3.632128030868243*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hlDownstream", "[", 
   RowBox[{"g_Graph", ",", "v_"}], "]"}], ":=", 
  RowBox[{"HighlightGraph", "[", 
   RowBox[{"g", ",", 
    RowBox[{"downstreamGraph", "[", 
     RowBox[{"g", ",", "v"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6321272988496532`*^9, 3.632127324035369*^9}, {
  3.632127356631547*^9, 3.632127375579172*^9}, {3.632127753786929*^9, 
  3.632127795522127*^9}, {3.632127827934352*^9, 3.63212783310207*^9}, {
  3.632127910386001*^9, 3.632127926169845*^9}, {3.632127997650692*^9, 
  3.632128029508061*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RGBColor", "[", 
  RowBox[{".2", ",", ".6", ",", ".5", ",", "1"}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  ButtonBox[
   TooltipBox[
    RowBox[{
     GraphicsBox[{
       {GrayLevel[0], RectangleBox[{0, 0}]}, 
       {GrayLevel[0], RectangleBox[{1, -1}]}, 
       {RGBColor[0.2, 0.6, 0.5], Opacity[1], RectangleBox[{0, -1}, {2, 1}]}},
      AspectRatio->1,
      Frame->True,
      FrameStyle->RGBColor[
       0.13333333333333336`, 0.4, 0.33333333333333337`, 1.],
      FrameTicks->None,
      ImageSize->
       Dynamic[{
        Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
         Magnification]}],
      PlotRangePadding->None], "\[InvisibleSpace]"}],
    "RGBColor[0.2, 0.6, 0.5, 1]"],
   Appearance->None,
   BaseStyle->{},
   BaselinePosition->Baseline,
   ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
     If[
      Not[
       AbsoluteCurrentValue["Deployed"]], 
      SelectionMove[Typeset`box$, All, Expression]; 
      FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
      FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0.2, 0.6, 0.5]; 
      FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
      MathLink`CallFrontEnd[
        FrontEnd`AttachCell[Typeset`box$, 
         FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
         Left, Top}, 
         "ClosingActions" -> {
          "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
   DefaultBaseStyle->{},
   Evaluator->Automatic,
   Method->"Preemptive"],
  RGBColor[0.2, 0.6, 0.5, 1],
  Editable->False,
  Selectable->False]], "Output",
 CellChangeTimes->{3.623681859251391*^9, 3.6244561656791573`*^9, 
  3.628049562999601*^9, 3.632126988926557*^9, 3.632861552804511*^9, 
  3.633199970693893*^9, 3.633201346756445*^9, 3.6332022070053463`*^9, 
  3.633202910203577*^9, 3.633204743389166*^9, 3.6332047775907373`*^9, 
  3.6332048354810667`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"hlUpDown", "[", 
   RowBox[{"g_Graph", ",", "v_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"let", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"up", "=", 
       RowBox[{"upstreamGraph", "[", 
        RowBox[{"g", ",", "v"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"down", "=", 
       RowBox[{"downstreamGraph", "[", 
        RowBox[{"g", ",", "v"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"intersect", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"GraphIntersection", "[", 
          RowBox[{"up", ",", "down"}], "]"}], "//", "EdgeList"}], "//", 
        "Graph"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"HighlightGraph", "[", 
      RowBox[{"g", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"v", ",", "Yellow"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"intersect", ",", 
           RowBox[{"RGBColor", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{".5", ",", ".2", ",", ".6"}], "}"}], "*", "1.5"}], 
             ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"down", ",", " ", 
           RowBox[{"Darker", "@", "Green"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"up", ",", 
           RowBox[{"Darker", "@", " ", "Red"}]}], "]"}]}], "}"}]}], "]"}], "//",
      "ornament"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606695511053245*^9, 3.606695586818173*^9}, {
   3.6066956914931297`*^9, 3.606695893194998*^9}, {3.6066959697234993`*^9, 
   3.606696007861003*^9}, {3.606696077232943*^9, 3.606696100514721*^9}, {
   3.606696486516241*^9, 3.6066964979341288`*^9}, {3.606696577376813*^9, 
   3.6066965818038893`*^9}, {3.606696627445784*^9, 3.6066966754966393`*^9}, 
   3.606696751028904*^9, {3.6066969493961267`*^9, 3.6066969495305233`*^9}, {
   3.606696990385104*^9, 3.606696991153418*^9}}],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.611095078306785*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Init", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.604247386379744*^9, 3.6042473866996202`*^9}}],

Cell["\<\
Looks like if we dropped clojure-1.5.1.jar rather than clojure-1.2.0.jar into \
lib we mux up JLink. Should probably get the latest version of JLink.jar, or \
something. Ideally we could get it from some repo and handle this via \
Leiningen.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6042522907574673`*^9, 3.604252372922873*^9}}],

Cell[CellGroupData[{

Cell["load", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610394468296975*^9, 3.610394470975211*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "$Path", ",", 
    "\"\</Users/timothygardner/code/ClojureLink/src/mathematica\>\""}], "]"}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.504139157507572*^9, 3.50413917164657*^9}, {
   3.5041392671130657`*^9, 3.504139315312611*^9}, 3.6024467761494827`*^9, {
   3.604247240962201*^9, 3.60424726349481*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<ClojureLink`\>\"", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.50413914098973*^9, 3.5041391451790648`*^9}, 
   3.5041393175179462`*^9, {3.610395196408408*^9, 3.610395201918747*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InstallClojureLink", "[", 
   RowBox[{
   "\"\</Users/timothygardner/code/ClojureLink\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "{", "\"\</Users/timothygardner/code/ClojureLink/src/clj\>\"", "}"}]}], 
   "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.504139433014282*^9, 3.504139440081815*^9}, {
   3.504139744383008*^9, 3.504139758328649*^9}, {3.5056215253299723`*^9, 
   3.505621532411501*^9}, {3.5056223422736397`*^9, 3.505622343063479*^9}, {
   3.505622390936513*^9, 3.505622411510468*^9}, {3.505622553537956*^9, 
   3.505622554706108*^9}, {3.505623349783263*^9, 3.505623350227833*^9}, {
   3.5056234031786547`*^9, 3.505623422798609*^9}, {3.5056237219126053`*^9, 
   3.50562373556535*^9}, {3.602446781887697*^9, 3.602446818802354*^9}, 
   3.60424724608107*^9, {3.604247931052925*^9, 3.604247948931633*^9}}],

Cell[BoxData[
 RowBox[{"SetClojureLinkAutoReplacements", "[", 
  RowBox[{"EvaluationNotebook", "[", "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6107265454877462`*^9, 3.610726556620234*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["qmark", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.60506299473174*^9, 3.6050630025027323`*^9}}],

Cell["\<\
Actually this is a bug. Totally doesn\[CloseCurlyQuote]t work, play around \
with question marks to see how\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.605063352444273*^9, 3.6050633666976013`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qmark", "=", "\"\<\:2047\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60506283082257*^9, 3.6050628419453707`*^9}}],

Cell[BoxData["\<\"\:2047\"\>"], "Output",
 CellChangeTimes->{3.6236818643850183`*^9, 3.624456170998459*^9, 
  3.628049584301893*^9, 3.632126994867323*^9, 3.632861558856687*^9, 
  3.6331999766378803`*^9, 3.6332013518432903`*^9, 3.633202212142582*^9, 
  3.6332029152903976`*^9, 3.633204748547724*^9, 3.6332047869622393`*^9, 
  3.633204840546262*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"addQmark", "[", "s_String", "]"}], ":=", " ", 
  RowBox[{"s", "<>", "qmark"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605062904093499*^9, 3.605062920127*^9}, {
  3.6050629579356947`*^9, 3.6050629593028507`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"addQmark", "[", "s_Symbol", "]"}], ":=", " ", 
  RowBox[{"Symbol", "@", 
   RowBox[{"addQmark", "@", 
    RowBox[{"ToString", "@", "s"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6050628540070744`*^9, 3.6050629676926107`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["does it float", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610393616367358*^9, 3.610393617526086*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", "\[IndentingNewLine]", 
  RowBox[{"with\:2011out\:2011str", "[", "\[IndentingNewLine]", 
   RowBox[{"print", "@", 
    RowBox[{"eval", "@", 
     RowBox[{"load\:2011string", "@", "\"\<*clojure-version*\>\""}]}]}], 
   "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604250479412196*^9, 3.604250529676876*^9}, {
   3.604250639830553*^9, 3.604250645989959*^9}, 3.610394416906205*^9, 
   3.610394450052643*^9}],

Cell[BoxData["\<\"{:qualifier nil, :minor 5, :incremental 1, :major 1}\"\>"], \
"Output",
 CellChangeTimes->{3.623681864579278*^9, 3.624456171187955*^9, 
  3.628049584493803*^9, 3.6321269951238203`*^9, 3.632861559122756*^9, 
  3.633199976911302*^9, 3.6332013521082497`*^9, 3.633202212410385*^9, 
  3.633202915560027*^9, 3.633204748776887*^9, 3.633204787155119*^9, 
  3.633204840783463*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Namespaces", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.604348436405394*^9, 3.60434844149152*^9}}],

Cell[CellGroupData[{

Cell["Problem", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.604364177308529*^9, 3.604364178138789*^9}}],

Cell["\<\
in-ns doesn\[CloseCurlyQuote]t work, getting it to work would require \
rewriting the clojure side of ClojureLink somewhat.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.604348372410725*^9, 3.604348410157895*^9}, {
  3.604348457362369*^9, 3.604348482279851*^9}, {3.604348690764203*^9, 
  3.6043487142891197`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"currentNamespace", "[", "]"}], ":=", 
  RowBox[{"ClojureEvaluate", "[", 
   RowBox[{"with\:2011out\:2011str", "[", 
    RowBox[{"print", "[", 
     RowBox[{"load\:2011string", "[", "\"\<*ns*\>\"", "]"}], "]"}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604348253074171*^9, 3.60434826354874*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"currentNamespace", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604348355996788*^9, 3.604348357235903*^9}}],

Cell[BoxData["\<\"#<Namespace user>\"\>"], "Output",
 CellChangeTimes->{3.623681864649252*^9, 3.62445617126602*^9, 
  3.628049584729321*^9, 3.632126995174324*^9, 3.6328615592215433`*^9, 
  3.633199977051003*^9, 3.633201352194365*^9, 3.633202212493387*^9, 
  3.633202915640191*^9, 3.633204748858573*^9, 3.633204787211637*^9, 
  3.633204840885363*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"coreSymbol", "=", " ", 
  RowBox[{"ClojureSymbol", "@", "\"\<ClojureLink.core\>\""}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604247975837233*^9, 3.604247985773625*^9}}],

Cell[BoxData[
 RowBox[{"ClojureSymbol", "[", "\<\"ClojureLink.core\"\>", "]"}]], "Output",
 CellChangeTimes->{3.62368186468521*^9, 3.6244561713163967`*^9, 
  3.6280495848251543`*^9, 3.632126995218213*^9, 3.632861559289654*^9, 
  3.633199977084838*^9, 3.63320135227649*^9, 3.633202212579324*^9, 
  3.633202915726529*^9, 3.633204748943585*^9, 3.633204787253018*^9, 
  3.633204840957921*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", 
  RowBox[{"in\:2011ns", "@", 
   RowBox[{"quote", "@", "coreSymbol"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\[LeftGuillemet]", 
   RowBox[{"JavaObject", "[", 
    RowBox[{"clojure", ".", "lang", ".", "Namespace"}], "]"}], 
   "\[RightGuillemet]"}],
  JLink`Objects`vm1`JavaObject23156382379278337]], "Output",
 CellChangeTimes->{3.6236818647338123`*^9, 3.624456171362432*^9, 
  3.628049584984476*^9, 3.632126995292028*^9, 3.63286155935684*^9, 
  3.633199977150875*^9, 3.633201352359984*^9, 3.633202212662064*^9, 
  3.633202915808671*^9, 3.633204749028117*^9, 3.633204787292591*^9, 
  3.633204841041523*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"currentNamespace", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6043486091326017`*^9, 3.6043486103741302`*^9}}],

Cell[BoxData["\<\"#<Namespace user>\"\>"], "Output",
 CellChangeTimes->{3.623681864769526*^9, 3.624456171416082*^9, 
  3.628049585260231*^9, 3.6321269953364277`*^9, 3.632861559426573*^9, 
  3.633199977218238*^9, 3.633201352444784*^9, 3.6332022127450666`*^9, 
  3.633202915891803*^9, 3.6332047491109753`*^9, 3.633204787333*^9, 
  3.6332048411242647`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", 
  RowBox[{"in\:2011ns", "@", 
   RowBox[{"quote", "@", 
    RowBox[{"ClojureSymbol", "[", "\"\<clojure.tools.analyzer\>\"", "]"}]}]}],
   "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604248284326832*^9, 3.604248305845849*^9}, {
  3.604345652485627*^9, 3.604345652687806*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\[LeftGuillemet]", 
   RowBox[{"JavaObject", "[", 
    RowBox[{"clojure", ".", "lang", ".", "Namespace"}], "]"}], 
   "\[RightGuillemet]"}],
  JLink`Objects`vm1`JavaObject349741451837441]], "Output",
 CellChangeTimes->{3.6236818648160143`*^9, 3.624456171467576*^9, 
  3.6280495854145823`*^9, 3.632126995370985*^9, 3.6328615595082083`*^9, 
  3.6331999772884197`*^9, 3.633201352527124*^9, 3.633202212828327*^9, 
  3.6332029159764767`*^9, 3.63320474919489*^9, 3.633204787374918*^9, 
  3.633204841207835*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"currentNamespace", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604348365798819*^9, 3.604348367067008*^9}}],

Cell[BoxData["\<\"#<Namespace user>\"\>"], "Output",
 CellChangeTimes->{3.623681864853498*^9, 3.624456171516562*^9, 
  3.628049585577939*^9, 3.6321269954118347`*^9, 3.632861559575897*^9, 
  3.633199977371255*^9, 3.6332013526111917`*^9, 3.633202212911951*^9, 
  3.633202916058454*^9, 3.6332047492777348`*^9, 3.633204787416291*^9, 
  3.633204841290234*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", 
  RowBox[{"require", "[", 
   RowBox[{"quote", "@", "coreSymbol"}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604247993672173*^9, 3.604248006324918*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"analysisSymbol", " ", "=", " ", 
  RowBox[{"ClojureSymbol", "@", "\"\<ClojureLink.analysis\>\""}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604247514286664*^9, 3.604247529951985*^9}, {
  3.604346148913241*^9, 3.6043461493631973`*^9}}],

Cell[BoxData[
 RowBox[{"ClojureSymbol", "[", "\<\"ClojureLink.analysis\"\>", 
  "]"}]], "Output",
 CellChangeTimes->{3.623681864934615*^9, 3.6244561715723677`*^9, 
  3.62804958578191*^9, 3.632126995484827*^9, 3.632861559771141*^9, 
  3.63319997755046*^9, 3.633201352803152*^9, 3.633202213074066*^9, 
  3.633202916224669*^9, 3.633204749452434*^9, 3.633204787465061*^9, 
  3.633204841461853*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", 
  RowBox[{"require", "[", 
   RowBox[{"quote", "[", "analysisSymbol", "]"}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604348202703631*^9, 3.604348215552595*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClojureEvaluate", "[", 
  RowBox[{"in\:2011ns", "[", 
   RowBox[{"quote", "[", "analysisSymbol", "]"}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60434822157169*^9, 3.604348232820772*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\[LeftGuillemet]", 
   RowBox[{"JavaObject", "[", 
    RowBox[{"clojure", ".", "lang", ".", "Namespace"}], "]"}], 
   "\[RightGuillemet]"}],
  JLink`Objects`vm1`JavaObject23608526454652929]], "Output",
 CellChangeTimes->{3.6236818655657873`*^9, 3.624456172254511*^9, 
  3.628049586092245*^9, 3.632126996293621*^9, 3.632861560460232*^9, 
  3.633199978223154*^9, 3.633201353466044*^9, 3.6332022137451077`*^9, 
  3.6332029168955584`*^9, 3.6332047501178303`*^9, 3.6332047882577887`*^9, 
  3.633204842130924*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"currentNamespace", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6043482678417673`*^9, 3.604348269072772*^9}}],

Cell[BoxData["\<\"#<Namespace user>\"\>"], "Output",
 CellChangeTimes->{3.6236818656018953`*^9, 3.624456172312375*^9, 
  3.628049586372106*^9, 3.632126996336144*^9, 3.632861560497404*^9, 
  3.633199978300858*^9, 3.633201353542179*^9, 3.633202213826748*^9, 
  3.633202916928639*^9, 3.6332047501907873`*^9, 3.633204788294609*^9, 
  3.633204842204378*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Work-around", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.604349630805613*^9, 3.604349632026394*^9}}],

Cell[TextData[{
 "Use: ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"nsreq", "[", "\<\"ClojureLink.analysis\"\>", "]"}], ";", 
   RowBox[{"nsreq", "[", "\<\"clojure.jvm.tools.analyzer\"\>", "]"}], ";"}]], 
  "Input",
  CellChangeTimes->{{3.604355241521142*^9, 3.604355249122266*^9}, {
   3.604362896085126*^9, 3.60436293267015*^9}, {3.605053749189436*^9, 
   3.605053749859435*^9}}]
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.608005289115169*^9, 3.608005291615572*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsreq", "[", "ns_ClojureSymbol", "]"}], ":=", 
  RowBox[{"ClojureEvaluate", "@", 
   RowBox[{"require", "@", 
    RowBox[{"quote", "@", "ns"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604349640923064*^9, 3.604349716123522*^9}, {
  3.60435027365521*^9, 3.6043502763968487`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsreq", "[", "ns_String", "]"}], ":=", " ", 
  RowBox[{"nsreq", "[", 
   RowBox[{"ClojureSymbol", "[", "ns", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6043502784641438`*^9, 3.60435030121754*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsq", "[", 
   RowBox[{"ns_", ",", " ", "x_"}], "]"}], ":=", " ", 
  RowBox[{"ClojureSymbol", "[", 
   RowBox[{"StringJoin", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ns", ",", "\"\</\>\"", ",", "x"}], "}"}], "/.", 
      RowBox[{
       RowBox[{"ClojureSymbol", "[", "y_", "]"}], "\[RuleDelayed]", " ", 
       "y"}]}], ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.604349259296501*^9, 3.604349322760928*^9}, {
  3.604349380154913*^9, 3.604349420063553*^9}, {3.604349460997456*^9, 
  3.60434948377182*^9}, {3.604349522224559*^9, 3.6043495321021976`*^9}}],

Cell[BoxData[""], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.610572678585537*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Parse Project", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.6103952921037397`*^9, 3.6103952937583323`*^9}}],

Cell["\<\
Just whack it with the predefined instaparse thing (for all its many warts)\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.610395296710569*^9, 3.610395315302187*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsreq", "[", "\"\<ClojureLink.parser\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610395345023979*^9, 3.6103953552270823`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"parseFile", ",", "parseString"}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6103953810669527`*^9, 3.6103953883458014`*^9}, {
  3.610396819622137*^9, 3.610396821712673*^9}, {3.6106446648737173`*^9, 
  3.610644667691845*^9}, {3.610644785906567*^9, 3.610644786321948*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseFile", "[", "f_String", "]"}], ":=", " ", 
  RowBox[{"ClojureEvaluate", "[", 
   RowBox[{
   "ClojureLink\:2024parser`parse\:2011clojure\:2011file", "[", "f", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.608008045292636*^9, 3.608008074088542*^9}, {
  3.608008106231945*^9, 3.6080081227485*^9}, {3.614890217673031*^9, 
  3.614890219401512*^9}, {3.614964266802423*^9, 3.614964267489718*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseFile", "[", 
   RowBox[{"f_String", ",", " ", "start_"}], "]"}], ":=", 
  RowBox[{"ClojureEvaluate", "[", 
   RowBox[{"ClojureLink\:2024parser`parse\:2011clojure\:2011file", "[", 
    RowBox[{"f", ",", " ", "start"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6150548701346207`*^9, 3.615054888265872*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseFile", "[", 
   RowBox[{"f_String", ",", " ", "start_", ",", "end_"}], "]"}], ":=", 
  RowBox[{"ClojureEvaluate", "[", 
   RowBox[{"ClojureLink\:2024parser`parse\:2011clojure\:2011file", "[", 
    RowBox[{"f", ",", " ", "start", ",", "end"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.61505489927766*^9, 3.615054903987095*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseString", "[", "s_String", "]"}], ":=", " ", 
  RowBox[{"ClojureEvaluate", "[", 
   RowBox[{
   "ClojureLink\:2024parser`parse\:2011clojure\:2011string", "[", "s", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610396831072607*^9, 3.6103968480297527`*^9}, {
  3.614890212635556*^9, 3.614890214897026*^9}}],

Cell["Extend this for ClojureScript & whatever", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6104474311710443`*^9, 3.6104474408599863`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"clojureFiles", "[", "path_String", "]"}], ":=", 
  RowBox[{"FileNames", "[", 
   RowBox[{
    RowBox[{"__", "~~", 
     RowBox[{"(", 
      RowBox[{"\"\<.clj\>\"", "|", "\"\<.cljs\>\""}], ")"}]}], ",", "path", 
    ",", "\[Infinity]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610572654031527*^9, 3.610572667983527*^9}, {
  3.633201435995009*^9, 3.633201440025855*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseProject", "[", "path_String", "]"}], ":=", 
  RowBox[{"ClojureEvaluate", "[", 
   RowBox[{"ClojureLink\:2024parser`parse\:2011clojure\:2011files", "@@", 
    RowBox[{"clojureFiles", "[", "path", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610447287140325*^9, 3.6104472894926777`*^9}, {
   3.610447322280044*^9, 3.610447324271474*^9}, {3.610447363687046*^9, 
   3.610447409191861*^9}, {3.6104474495082912`*^9, 3.610447449782939*^9}, {
   3.6104477843744583`*^9, 3.6104477857975273`*^9}, {3.610572672469282*^9, 
   3.610572675641975*^9}, {3.6149643525620728`*^9, 3.614964374767761*^9}, 
   3.614964626665752*^9}],

Cell[CellGroupData[{

Cell["Tests", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610395426168159*^9, 3.6103954274481993`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseProjectTest", "=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"is", "[", 
      RowBox[{"True", ",", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"parseString", "[", "\"\<[bla]\>\"", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"\:0589top", ",", 
           RowBox[{"{", 
            RowBox[{"\:0589vector", ",", 
             RowBox[{"{", 
              RowBox[{"\:0589symbol", ",", "\"\<bla\>\""}], "}"}]}], "}"}]}], 
          "}"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"is", "[", 
      RowBox[{"True", ",", " ", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{
         "parseFile", "[", 
          "\"\</Users/timothygardner/code/mathematica-clojure-analysis/clj-\
test-project/src/clj_test_project/core.clj\>\"", "]"}], ",", "_List"}], 
        "]"}]}], "]"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6103954342379847`*^9, 3.610395442474114*^9}, {
  3.610395493746976*^9, 3.610395494172647*^9}, {3.610396655662456*^9, 
  3.610396777891797*^9}, {3.6103968751397533`*^9, 3.610396891943015*^9}, {
  3.610731602246356*^9, 3.6107316330890408`*^9}, {3.632861627229941*^9, 
  3.632861630308896*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"runTests", "[", "parseProjectTest", "]"}]], "Input",
 CellChangeTimes->{{3.6328616531090603`*^9, 3.6328616619109077`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"passed", "[", 
    RowBox[{
     RowBox[{"\<\"path\"\>", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Hold", "[", 
      RowBox[{"True", "===", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"parseString", "[", "\<\"[bla]\"\>", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\:0589top", ",", 
           RowBox[{"{", 
            RowBox[{"\:0589vector", ",", 
             RowBox[{"{", 
              RowBox[{"\:0589symbol", ",", "\<\"bla\"\>"}], "}"}]}], "}"}]}], 
          "}"}]}], "]"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"passed", "[", 
    RowBox[{
     RowBox[{"\<\"path\"\>", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Hold", "[", 
      RowBox[{"True", "===", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{
         "parseFile", 
          "[", "\<\"/Users/timothygardner/code/mathematica-clojure-analysis/\
clj-test-project/src/clj_test_project/core.clj\"\>", "]"}], ",", "_List"}], 
        "]"}]}], "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.63286165469589*^9, 3.632861662955168*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["AST Reference Graph", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.610380516707426*^9, 3.610380541802712*^9}}],

Cell[CellGroupData[{

Cell["basic grammar patterns", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.60800974132269*^9, 3.608009747238162*^9}, {
  3.610381996243292*^9, 3.610381996736763*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"whitespaceP", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\:0589whitespace", ",", " ", "___"}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.608009724589842*^9, 3.608009752585112*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["symb, keyword", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.620733283895885*^9, 3.62073328442766*^9}, {
  3.621460858307877*^9, 3.62146086510623*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stringify", "[", 
   RowBox[{"symb", "[", "s_String", "]"}], "]"}], ":=", "s"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6104456318054323`*^9, 3.610445653207426*^9}, {
  3.621461000658691*^9, 3.621461004241847*^9}, {3.621461058549616*^9, 
  3.621461062993976*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stringify", "[", 
   RowBox[{"symb", "[", 
    RowBox[{"ns_String", ",", "s_String"}], " ", "]"}], "]"}], ":=", 
  RowBox[{"ns", "<>", "\"\</\>\"", "<>", "s"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6104456557427673`*^9, 3.610445680359713*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stringify", "[", 
   RowBox[{"keyword", "[", "s_String", "]"}], "]"}], ":=", 
  RowBox[{"\"\<:\>\"", "<>", "s"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.621460866591765*^9, 3.6214608777997427`*^9}, {
  3.621461068303277*^9, 3.621461086323696*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stringify", "[", 
   RowBox[{"keyword", "[", 
    RowBox[{"ns_String", ",", "s_String"}], "]"}], "]"}], ":=", " ", 
  RowBox[{"\"\<:\>\"", "<>", "ns", "<>", "\"\</\>\"", "<>", "s"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.62146109054185*^9, 3.6214611195075207`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cljname", "[", "s_symb", "]"}], ":=", " ", 
  RowBox[{"stringify", "[", "s", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.621461149417179*^9, 3.621461164124139*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cljname", "[", 
   RowBox[{"keyword", "[", "s_String", "]"}], "]"}], ":=", "s"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6214611659196377`*^9, 3.621461177961677*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cljname", "[", 
   RowBox[{"keyword", "[", 
    RowBox[{"ns_String", ",", "s_Str"}], "]"}], "]"}], ":=", "s"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.62146117935515*^9, 3.62146121773707*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["nodify", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6107312986840467`*^9, 3.610731299194854*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsPrefixSplit", "[", "s_String", "]"}], ":=", " ", 
  RowBox[{"StringSplit", "[", 
   RowBox[{"s", ",", "\"\</\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.611012331289899*^9, 3.61101237613424*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsPrefixSplit", "[", "\"\</\>\"", "]"}], ":=", 
  RowBox[{"{", "\"\</\>\"", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.624462246848453*^9, 3.624462260025518*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"defStringPatterns", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<def\>\"", "~~", "___"}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.62073319111436*^9, 3.620733222264535*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"metaSeqP", "=", 
   RowBox[{"PatternSequence", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\:0589metadata\:2011caret", ",", " ", "_"}], "}"}], ",", " ", 
     "_"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.620956153476582*^9, 3.620956206252056*^9}, {
  3.620956249653429*^9, 3.620956364616789*^9}, {3.620957356676874*^9, 
  3.6209573572592173`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nodifyRules", "=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"whitespaceP", "\[RuleDelayed]", " ", 
      RowBox[{"Sequence", "[", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\:0589symbol", ",", " ", "n_String"}], "}"}], " ", 
      "\[RuleDelayed]", 
      RowBox[{"symb", "@@", 
       RowBox[{"nsPrefixSplit", "[", "n", "]"}]}]}], ",", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"note", " ", "this", " ", 
        RowBox[{"doesn", "'"}], "t", " ", "cover", " ", "clr"}], "-", 
       RowBox[{"type", " ", "expressions", " ", "yet"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\:0589keyword", ",", " ", "s_String"}], "}"}], 
      "\[RuleDelayed]", " ", "\[IndentingNewLine]", 
      RowBox[{"First", "[", "\[IndentingNewLine]", 
       RowBox[{"StringCases", "[", 
        RowBox[{"s", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"colon", ":", 
            RowBox[{"(", 
             RowBox[{"\"\<:\>\"", ".."}], ")"}]}], "~~", "rst__"}], 
          "\[RuleDelayed]", " ", "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", 
           RowBox[{"colon", ",", "\[IndentingNewLine]", "\"\<:\>\"", ",", " ", 
            RowBox[{"keyword", "@@", 
             RowBox[{"nsPrefixSplit", "[", "rst", "]"}]}], ",", 
            "\[IndentingNewLine]", "\"\<::\>\"", ",", 
            RowBox[{"keyword", "[", 
             RowBox[{"\"\<:\>\"", ",", "rst"}], "]"}]}], "]"}]}]}], "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sequence", "@@", "\[IndentingNewLine]", 
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "pfn", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"listForm", "[", 
            RowBox[{
             RowBox[{"s_symb", "/;", " ", 
              RowBox[{"StringMatchQ", "[", 
               RowBox[{
                RowBox[{"stringify", "[", "s", "]"}], ",", "pfn"}], "]"}]}], 
             ",", " ", "mfs___metaForm", ",", "n_symb", ",", " ", "body___"}],
             "]"}], "\[RuleDelayed]", " ", "\[IndentingNewLine]", 
           RowBox[{"definingForm", "[", 
            RowBox[{
             RowBox[{"\"\<type\>\"", "\[Rule]", " ", 
              RowBox[{"stringify", "[", "s", "]"}]}], ",", " ", 
             RowBox[{"\"\<definiendum\>\"", "\[Rule]", " ", "n"}], ",", " ", 
             RowBox[{"\"\<body\>\"", "\[Rule]", 
              RowBox[{"{", "body", "}"}]}], ",", " ", 
             RowBox[{"\"\<metadata\>\"", "\[Rule]", " ", 
              RowBox[{"{", "mfs", "}"}]}]}], "]"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", "defStringPatterns"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Sequence", "@@", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"spec", "/.", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tag_", ",", "typ_"}], " ", "}"}], "\[RuleDelayed]", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tag", ",", "body___"}], "}"}], "\[RuleDelayed]", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"typ", "@@", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "body", "}"}], ",", " ", 
               RowBox[{"Except", "[", "whitespaceP", "]"}]}], "]"}]}]}], 
           ")"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"spec", ",", " ", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\:0589vector", ",", " ", "vectorForm"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\:0589list", ",", " ", "listForm"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\:0589map", ",", " ", "mapForm"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\:0589set", ",", " ", "setForm"}], "}"}]}], "}"}]}], 
         "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "not", " ", "at", " ", "all", " ", "sure", " ", "about", " ", "this", 
       " ", "next", " ", 
       RowBox[{"bit", ".", " ", "see"}], " ", "eg", " ", 
       RowBox[{"core_deftype", ".", "clj"}], " ", "for", " ", "motivation"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"listForm", "[", 
       RowBox[{
        RowBox[{"symb", "[", "\"\<in-ns\>\"", "]"}], ",", "___", ",", 
        "nm_symb"}], "]"}], "\[RuleDelayed]", " ", "\[IndentingNewLine]", 
      RowBox[{"nsForm", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<namespaceName\>\"", " ", "\[Rule]", " ", "nm"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<body\>\"", " ", "\[Rule]", " ", 
         RowBox[{"{", "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"listForm", "[", 
       RowBox[{
        RowBox[{"symb", "[", "\"\<ns\>\"", "]"}], ",", " ", "___", ",", 
        "nm_symb", ",", " ", "body___"}], "]"}], "\[RuleDelayed]", 
      "\[IndentingNewLine]", 
      RowBox[{"nsForm", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<namespaceName\>\"", "\[Rule]", " ", "nm"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<body\>\"", "\[Rule]", " ", 
         RowBox[{"{", "body", "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"h", ":", 
       RowBox[{"_", "[", 
        RowBox[{"as___", ",", 
         RowBox[{"m", ":", "metaSeqP"}], ",", "bs___"}], "]"}]}], 
      "\[RuleDelayed]", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Head", "[", "h", "]"}], "@@", 
       RowBox[{"{", 
        RowBox[{"as", ",", 
         RowBox[{"Rest", "@", 
          RowBox[{"metaForm", "[", "m", "]"}]}], ",", "bs"}], "}"}]}]}]}], 
    "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzF9IEwEAx/FzaQ9SmjqqNTTMaKLbqun6Z1IXlZQYOENoSQxpEqFXkG2z
QtM5BBNtsIeygVmSMyEsNZvDh1m4oFXXKtEDtyGUcltJUS6v3HW/e/jxefp9
s6sv6YwSgiCUwmCg4FUG+5UlGb5FAX1dVD6k4yVquF11SwOX+0JaaKSi1ZCj
1TWwqYrkYPb9SlG/YiYu/oavJEQEf+lnk6EzsJgGNZ/qNsKwybQFFvL9O+Cd
C2cUkLG91cH3afl6mPVh8Cr06y6a4JFRwz24VrrTCT8e4nrgyZ+qXti41+OC
D3aXD0BH0jU3PLrY9hISvT0+GLx5YhbebojNQc8L0xe4MjEZhX+0zDd4lx9J
iAq2rqFFHf1vyqDhgOUUzCtx7fshuIf7LVq77a/y8gJLtkuKCuDx1XdB5jtL
SkPyEHxWPJQyJxi0m1Oh3Domh5JBYivs9EZy4EjVjVxYU96ghBURmQp2nN+f
U7TEkusVVB6UZyZqoMNiFX3kLjsLW5wzBkhv8j7hV1jytDUsqgzPj8LMVoUH
thfbvfDfsHES6s2HffDgRIXo4/H0zzAgoxnYWboukeBYsn5MkwSP2a+nw+eN
OhnsaJ6K1Qq6NtOrMGtoYLpOUD2dMg/Nu6QL0PLQtgS7re5laDv3NAab2wp5
OO6vJCh0S+OpkOp+vQFOJfdpYFdTvRb+B0mYqvc=
  "]],

Cell["\<\
Seems we have to break the following out to deal with some evaluation order \
weirdness. Also less ugly this way.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6107385739770107`*^9, 3.610738596351281*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"listOrVectorHP", "=", 
   RowBox[{"listForm", "|", "vectorForm"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610735106579444*^9, 3.610735119020155*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "dotJoin", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610736425208778*^9, 3.6107364287344027`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dotJoin", "[", 
   RowBox[{
    RowBox[{"symb", "[", "a_", "]"}], ",", " ", 
    RowBox[{"symb", "[", "b_", "]"}]}], "]"}], ":=", " ", 
  RowBox[{"symb", "[", 
   RowBox[{"a", "<>", "\"\<.\>\"", "<>", "b"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610736298989551*^9, 3.6107363063129463`*^9}, {
  3.610736352147744*^9, 3.610736437298697*^9}, {3.610737586093446*^9, 
  3.610737587204777*^9}, {3.6107448872639503`*^9, 3.610744889681342*^9}, {
  3.610744928316441*^9, 3.610744937347218*^9}}],

Cell["\<\
Tip o the day: consider breaking rule lists used in RewriteRepeated into \
chain of RewriteRepeated calls on single rules. Much easier to reason about.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.610744547874054*^9, 3.610744647078911*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"refineRequire", "[", 
   RowBox[{"listOrVectorHP", "[", 
    RowBox[{
     RowBox[{"keyword", "[", "\"\<require\>\"", "]"}], ",", "body___"}], 
    "]"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", "body", "}"}], "/.", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"listOrVectorHP", "[", "x_symb", "]"}], "\[RuleDelayed]", " ", 
        RowBox[{"requireForm", "[", "x", "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"listOrVectorHP", "[", 
         RowBox[{"x_symb", ",", " ", 
          RowBox[{"keyword", "[", "\"\<as\>\"", "]"}], ",", " ", "a_symb"}], 
         "]"}], "\[RuleDelayed]", " ", 
        RowBox[{"requireForm", "[", 
         RowBox[{"x", ",", 
          RowBox[{"keyword", "[", "\"\<as\>\"", "]"}], ",", " ", "a"}], 
         "]"}]}]}], "}"}]}], "//.", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"listOrVectorHP", "[", 
      RowBox[{"x_symb", ",", "ys__"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"{", "ys", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"y_symb", "\[RuleDelayed]", " ", 
          RowBox[{"requireForm", "[", 
           RowBox[{"x", ",", " ", "y"}], "]"}]}], ",", " ", 
         RowBox[{"y_requireForm", "\[RuleDelayed]", " ", 
          RowBox[{"Prepend", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "]"}]}]}], "//.", 
   RowBox[{
    RowBox[{"requireForm", "[", 
     RowBox[{"x_symb", ",", " ", "y_symb", ",", " ", "rst___"}], "]"}], 
    "\[RuleDelayed]", " ", 
    RowBox[{"requireForm", "[", 
     RowBox[{
      RowBox[{"dotJoin", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", " ", "rst"}], 
     "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610735287413632*^9, 3.6107353145832767`*^9}, {
   3.6107353701717052`*^9, 3.610735414582951*^9}, {3.610735621873644*^9, 
   3.610735626303762*^9}, {3.610735658308918*^9, 3.610735659660083*^9}, {
   3.6107357618335648`*^9, 3.61073590603118*^9}, {3.610735937152668*^9, 
   3.6107359506075993`*^9}, {3.6107360143932257`*^9, 3.610736026489064*^9}, {
   3.61073607306196*^9, 3.610736251390873*^9}, {3.6107364744428368`*^9, 
   3.610736527874729*^9}, {3.610736568674261*^9, 3.610736572138917*^9}, {
   3.610737357939131*^9, 3.610737366020123*^9}, {3.610737483026243*^9, 
   3.610737491894567*^9}, 3.6107376223964357`*^9, {3.6107376654165573`*^9, 
   3.610737692997312*^9}, {3.6107378846269693`*^9, 3.610737887010515*^9}, {
   3.61073793989734*^9, 3.6107381089452553`*^9}, {3.610738248744295*^9, 
   3.610738254103159*^9}, {3.610738292947707*^9, 3.6107383226661158`*^9}, {
   3.6107383632114267`*^9, 3.6107383726888523`*^9}, {3.610738414428162*^9, 
   3.610738492457061*^9}, {3.6107386498856373`*^9, 3.610738690859728*^9}, {
   3.610739004591279*^9, 3.6107390443494873`*^9}, {3.6107391353954067`*^9, 
   3.6107391398433313`*^9}, {3.610739188140965*^9, 3.6107391931244097`*^9}, {
   3.610739320643567*^9, 3.610739335130712*^9}, {3.61074347796661*^9, 
   3.610743517912011*^9}, {3.610743580251616*^9, 3.61074358508363*^9}, {
   3.610743660413315*^9, 3.610743698500031*^9}, {3.610744256170288*^9, 
   3.610744318513414*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"refineNsForms", "[", "x_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"x", "/.", 
   RowBox[{"nsf_nsForm", "\[RuleDelayed]", " ", "\[IndentingNewLine]", 
    RowBox[{"Replace", "[", 
     RowBox[{"nsf", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\"\<body\>\"", "\[Rule]", " ", "b_"}], ")"}], 
       "\[RuleDelayed]", " ", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         AdjustmentBox["\"\<requireForms\>\"",
          
          BoxMargins->{{0.07689766002823586, -0.07689766002823586}, {0., 
           0.}}], "\[Rule]", " ", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Cases", "[", 
            RowBox[{"b", ",", " ", 
             RowBox[{
              TagBox[
               StyleBox[
                RowBox[{"r", ":", 
                 RowBox[{"listOrVectorHP", "[", 
                  RowBox[{
                   RowBox[{"keyword", "[", "\"\<require\>\"", "]"}], ",", " ",
                    "___"}], "]"}]}],
                ShowSpecialCharacters->False,
                ShowStringCharacters->True,
                NumberMarks->True],
               FullForm], "\[RuleDelayed]", " ", 
              RowBox[{"refineRequire", "[", "r", "]"}]}]}], "]"}]}], ")"}]}], 
        ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "1", "}"}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610730850988106*^9, 3.61073103758223*^9}, {
   3.610731269390586*^9, 3.6107312701076736`*^9}, 3.6107349560374403`*^9, {
   3.610735024675544*^9, 3.610735045850903*^9}, 3.610735103350326*^9, {
   3.610735135629401*^9, 3.6107351530118856`*^9}, {3.610735241249571*^9, 
   3.610735277713626*^9}, {3.610735310360325*^9, 3.610735310776204*^9}, {
   3.610736829186371*^9, 3.610736830887623*^9}, {3.610737019844137*^9, 
   3.610737021157399*^9}, {3.6107371188490953`*^9, 3.610737204863133*^9}, {
   3.610737334090947*^9, 3.610737334705407*^9}, {3.610737736805439*^9, 
   3.610737772676878*^9}, {3.610737819901196*^9, 3.610737822962838*^9}, {
   3.6107378967140303`*^9, 3.610737898755393*^9}, {3.610738700346332*^9, 
   3.61073870697021*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nodify", "[", "x_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"x", "//.", "nodifyRules"}], "//", "refineNsForms"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610730515100505*^9, 3.610730530180799*^9}, {
  3.610730566522615*^9, 3.6107306663328648`*^9}, {3.6107308368962927`*^9, 
  3.61073084829309*^9}, {3.610731219239406*^9, 3.610731237798872*^9}, {
  3.610736718293187*^9, 3.610736719941839*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["definingForm", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610998313792354*^9, 3.610998314924244*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getDefiniendum", "[", "df_definingForm", "]"}], ":=", " ", 
  RowBox[{"lookup", "[", 
   RowBox[{"df", ",", " ", "\"\<definiendum\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610998318121359*^9, 3.6109983414054403`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getBody", "[", "df_definingForm", "]"}], ":=", " ", 
  RowBox[{"lookup", "[", 
   RowBox[{"df", ",", " ", "\"\<body\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610998381809515*^9, 3.610998393572196*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["nsData", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.609855333414425*^9, 3.6098553405834227`*^9}, {
  3.610124103648223*^9, 3.6101241041672792`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"topDefs", "[", "nsd_nsData", "]"}], ":=", 
  RowBox[{"lookup", "[", 
   RowBox[{"nsd", ",", "\"\<topDefs\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610124129854991*^9, 3.610124141344013*^9}}],

Cell[CellGroupData[{

Cell["toNsData", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6101241122487707`*^9, 3.6101241142951317`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"defsByNamespace", "[", "asts_List", "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"groupBy", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"qwikReap", "[", "\[IndentingNewLine]", 
      RowBox[{"Fold", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ns", ",", " ", "x"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{"x", ",", " ", "_nsForm"}], "]"}], ",", 
            "\[IndentingNewLine]", "x", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Sow", "[", 
              RowBox[{"{", 
               RowBox[{"ns", ",", "x"}], "}"}], "]"}], ";", "ns"}]}], "]"}]}],
          "]"}], ",", "\[IndentingNewLine]", "\"\<user\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Cases", "[", 
         RowBox[{"asts", ",", 
          RowBox[{"(", 
           RowBox[{"_nsForm", "|", "_definingForm"}], ")"}], " ", ",", 
          "\[Infinity]"}], "]"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
     "First"}], "]"}], "/.", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"lhs_", " ", "\[Rule]", " ", "rhs_"}], ")"}], "\[RuleDelayed]", 
    " ", 
    RowBox[{"(", 
     RowBox[{"lhs", "\[Rule]", " ", 
      RowBox[{"rhs", "\[LeftDoubleBracket]", 
       RowBox[{";;", ",", "2"}], "\[RightDoubleBracket]"}]}], 
     ")"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.609857006565221*^9, 3.6098570930440407`*^9}, 
   3.609872150217127*^9, {3.6100451789555893`*^9, 3.610045199241926*^9}, {
   3.610045248433338*^9, 3.610045250985991*^9}, 3.610073591124558*^9, {
   3.610073847015432*^9, 3.6100738965104933`*^9}, {3.610075386842208*^9, 
   3.6100754554698772`*^9}, {3.610075702867852*^9, 3.610075705779415*^9}, {
   3.6104388747000427`*^9, 3.610438890048876*^9}, {3.6104421735718927`*^9, 
   3.6104421789693127`*^9}, {3.610443075134761*^9, 3.610443082176201*^9}, {
   3.6107332695563726`*^9, 3.610733276738502*^9}}],

Cell["\<\
Extend the following to deal with \[OpenCurlyDoubleQuote]user\
\[CloseCurlyDoubleQuote] case when we know more about nsForms:\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.610046127879725*^9, 3.610046142260689*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"toNsData", "[", "asts_List", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"defsByNamespace", "[", "asts", "]"}], "/.", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lhs_", "\[Rule]", " ", "rhs_"}], ")"}], "\[RuleDelayed]", 
     RowBox[{"nsData", "[", 
      RowBox[{
       RowBox[{"\"\<nsForm\>\"", "\[Rule]", " ", "lhs"}], ",", 
       RowBox[{"\"\<topDefs\>\"", "\[Rule]", " ", "rhs"}]}], "]"}]}], 
    "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.609856579204216*^9, 3.6098569940827913`*^9}, 
   3.609857032414054*^9, {3.609872201299589*^9, 3.609872201659171*^9}, {
   3.610045562864251*^9, 3.610045668311777*^9}, {3.610045761444873*^9, 
   3.610045890721991*^9}, {3.6100460488807783`*^9, 3.6100460795593233`*^9}, {
   3.610046112582726*^9, 3.610046123344037*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getNamespaceName", "[", "nsf_nsForm", "]"}], ":=", 
  RowBox[{"lookup", "[", 
   RowBox[{"nsf", ",", " ", "\"\<namespaceName\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610443859321344*^9, 3.610443878774343*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getNamespaceName", "[", "nsdt_nsData", "]"}], ":=", " ", 
  RowBox[{"getNamespaceName", "[", 
   RowBox[{"lookup", "[", 
    RowBox[{"nsdt", ",", " ", "\"\<nsForm\>\""}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610045914137578*^9, 3.6100459477681017`*^9}, {
  3.6104438353111553`*^9, 3.610443905744766*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["expandVars", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.609855287468993*^9, 3.609855289268463*^9}}],

Cell[CellGroupData[{

Cell["expandIntranamespaceVars", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6098152185964193`*^9, 3.609815223027438*^9}, {
  3.609851639972869*^9, 3.609851640564426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"varMap", "[", "nsd_nsData", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ns", "=", 
      RowBox[{"First", "@", 
       RowBox[{"getNamespaceName", "[", "nsd", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", "/.", 
        RowBox[{
         RowBox[{"s", ":", 
          RowBox[{"symb", "[", "v_", "]"}]}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"s", "\[Rule]", " ", 
           RowBox[{"symb", "[", 
            RowBox[{"ns", ",", " ", "v"}], "]"}]}], ")"}]}]}], "&"}], ")"}], "/@", 
     RowBox[{"getDefiniendum", "/@", 
      RowBox[{"lookup", "[", 
       RowBox[{"nsd", ",", "\"\<topDefs\>\""}], "]"}]}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.609815315819428*^9, 3.6098153168268137`*^9}, {
   3.6098153650400143`*^9, 3.609815399185444*^9}, {3.609850419698848*^9, 
   3.609850469002906*^9}, {3.6098505027528677`*^9, 3.609850645201371*^9}, 
   3.609850802192239*^9, 3.6098509462584047`*^9, {3.6098510285632153`*^9, 
   3.609851169399253*^9}, {3.610439429637796*^9, 3.610439430682074*^9}, {
   3.610443354379652*^9, 3.610443358529284*^9}, {3.6104439189652357`*^9, 
   3.610443920220604*^9}, {3.61044397519024*^9, 3.610444017869234*^9}, {
   3.610444079975271*^9, 3.610444173544627*^9}, {3.6104442372058163`*^9, 
   3.610444260141432*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandIntranamespaceVars", "[", 
   RowBox[{"nsds", ":", 
    RowBox[{"{", "___nsData", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Map", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"nsd", ",", "\[IndentingNewLine]", 
      RowBox[{"update", "[", 
       RowBox[{"nsd", ",", " ", "\"\<topDefs\>\"", ",", " ", 
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{"varMap", "[", "nsd", "]"}]}], "&"}]}], "]"}]}], "]"}], ",",
     "\[IndentingNewLine]", "nsds"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.609815225491095*^9, 3.6098153076208353`*^9}, {
   3.609815408537516*^9, 3.609815458935131*^9}, {3.609815592775528*^9, 
   3.6098156015023823`*^9}, {3.6098156460241537`*^9, 3.609815650381631*^9}, {
   3.6098491326564283`*^9, 3.6098491529232693`*^9}, 3.610441513803277*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["expandAliasedVars", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.60981514956483*^9, 3.609815169300709*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "expandAliasedVars", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6104406807215443`*^9, 3.610440683562714*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"aliasMap", "[", "nsd_nsData", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"qwikCases", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lookupIn", "[", 
     RowBox[{"nsd", ",", " ", 
      RowBox[{"{", 
       RowBox[{"\"\<nsForm\>\"", ",", " ", "\"\<requireForms\>\""}], "}"}]}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"requireForm", "[", 
      RowBox[{"ns_symb", ",", " ", 
       RowBox[{"keyword", "[", "\"\<as\>\"", "]"}], ",", " ", "a_symb"}], 
      "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"a", "\[Rule]", " ", "ns"}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.609812578526408*^9, 3.609812580023767*^9}, {
  3.60981270214229*^9, 3.609812735518283*^9}, {3.609815388225656*^9, 
  3.609815393808457*^9}, {3.610439932352984*^9, 3.61044004672849*^9}, {
  3.61044008284297*^9, 3.6104400961178713`*^9}, {3.610440128041992*^9, 
  3.610440295963243*^9}, {3.610450261341729*^9, 3.610450266652048*^9}, {
  3.6107395719978733`*^9, 3.610739573168202*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"aliasVarMap", "[", "nsd_nsData", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"aliasMap", "[", "nsd", "]"}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"symb", "[", "a_", "]"}], " ", "\[Rule]", " ", 
      RowBox[{"symb", "[", "ns_", "]"}]}], ")"}], "\[RuleDelayed]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"symb", "[", 
       RowBox[{"a", ",", " ", "nm_"}], "]"}], 
      AdjustmentBox["\[RuleDelayed]",
       BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 0.}}], 
      AdjustmentBox[" ",
       BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 0.}}], 
      RowBox[{
       AdjustmentBox["symb",
        BoxMargins->{{-0.2306929800847076, 0.2306929800847076}, {0., 0.}}], 
       AdjustmentBox["[",
        BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 0.}}], 
       
       AdjustmentBox[
        RowBox[{"ns", ",", " ", "nm"}],
        BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 0.}}], 
       
       AdjustmentBox["]",
        BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 
         0.}}]}]}], 
     AdjustmentBox[")",
      BoxMargins->{{-0.07689766002823586, 0.07689766002823586}, {0., 
       0.}}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6097945619550743`*^9, 3.609794567004404*^9}, {
   3.609794649130281*^9, 3.60979465053793*^9}, 3.6097947549991198`*^9, {
   3.609795044201004*^9, 3.609795089312398*^9}, {3.609795504470194*^9, 
   3.609795722082026*^9}, {3.6097957932446527`*^9, 3.609795799598997*^9}, {
   3.6097959068441133`*^9, 3.609796209669504*^9}, {3.6097964195712633`*^9, 
   3.609796446320644*^9}, {3.609796702690351*^9, 3.609796730994379*^9}, {
   3.60979680012842*^9, 3.6097968196793213`*^9}, {3.6097969502383003`*^9, 
   3.60979695226099*^9}, {3.609796987100778*^9, 3.609797008330043*^9}, {
   3.6097972286472893`*^9, 3.609797228877557*^9}, {3.609797435352722*^9, 
   3.6097974427525806`*^9}, {3.609812233048337*^9, 3.6098122589750423`*^9}, {
   3.609813038418571*^9, 3.609813132990275*^9}, {3.609813193002799*^9, 
   3.609813196827655*^9}, {3.6098134113079643`*^9, 3.6098134313049803`*^9}, {
   3.609814268737215*^9, 3.609814271735549*^9}, {3.610440387411509*^9, 
   3.610440392785549*^9}, {3.61101138183171*^9, 3.611011419359302*^9}, {
   3.612394318839374*^9, 3.61239432115814*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandAliasedVars", "[", 
   RowBox[{"nsds", ":", 
    RowBox[{"{", "___nsData", "}"}]}], "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Map", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"nsd", ",", "\[IndentingNewLine]", 
      RowBox[{"update", "[", 
       RowBox[{"nsd", ",", " ", "\"\<topDefs\>\"", ",", " ", 
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{"aliasVarMap", "[", "nsd", "]"}]}], "&"}]}], "]"}]}], "]"}],
     ",", "\[IndentingNewLine]", "nsds"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.609794011345903*^9, 3.609794232188349*^9}, {
   3.609794294595677*^9, 3.609794322082171*^9}, {3.609794363137237*^9, 
   3.609794364802099*^9}, {3.609794395297037*^9, 3.609794558268877*^9}, {
   3.609794747552103*^9, 3.6097948070785017`*^9}, {3.6097950346178417`*^9, 
   3.609795040377336*^9}, {3.609795763603141*^9, 3.6097957895130053`*^9}, {
   3.6097960781384783`*^9, 3.6097960793499527`*^9}, {3.609796656051499*^9, 
   3.6097966965552464`*^9}, {3.6098140238352623`*^9, 
   3.6098140239859037`*^9}, {3.6098148470005283`*^9, 3.609814847727777*^9}, 
   3.610440665683219*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["expandVars", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.609855308477116*^9, 3.609855310395756*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandVars", "[", 
   RowBox[{"nsds", ":", 
    RowBox[{"{", "___nsData", "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"nsds", "//", "expandAliasedVars"}], "//", 
   "expandIntranamespaceVars"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.609793257408784*^9, 3.609793282927454*^9}, 
   3.609793313689014*^9, {3.609793378103998*^9, 3.60979341903165*^9}, {
   3.6097935374926043`*^9, 3.609793548052568*^9}, {3.60979724048482*^9, 
   3.609797251773683*^9}, {3.6097972883234043`*^9, 3.609797290619759*^9}, {
   3.609811934567346*^9, 3.609811936418545*^9}, {3.609813121693036*^9, 
   3.6098131238855743`*^9}, {3.610740487872706*^9, 3.610740488951466*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["expandKeywords", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6214614727658453`*^9, 3.6214614785650797`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandKeywords", "[", "nsd_nsData", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"let", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ns", "=", 
      RowBox[{"First", "@", 
       RowBox[{"getNamespaceName", "[", "nsd", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"update", "[", 
     RowBox[{"nsd", ",", "\"\<topDefs\>\"", ",", 
      RowBox[{
       RowBox[{"#", "/.", 
        RowBox[{
         RowBox[{"keyword", "[", 
          RowBox[{"\"\<:\>\"", ",", "bla_"}], "]"}], "\[RuleDelayed]", " ", 
         RowBox[{"keyword", "[", 
          RowBox[{"ns", ",", "bla"}], "]"}]}]}], "&"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.621461542679903*^9, 3.621461587066759*^9}, {
  3.621461648187427*^9, 3.6214617952977667`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandKeywords", "[", 
   RowBox[{"nsds", ":", 
    RowBox[{"{", "___nsData", "}"}]}], "]"}], ":=", 
  RowBox[{"expandKeywords", "/@", "nsds"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.621461488199798*^9, 3.621461540563957*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["nsGraph", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6100774110303507`*^9, 3.6100774126282797`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"defrefs", "[", "df_definingForm", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"qwikCases", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getBody", "[", "df", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", ":", 
      RowBox[{"symb", "[", 
       RowBox[{"_", ",", "_"}], "]"}]}], "\[RuleDelayed]", 
     RowBox[{"stringify", "[", "s", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610077914602257*^9, 3.610077923103558*^9}, {
  3.610078010667119*^9, 3.610078026165422*^9}, {3.6100780632672586`*^9, 
  3.610078073473043*^9}, {3.610079796783955*^9, 3.610079797612877*^9}, {
  3.610439780150536*^9, 3.610439781186903*^9}, {3.6104455177743187`*^9, 
  3.610445520504147*^9}, {3.61044555724335*^9, 3.610445618079688*^9}, {
  3.610450330995612*^9, 3.6104503577309303`*^9}, {3.610450401946204*^9, 
  3.6104504042034273`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"defGraph", "[", "df_definingForm", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d", "=", 
      RowBox[{"stringify", "[", 
       RowBox[{"getDefiniendum", "[", "df", "]"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graph", "[", 
     RowBox[{
      RowBox[{"{", "d", "}"}], ",", 
      RowBox[{"Union", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", "\[DirectedEdge]", "#"}], "&"}], ")"}], "/@", 
        RowBox[{"defrefs", "[", "df", "]"}]}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610077780496315*^9, 3.610077870134404*^9}, {
  3.610078322625333*^9, 3.6100783319600363`*^9}, {3.6100784357058372`*^9, 
  3.610078436586287*^9}, {3.610439775184567*^9, 3.610439776585741*^9}, {
  3.61044436487989*^9, 3.61044437073256*^9}, {3.6104444498918133`*^9, 
  3.610444453858474*^9}, {3.61044562401705*^9, 3.61044563024793*^9}, {
  3.6332001327946777`*^9, 3.633200132906271*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsGraph", "[", "nsdt_nsData", "]"}], ":=", 
  RowBox[{"graphUnion2", " ", "@@", 
   RowBox[{"(", 
    RowBox[{"defGraph", "/@", 
     RowBox[{"topDefs", "[", "nsdt", "]"}]}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610077500196782*^9, 3.610077513611018*^9}, {
  3.610077547370698*^9, 3.610077548268529*^9}, {3.610077594518313*^9, 
  3.6100777774720297`*^9}, {3.610079015592778*^9, 3.610079025654418*^9}, {
  3.610444615408032*^9, 3.610444616871752*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsGraph", "[", 
   RowBox[{"nsdts", ":", 
    RowBox[{"{", "___nsData", "}"}]}], "]"}], ":=", 
  RowBox[{"graphUnion2", " ", "@@", 
   RowBox[{"(", 
    RowBox[{"nsGraph", "/@", "nsdts"}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610077426069775*^9, 3.610077493530346*^9}, {
  3.61007903158296*^9, 3.610079045541662*^9}, {3.610444618759241*^9, 
  3.610444620416692*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["graphProject", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.609855294524439*^9, 3.6098552974999743`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphProject", "[", "asts_List", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"asts", "//", "nodify"}], "//", "toNsData"}], "//", 
     "expandVars"}], "//", "expandKeywords"}], "//", "nsGraph"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60979342796974*^9, 3.609793453469955*^9}, {
  3.60979349000483*^9, 3.609793562452132*^9}, {3.609856608212119*^9, 
  3.60985660992583*^9}, {3.610124022356863*^9, 3.6101240400660267`*^9}, {
  3.610133015296801*^9, 3.610133017512093*^9}, {3.610389733251082*^9, 
  3.610389737163827*^9}, {3.6103898426864243`*^9, 3.610389844553645*^9}, {
  3.610398104316517*^9, 3.610398105532381*^9}, {3.621461815914838*^9, 
  3.621461817852085*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphProject", "[", "projectPath_String", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"projectPath", "//", "parseProject"}], "//", 
   "graphProject"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6097936669693937`*^9, 3.609793723904351*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphFile", "[", "f_String", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "//", "parseFile"}], "//", "List"}], "//", 
   "graphProject"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6107407319944677`*^9, 3.610740734136409*^9}, {
  3.6107407887181396`*^9, 3.610740818436824*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Review & Todo", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.610450647129668*^9, 3.610450653039413*^9}}],

Cell["\<\
This file could be much shorter, and would have been faster to write, if the \
parse tree had been more to the point originally. We definitely want to \
nodify, but the rules could have been much simpler, it seems to me. (Maybe \
not.)

We also lost a fair amount of time dithering over the correct representation, \
and whether it makes sense to nodify things or just recalculate using some \
globally defined patterns without modifying the tree at all. The later course \
of action proved intractably cumbersome with no clear advantages other than \
an appeal to knee-jerk conservatism, stupid in the presence of immutability.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.610450748725988*^9, 3.6104509210892076`*^9}}],

Cell["\<\
We\[CloseCurlyQuote]ll want some way to tag vars we\[CloseCurlyQuote]re \
graphing with their general type (defrecord, defprotcol, multimethod, \
function, just a thing, etc). Also need some treatment for more subtle \
defining forms like multimethods, protocols, etc.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.610450649599959*^9, 3.610450730469689*^9}}],

Cell["\<\
Also \[OpenCurlyDoubleQuote]projectGraph\[CloseCurlyDoubleQuote] would be a \
better name than \[OpenCurlyDoubleQuote]graphProject.\[CloseCurlyDoubleQuote]\
\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6104521421564417`*^9, 3.610452153866802*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Smush", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.6104504321906776`*^9, 3.610450434869288*^9}}],

Cell[CellGroupData[{

Cell["Namespace Communities", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610450447759166*^9, 3.610450449969255*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getNamespaceName", "[", "s_String", "]"}], ":=", 
  RowBox[{
   RowBox[{"StringCases", "[", 
    RowBox[{"s", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ns__", "~~", "\"\</\>\"", "~~", "__"}], "\[RuleDelayed]", 
        " ", "ns"}], ",", " ", 
       RowBox[{"_", "\[Rule]", " ", "Null"}]}], "}"}]}], "]"}], "//", 
   "First"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610451219236598*^9, 3.610451300063017*^9}, {
  3.610451696364637*^9, 3.6104517415832*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"varsByNamespace", "[", "g_Graph", "]"}], ":=", 
  RowBox[{"groupBy", "[", 
   RowBox[{
    RowBox[{"VertexList", "[", "g", "]"}], ",", "getNamespaceName"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610450467072275*^9, 3.610450511468999*^9}, {
   3.6104512161361322`*^9, 3.610451216943095*^9}, {3.610451671864397*^9, 
   3.6104516876892776`*^9}, {3.610451753410536*^9, 3.6104517544198437`*^9}, 
   3.610559033286332*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"namespaceCommunities", "[", "g_Graph", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"varsByNamespace", "[", "g", "]"}], "/.", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"ns_", " ", "\[Rule]", " ", "vs_"}], ")"}], "\[RuleDelayed]", 
    " ", 
    RowBox[{"Labeled", "[", 
     RowBox[{"vs", ",", "ns"}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6105688799120817`*^9, 3.610568892305365*^9}}],

Cell["\<\
Could make this subtler to preserve other styles, if it becomes an issue:\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.611000329829915*^9, 3.611000345236788*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"colorVertsByNamespace", "[", "g_Graph", "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"let", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vbn", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"varsByNamespace", "[", "g", "]"}], ",", " ", "First"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"cf", "=", 
       RowBox[{"ColorData", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<DarkRainbow\>\"", ",", "\"\<Reverse\>\""}], "}"}], 
        "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"addGraphOpts", "[", "\[IndentingNewLine]", 
     RowBox[{"g", ",", "\[IndentingNewLine]", 
      RowBox[{"VertexStyle", "\[Rule]", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{"qwikMapIndexed", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"nsv", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"nsv", "/.", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ns_", "\[Rule]", " ", "vs_"}], ")"}], 
              "\[RuleDelayed]", " ", "\[IndentingNewLine]", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"c", "=", 
                  RowBox[{"cf", "[", 
                   FractionBox["i", 
                    RowBox[{"Length", "[", "vbn", "]"}]], "]"}]}], "}"}], ",", 
                RowBox[{"Replace", "[", 
                 RowBox[{"vs", ",", " ", 
                  RowBox[{"v_", " ", "\[RuleDelayed]", " ", 
                   RowBox[{"(", 
                    RowBox[{"v", "\[Rule]", "c"}], ")"}]}], ",", 
                  RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}]}]}], "]"}], ",",
           "\[IndentingNewLine]", "vbn"}], "]"}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610998573211959*^9, 3.610998616817216*^9}, {
   3.610998657246208*^9, 3.610998697933797*^9}, {3.610998756864399*^9, 
   3.610998851143195*^9}, {3.610998891234967*^9, 3.6109990036707067`*^9}, {
   3.61099951994842*^9, 3.610999718983132*^9}, {3.610999764545557*^9, 
   3.6109998321280203`*^9}, {3.611000378153893*^9, 3.6110005023392763`*^9}, {
   3.6110006941462793`*^9, 3.611000708597493*^9}, 3.611007953014205*^9, {
   3.6110083384054317`*^9, 3.611008350610318*^9}, {3.6110083893616667`*^9, 
   3.611008406233789*^9}, {3.611008443522596*^9, 3.61100846109695*^9}, {
   3.61577690084205*^9, 3.615776904627035*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Unqualified Names", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.610561376171624*^9, 3.610561379433832*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"unqualifiedName", "[", "s_String", "]"}], ":=", " ", 
  RowBox[{"StringReplace", "[", 
   RowBox[{"s", ",", 
    RowBox[{
     RowBox[{"__", "~~", "\"\</\>\"", "~~", "n__"}], "\[RuleDelayed]", " ", 
     "n"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6105610410401163`*^9, 3.610561134993113*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"unqualifiedName", "[", "x_", "]"}], ":=", "x"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610561200468191*^9, 3.6105612056994467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"addUnqualifiedNameLabels", "[", "g_Graph", "]"}], ":=", 
  RowBox[{"addGraphOpts", "[", 
   RowBox[{"g", ",", " ", 
    RowBox[{"VertexLabels", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Rule]", " ", 
         RowBox[{"unqualifiedName", "[", "#", "]"}]}], "&"}], "/@", 
       RowBox[{"VertexList", "[", "g", "]"}]}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.610560867351274*^9, 3.610560869878811*^9}, {
  3.610560962612029*^9, 3.610561031132012*^9}, {3.610561156592494*^9, 
  3.61056119377938*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Glam", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.612394501775454*^9, 3.6123945051399183`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ornamentProject", "[", "g_Graph", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"g", "//", "ornament"}], "//", "colorVertsByNamespace"}], "//", 
   "addUnqualifiedNameLabels"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612394457696207*^9, 3.612394475299385*^9}, {
  3.612397214432919*^9, 3.612397214811243*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Vertex nabbing", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6123978766737947`*^9, 3.612397879168398*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vertSelect", "[", 
   RowBox[{"g_Graph", ",", " ", "pred_"}], "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"VertexList", "@", "g"}], ",", "pred"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612397467799613*^9, 3.6123975077079163`*^9}, {
  3.612398081885593*^9, 3.612398083205925*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vertCases", "[", 
   RowBox[{"g_Graph", ",", "p_"}], "]"}], ":=", " ", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"VertexList", "@", "g"}], ",", "p"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612397695367611*^9, 3.612397713284607*^9}, {
  3.612398091036993*^9, 3.612398101203575*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vertStringMatches", "[", 
   RowBox[{"g_Graph", ",", " ", "p_"}], "]"}], ":=", " ", 
  RowBox[{"vertSelect", "[", 
   RowBox[{"g", ",", " ", 
    RowBox[{"x", "\[Function]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"StringQ", "[", "x", "]"}], "\[And]", " ", 
       RowBox[{"StringMatchQ", "[", 
        RowBox[{"x", ",", "p"}], "]"}]}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6123975362819033`*^9, 3.612397590345786*^9}, {
  3.6123976434361753`*^9, 3.612397645532023*^9}, {3.612397721797194*^9, 
  3.612397727830462*^9}, {3.612397775635683*^9, 3.612397781339246*^9}, {
  3.6123978286847363`*^9, 3.6123978569971848`*^9}, {3.612398087189378*^9, 
  3.612398088398464*^9}, {3.612398152016493*^9, 3.6123981775171623`*^9}, {
  3.612398213247163*^9, 3.612398274033856*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vertStringMatches", "[", 
   RowBox[{"g_Graph", ",", " ", "ps_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Join", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"vertStringMatches", "[", 
       RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", "ps"}], 
    ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.618159162244836*^9, 3.618159226791403*^9}, {
  3.618512385698038*^9, 3.6185123960247087`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Edge Nabbing", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.614896932991982*^9, 3.614896940275976*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"edgeStringMatches", "[", 
   RowBox[{"g_Graph", ",", " ", "p1_", ",", " ", "p2_"}], "]"}], ":=", " ", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"EdgeList", "[", "g", "]"}], ",", 
    RowBox[{
     RowBox[{"_", "[", 
      RowBox[{"l_", ",", "r_"}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"StringMatchQ", "[", 
        RowBox[{"l", ",", "p1"}], "]"}], "\[And]", 
       RowBox[{"StringMatchQ", "[", 
        RowBox[{"r", ",", "p2"}], "]"}]}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612661050420208*^9, 3.6126611616905413`*^9}, {
   3.612661501215685*^9, 3.612661589334016*^9}, {3.612662178030319*^9, 
   3.612662207858614*^9}, 3.612662352227208*^9, {3.612662486975588*^9, 
   3.612662488283267*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Component Nabbing", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.612622862129237*^9, 3.612622864433592*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"componentWithVertex", "[", 
   RowBox[{"g_Graph", ",", " ", "vs_List"}], "]"}], ":=", " ", 
  RowBox[{"Subgraph", "[", 
   RowBox[{"g", ",", " ", 
    RowBox[{"WeaklyConnectedComponents", "[", 
     RowBox[{"g", ",", "vs"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612396868662723*^9, 3.612396966696204*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["CLR stuff", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.612462918073955*^9, 3.612462919520483*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"removeProbableCLRStatics", "[", "g_Graph", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"VertexDelete", "[", 
   RowBox[{"g", ",", 
    RowBox[{"vertStringMatches", "[", 
     RowBox[{"g", ",", 
      RowBox[{"RegularExpression", "[", "\"\<[A-Z].*/.*\>\"", "]"}]}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612462669117148*^9, 3.612462811960257*^9}, {
  3.612462940159107*^9, 3.612462941909457*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Sloppy", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.614896916713455*^9, 3.614896917984445*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"patternForSubstring", "[", "s_String", "]"}], ":=", " ", 
  RowBox[{"___", "~~", "s", "~~", "___"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612661750769816*^9, 3.6126617861819057`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pfs", "=", "patternForSubstring"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612661788842353*^9, 3.612661792870392*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"regex", "=", "RegularExpression"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.61246273729249*^9, 3.612462741406743*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rpclrs", "=", "removeProbableCLRStatics"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612462840757883*^9, 3.6124628480110683`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vsm", "=", "vertStringMatches"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612663264667663*^9, 3.612663270946165*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dsg", "=", "downstreamGraph"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6212952811286507`*^9, 3.62129528534476*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"usg", "=", "upstreamGraph"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6212952879281797`*^9, 3.621295290360581*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sloppyEdgeAdd", "[", 
   RowBox[{"g_Graph", ",", " ", "es_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"EdgeAdd", "[", 
   RowBox[{"g", ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Tuples", "/@", 
      RowBox[{"Replace", "[", 
       RowBox[{"es", ",", 
        RowBox[{"x_", "\[RuleDelayed]", " ", 
         RowBox[{"vsm", "[", 
          RowBox[{"g", ",", "x"}], "]"}]}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6126635319438477`*^9, 3.612663602853861*^9}, {
  3.612663714153637*^9, 3.612663778961193*^9}, {3.612663822031548*^9, 
  3.6126638264752274`*^9}, {3.612663889158257*^9, 3.612663896949793*^9}, {
  3.612664548589522*^9, 3.612664571661318*^9}, {3.612664665937681*^9, 
  3.6126646661357393`*^9}, {3.612664777356161*^9, 3.612664807736454*^9}, {
  3.6126650703705463`*^9, 3.612665123460739*^9}, {3.6126651713505573`*^9, 
  3.612665173884782*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sloppyEdgeDelete", "[", 
   RowBox[{"g_Graph", ",", " ", "es_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"EdgeDelete", "[", 
   RowBox[{"g", ",", 
    RowBox[{"qwikCases", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"edgeStringMatches", "[", 
         RowBox[{"g", ",", "##"}], "]"}], "&"}], "@@@", "es"}], ",", 
      "_DirectedEdge"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6126635319438477`*^9, 3.612663602853861*^9}, {
  3.612663714153637*^9, 3.612663778961193*^9}, {3.612663822031548*^9, 
  3.6126638264752274`*^9}, {3.612663889158257*^9, 3.612663896949793*^9}, {
  3.612664548589522*^9, 3.612664571661318*^9}, {3.612664665937681*^9, 
  3.6126646661357393`*^9}, {3.612664777356161*^9, 3.612664807736454*^9}, {
  3.6126650703705463`*^9, 3.612665123460739*^9}, {3.6126651713505573`*^9, 
  3.612665173884782*^9}, {3.6127115838914013`*^9, 3.612711585034382*^9}, {
  3.612711650800474*^9, 3.612711688222591*^9}, {3.612711720015526*^9, 
  3.612711731666054*^9}, {3.61271177578198*^9, 3.612711797701847*^9}, {
  3.612711828471561*^9, 3.61271183550143*^9}, {3.612711903193315*^9, 
  3.612711909834234*^9}, {3.6127120943753967`*^9, 3.612712095071714*^9}, {
  3.614899146621483*^9, 3.6148991468786793`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sloppyVertexDelete", "[", 
   RowBox[{"g_Graph", ",", "es_List"}], "]"}], ":=", 
  RowBox[{"VertexDelete", "[", 
   RowBox[{"g", ",", 
    RowBox[{"DeleteDuplicates", "@", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vertStringMatches", "[", 
         RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", "es"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6148994279296093`*^9, 3.614899467641119*^9}, {
  3.614963057583568*^9, 3.614963168610524*^9}, {3.617823334617865*^9, 
  3.6178233368658857`*^9}, {3.6181579876188183`*^9, 3.618157991419222*^9}}],

Cell[CellGroupData[{

Cell["vsmpfs", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.62012850086769*^9, 3.620128502050921*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vsmpfs", "[", 
   RowBox[{"g_Graph", ",", 
    RowBox[{"s_", "?", "stringishQ"}]}], "]"}], ":=", " ", 
  RowBox[{"vsm", "[", 
   RowBox[{"g", ",", 
    RowBox[{"pfs", "@", "s"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.619461607609006*^9, 3.6194616503856688`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vsmpfs", "[", 
   RowBox[{"g_Graph", ",", "ss_List"}], "]"}], ":=", " ", 
  RowBox[{"vsm", "[", 
   RowBox[{"g", ",", 
    RowBox[{"pfs", "/@", "ss"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.619461652153893*^9, 3.619461667784573*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["sloppyHighlight, sloppyNeighborhoodGraph", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6201284871564913`*^9, 3.620128496058958*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sloppyHighlight", "[", 
   RowBox[{"g_Graph", ",", " ", 
    RowBox[{"s", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"_", "?", "stringishQ"}], "|", "List_"}], ")"}]}]}], "]"}], ":=", 
  RowBox[{"HighlightGraph", "[", 
   RowBox[{"g", ",", 
    RowBox[{"Subgraph", "[", 
     RowBox[{"g", ",", 
      RowBox[{"vsmpfs", "[", 
       RowBox[{"g", ",", "s"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.618806404302909*^9, 3.6188064050156727`*^9}, {
  3.619455152336134*^9, 3.619455213332818*^9}, {3.619455628228817*^9, 
  3.6194556387667017`*^9}, {3.619456356859542*^9, 3.61945636645938*^9}, {
  3.6194616711620007`*^9, 3.619461727879364*^9}, {3.619462156288303*^9, 
  3.6194621613594503`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sloppyNeighborhoodGraph", "[", 
   RowBox[{"g_Graph", ",", " ", 
    RowBox[{"s", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"_", "?", "stringishQ"}], "|", "List_"}], ")"}]}], ",", " ", 
    "n___"}], "]"}], ":=", " ", 
  RowBox[{"NeighborhoodGraph", "[", 
   RowBox[{"g", ",", 
    RowBox[{"vsmpfs", "[", 
     RowBox[{"g", ",", "s"}], "]"}], ",", "n"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.619456294298457*^9, 3.6194563015231657`*^9}, {
  3.619456390479701*^9, 3.619456415947279*^9}, {3.6194564613946743`*^9, 
  3.619456483940576*^9}, {3.619461271963933*^9, 3.619461289484234*^9}, {
  3.6194613456241093`*^9, 3.6194614231934557`*^9}, {3.619461502345592*^9, 
  3.619461533299203*^9}, {3.619461564451126*^9, 3.619461593609644*^9}, {
  3.619461766058503*^9, 3.619461788941882*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sloppyNeighborhoodPluckout", "[", 
   RowBox[{"g_Graph", ",", "specs_", ",", "n___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"sloppyHighlight", "[", 
    RowBox[{
     RowBox[{"sloppyNeighborhoodGraph", "[", 
      RowBox[{"g", ",", "specs", ",", "n"}], "]"}], ",", "specs"}], "]"}], "//",
    "ornamentProject"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6194626562580357`*^9, 3.6194627637740517`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Subgraphs", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.615778221760912*^9, 3.6157782229038153`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphCycles", "[", 
   RowBox[{"g_Graph", ",", " ", "args___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Subgraph", "[", 
     RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"ConnectedComponents", "[", 
      RowBox[{"g", ",", "args"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "#", "]"}], ">", "1"}], "&"}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615777855374001*^9, 3.6157778707027493`*^9}, {
  3.615777974293791*^9, 3.6157780535478573`*^9}, {3.615778495582624*^9, 
  3.615778495930047*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphDifference2", "[", 
   RowBox[{"gAll_Graph", ",", " ", "gs___Graph"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Subgraph", "[", 
   RowBox[{"gAll", ",", 
    RowBox[{"Complement", "[", 
     RowBox[{
      RowBox[{"VertexList", "[", "gAll", "]"}], ",", " ", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"(", 
        RowBox[{"VertexList", "/@", 
         RowBox[{"{", "gs", "}"}]}], ")"}]}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615779116483562*^9, 3.615779233067151*^9}, {
  3.615779395979979*^9, 3.61577939845961*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sexy abstract functions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6157826635977793`*^9, 3.615782666324596*^9}, {
  3.615782711847163*^9, 3.6157827167171917`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapAgainstOthers", "[", 
   RowBox[{"f_", ",", "stuff_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"qwikMapIndexed", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "i"}], "}"}], "\[Function]", 
     RowBox[{"f", "[", 
      RowBox[{"x", ",", 
       RowBox[{"stuff", "\[LeftDoubleBracket]", 
        RowBox[{";;", 
         RowBox[{"i", "-", "1"}]}], "\[RightDoubleBracket]"}], ",", " ", 
       RowBox[{"stuff", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"i", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", "stuff"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615781626685569*^9, 3.61578174053032*^9}, {
  3.615781813566596*^9, 3.615781824294341*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Top Bottom Loop", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6209919737761097`*^9, 3.6209919753120127`*^9}, {
  3.6209920247422132`*^9, 3.620992027452961*^9}, {3.6209920767924023`*^9, 
  3.620992079639142*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"topVertices", "[", "g_Graph", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"h", "=", 
      RowBox[{"removeSelfLoops", "[", "g", "]"}]}], "}"}], ",", " ", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"VertexList", "[", "h", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"VertexInDegree", "[", 
         RowBox[{"h", ",", "#"}], "]"}], "\[Equal]", "0"}], "&"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6212942110219097`*^9, 3.621294320886283*^9}, {
  3.623683623879966*^9, 3.6236836402950478`*^9}, {3.623683684631544*^9, 
  3.6236836994207897`*^9}, {3.623683774243017*^9, 3.623683775234239*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bottomVertices", "[", "g_Graph", "]"}], ":=", " ", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"h", "=", 
      RowBox[{"removeSelfLoops", "[", "g", "]"}]}], "}"}], ",", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"VertexList", "[", "h", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"VertexOutDegree", "[", 
         RowBox[{"h", ",", "#"}], "]"}], "\[Equal]", "0"}], "&"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6212943310548573`*^9, 3.621294352806353*^9}, {
  3.623683650278469*^9, 3.623683657919346*^9}, {3.6236837043006077`*^9, 
  3.623683716212304*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"loops", "[", "g_Graph", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"ConnectedComponents", "[", "g", "]"}], ",", 
    RowBox[{
     RowBox[{"1", "<", 
      RowBox[{"Length", "[", "#", "]"}]}], "&"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.621294369794013*^9, 3.621294403115357*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"highlightTopBottomLoop", "[", "g_Graph", "]"}], ":=", 
  RowBox[{"HighlightGraph", "[", 
   RowBox[{"g", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"topVertices", "[", "g", "]"}], ",", 
      RowBox[{"bottomVertices", "[", "g", "]"}], ",", 
      RowBox[{"Sequence", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Subgraph", "[", 
           RowBox[{"g", ",", "#"}], "]"}], "&"}], ")"}], "/@", 
        RowBox[{"loops", "[", "g", "]"}]}], "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.621294583586463*^9, {3.621294669598008*^9, 3.621294673781289*^9}, {
   3.621294725448267*^9, 3.6212948657917557`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples, glutch", "Section",
 CellChangeTimes->{{3.610448418558507*^9, 3.610448422475556*^9}, {
  3.6106491691562767`*^9, 3.6106491745319233`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "graphProject", "[", 
   "\"\</Users/timothygardner/code/mathematica-clojure-analysis/clj-test-\
project/src/\>\"", "]"}], "//", "ornament"}]], "Input",
 CellChangeTimes->{{3.610447471751474*^9, 3.61044747221865*^9}, {
  3.610447713007024*^9, 3.610447740406928*^9}, {3.61044779927914*^9, 
  3.61044780079723*^9}}],

Cell[BoxData[
 RowBox[{"let", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"g", "=", 
      RowBox[{
      "graphProject", "[", 
       "\"\</Users/timothygardner/code/mathematica-clojure-analysis/clj-test-\
project/src/\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"nsm", "=", " ", 
      RowBox[{"varsByNamespace", "[", "g", "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"CommunityGraphPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "//", "addToolTips"}], "//", "addUnqualifiedNameLabels"}], 
     ",", 
     RowBox[{"nsm", "/.", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ns_", " ", "\[Rule]", " ", "vs_"}], ")"}], "\[RuleDelayed]", 
       " ", 
       RowBox[{"Labeled", "[", 
        RowBox[{"vs", ",", "ns"}], "]"}]}]}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.610447471751474*^9, 3.61044747221865*^9}, {
  3.610447713007024*^9, 3.610447740406928*^9}, {3.61044779927914*^9, 
  3.61044780079723*^9}, {3.61045179864142*^9, 3.6104518634165163`*^9}, {
  3.610451906916009*^9, 3.610451973133786*^9}, {3.61045206369525*^9, 
  3.610452103821458*^9}, {3.610561390366461*^9, 3.6105613937163143`*^9}, {
  3.610561671300583*^9, 3.610561692523582*^9}}],

Cell[BoxData[
 RowBox[{"let", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"g", "=", 
     RowBox[{
     "graphProject", "[", "\"\</Users/timothygardner/code/ClojureLink\>\"", 
      "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"CommunityGraphPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "//", "addToolTips"}], "//", "addUnqualifiedNameLabels"}], 
     ",", 
     RowBox[{"namespaceCommunities", "[", "g", "]"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.610447471751474*^9, 3.61044747221865*^9}, {
  3.610447713007024*^9, 3.610447740406928*^9}, {3.61044779927914*^9, 
  3.61044780079723*^9}, {3.61045179864142*^9, 3.6104518634165163`*^9}, {
  3.610451906916009*^9, 3.610451973133786*^9}, {3.61045206369525*^9, 
  3.610452103821458*^9}, {3.610455748209303*^9, 3.610455750806202*^9}, {
  3.610484308443912*^9, 3.61048432789806*^9}, {3.610484385136224*^9, 
  3.610484387063624*^9}, {3.610561418714509*^9, 3.610561420361993*^9}, {
  3.610568721733883*^9, 3.610568725401903*^9}, {3.6105689243759336`*^9, 
  3.610568946132617*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6105255455662003`*^9, 3.610525552328529*^9}}],

Cell[BoxData[
 RowBox[{"let", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"g", "=", 
      RowBox[{
      "graphProject", "[", "\"\</Users/timothygardner/code/quil\>\"", "]"}]}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"nsm", "=", " ", 
      RowBox[{"varsByNamespace", "[", "g", "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Column", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"CommunityGraphPlot", "[", 
       RowBox[{
        RowBox[{"g", "//", "addToolTips"}], ",", 
        RowBox[{"nsm", "/.", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ns_", " ", "\[Rule]", " ", "vs_"}], ")"}], 
          "\[RuleDelayed]", " ", 
          RowBox[{"Labeled", "[", 
           RowBox[{"vs", ",", "ns"}], "]"}]}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"g", "//", "EdgeList"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.610447471751474*^9, 3.61044747221865*^9}, {
  3.610447713007024*^9, 3.610447740406928*^9}, {3.61044779927914*^9, 
  3.61044780079723*^9}, {3.61045179864142*^9, 3.6104518634165163`*^9}, {
  3.610451906916009*^9, 3.610451973133786*^9}, {3.61045206369525*^9, 
  3.610452103821458*^9}, {3.610455748209303*^9, 3.610455750806202*^9}, {
  3.610484308443912*^9, 3.61048432789806*^9}, {3.610484385136224*^9, 
  3.610484387063624*^9}, {3.61052555921926*^9, 3.6105255720104837`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"let", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"path", "=", 
       RowBox[{"$HomeDirectory", "<>", "\"\</code/tools.nrepl\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"cfs", "=", 
       RowBox[{"path", "//", "clojureFiles"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", " ", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"parseFile", "[", "#", "]"}], ",", 
               RowBox[{
                RowBox[{"er", ":", "\:0589index"}], "\[RuleDelayed]", " ", 
                "er"}], ",", "\[Infinity]"}], "]"}]}], "}"}], "&"}], "/@", 
          "cfs"}], ")"}], "//", "Grid"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"path", "//", "graphProject"}], "//", 
        "addUnqualifiedNameLabels"}]}], "}"}], "]"}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.610572610558305*^9, 3.61057262215063*^9}, {
  3.610572694724393*^9, 3.61057279416717*^9}, {3.6105728347355328`*^9, 
  3.610573007132886*^9}, {3.610573064775188*^9, 3.610573094413515*^9}, {
  3.610573149970067*^9, 3.6105731546392517`*^9}, {3.6106415323235617`*^9, 
  3.610641584300267*^9}, {3.610641625143992*^9, 3.610641701892809*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "\"\</Users/timothygardner/code/tools.nrepl/src/main/clojure/clojure/tools/\
nrepl/bencode.clj\>\"", "//", "parseFile"}], "//", "nodify"}]], "Input",
 CellChangeTimes->{{3.610641763996476*^9, 3.61064176519385*^9}, {
  3.6107396235025883`*^9, 3.610739626990603*^9}}],

Cell[BoxData[
 RowBox[{"let", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vbn", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"varsByNamespace", "[", "nreplGraph", "]"}], ",", " ", 
        "First"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"cf", "=", 
      RowBox[{"ColorData", "[", "\"\<DarkRainbow\>\"", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"vclr", "=", " ", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", ",", "i"}], "}"}], ",", " ", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"c", "=", 
              RowBox[{"cf", "[", 
               FractionBox[
                RowBox[{"First", "[", "i", "]"}], 
                RowBox[{"Length", "[", "vbn", "]"}]], "]"}]}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#", "\[Rule]", " ", "c"}], "&"}], ")"}], "/@", 
               RowBox[{
               "r", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
              ")"}]}]}], "]"}]}], "]"}], ",", "vbn"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"setGraphOpts", "[", 
      RowBox[{"nreplGraph", ",", " ", 
       RowBox[{"VertexStyle", "\[Rule]", " ", "vclr"}]}], "]"}], "//", 
     "addUnqualifiedNameLabels"}], "//", "addToolTips"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.610648223700913*^9, 3.610648336409252*^9}, {
  3.6106484194713306`*^9, 3.6106488590605297`*^9}, {3.6106496096599607`*^9, 
  3.610649613815805*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.610649263869487*^9, 3.610649263984744*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"varsByNamespace", "[", "nreplGraph", "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}], "//", "Sort"}], "//", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"Print", ",", "#"}], "]"}], "&"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6106500864094267`*^9, 3.610650111153758*^9}, 
   3.610650181253422*^9, {3.614894830229122*^9, 3.614894834891363*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"upperCaseStartQ", "[", "s_String", "]"}], ":=", " ", 
  RowBox[{"StringMatchQ", "[", 
   RowBox[{"s", ",", 
    RowBox[{
     RowBox[{"_", "?", "UpperCaseQ"}], "~~", "___"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6106504066184607`*^9, 3.610650482189412*^9}, {
  3.610650519045073*^9, 3.610650556515773*^9}}],

Cell[BoxData[
 RowBox[{"StringMatchQ", "[", 
  RowBox[{"\"\<Bla\>\"", ",", 
   RowBox[{
    RowBox[{"_", "?", "UpperCaseQ"}], "~~", "___"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.610650602185617*^9, 3.610650607609894*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"varsByNamespace", "[", "nreplGraph", "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}], "//", "Sort"}], "//", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"#", ",", " ", 
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"upperCaseStartQ", "[", "#", "]"}]}], "&"}]}], "]"}], 
     "&"}]}], "//", 
   RowBox[{
    RowBox[{"Print", "/@", "#"}], "&"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6106500864094267`*^9, 3.610650111153758*^9}, 
   3.610650181253422*^9, {3.610650232639723*^9, 3.6106503371449537`*^9}, {
   3.610650377529264*^9, 3.610650401327703*^9}, {3.610650466302096*^9, 
   3.610650477333137*^9}, {3.61065062499671*^9, 3.6106506536822968`*^9}}],

Cell[BoxData[
 RowBox[{"?", "addToolTips"}]], "Input",
 CellChangeTimes->{{3.61065266142118*^9, 3.610652664042603*^9}}],

Cell[BoxData[
 RowBox[{"Graph", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Tooltip", "[", 
     RowBox[{
     "\"\<fish\>\"", ",", " ", 
      "\"\<Now is the winter\\n of our discontent\>\""}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", "\[DirectedEdge]", "b"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.610652652436116*^9, 3.610652747297868*^9}, {
  3.610653731861341*^9, 3.610653732979477*^9}}],

Cell[BoxData[
 RowBox[{"?", "Graph"}]], "Input",
 CellChangeTimes->{{3.6106535525097523`*^9, 3.610653553444936*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Scan", "[", 
   RowBox[{"Print", ",", " ", 
    RowBox[{"{", 
     RowBox[{"ns", "[", 
      RowBox[{"bla", ",", " ", 
       RowBox[{"ns", "[", "gra", "]"}]}], "]"}], "}"}], ",", "\[Infinity]"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.610733354686872*^9, 3.6107333973033447`*^9}}],

Cell[BoxData[
 RowBox[{"let", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nss", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"nreplGraph", "//", "VertexList"}], "//", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"getNamespaceName", ",", "#"}], "]"}], "&"}]}], "//", 
       "Union"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"cf", "=", " ", 
      RowBox[{"ColorData", "[", "\"\<DarkRainbow\>\"", "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
    RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "pos"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cf", "[", 
           FractionBox[
            RowBox[{"First", "[", "pos", "]"}], 
            RowBox[{"Length", "[", "nss", "]"}]], "]"}], ",", " ", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"First", "[", "pos", "]"}], ",", "5"}], "]"}], ",", 
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"First", "[", "pos", "]"}], "/", "5"}], "]"}]}], " ", 
             "}"}], ",", ".5"}], "]"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "nss"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6106466330673513`*^9, 3.610646659471971*^9}, {
  3.61064671123146*^9, 3.610646760487574*^9}, {3.610646881607209*^9, 
  3.610646889755896*^9}, {3.610646920294633*^9, 3.6106471830263033`*^9}, {
  3.610647217072461*^9, 3.610647285939272*^9}, {3.610647323125719*^9, 
  3.6106473290438004`*^9}, {3.6106474133198967`*^9, 3.610647501305564*^9}, {
  3.6106476467114973`*^9, 3.610647685846614*^9}, {3.610647730398947*^9, 
  3.6106477832293987`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"parseString", "[", "\"\</\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.624462201468444*^9, 3.62446221031271*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\:0589top", ",", 
   RowBox[{"{", 
    RowBox[{"\:0589symbol", ",", "\<\"/\"\>"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6244622108127832`*^9}]
}, Closed]]
}, Closed]]
}, Open  ]]
},
WindowSize->{960, 1151},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
ShowSelection->True,
InputAutoReplacements->{
 "\\" -> "\:2024", "--" -> "\:2011", "-=" -> "\:02cd", "''" -> "\:0589", "**" -> 
  "\:204e", "\[DownQuestion]" -> "\:2047", "!!" -> "\:203c"},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"menloExperiment.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 127, 2, 92, "Title"],
Cell[709, 26, 95, 1, 30, "Input"],
Cell[807, 29, 177, 3, 33, "Input",
 InitializationCell->True],
Cell[987, 34, 274, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[1286, 41, 170, 3, 64, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1481, 48, 133, 2, 44, "Subsection",
 InitializationCell->True],
Cell[1617, 52, 372, 9, 33, "Input",
 InitializationCell->True],
Cell[1992, 63, 819, 21, 170, "Input",
 InitializationCell->True],
Cell[2814, 86, 232, 5, 31, "Input",
 InitializationCell->True],
Cell[3049, 93, 185, 4, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[3271, 102, 118, 2, 36, "Subsection",
 InitializationCell->True],
Cell[3392, 106, 155, 3, 33, "Input",
 InitializationCell->True],
Cell[3550, 111, 196, 4, 33, "Input",
 InitializationCell->True],
Cell[3749, 117, 891, 23, 75, "Input",
 InitializationCell->True],
Cell[4643, 142, 244, 7, 31, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[4912, 153, 278, 8, 30, "Input",
 InitializationCell->True],
Cell[5193, 163, 325, 5, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[5567, 174, 240, 4, 36, "Subsection",
 InitializationCell->True],
Cell[5810, 180, 192, 4, 30, "Input",
 InitializationCell->True],
Cell[6005, 186, 275, 7, 31, "Input",
 InitializationCell->True],
Cell[6283, 195, 237, 6, 33, "Input",
 InitializationCell->True],
Cell[6523, 203, 244, 7, 30, "Input",
 InitializationCell->True],
Cell[6770, 212, 284, 8, 33, "Input",
 InitializationCell->True],
Cell[7057, 222, 270, 7, 30, "Input",
 InitializationCell->True],
Cell[7330, 231, 208, 5, 30, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[7575, 241, 127, 2, 36, "Subsection",
 InitializationCell->True],
Cell[7705, 245, 162, 3, 33, "Input",
 InitializationCell->True],
Cell[7870, 250, 654, 15, 31, "Input",
 InitializationCell->True],
Cell[8527, 267, 256, 6, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[8820, 278, 180, 3, 36, "Subsection",
 InitializationCell->True],
Cell[9003, 283, 364, 8, 31, "Input",
 InitializationCell->True],
Cell[9370, 293, 436, 11, 31, "Input",
 InitializationCell->True],
Cell[9809, 306, 392, 9, 31, "Input",
 InitializationCell->True],
Cell[10204, 317, 430, 11, 33, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[10671, 333, 123, 2, 36, "Subsection",
 InitializationCell->True],
Cell[10797, 337, 301, 6, 30, "Text",
 InitializationCell->True],
Cell[11101, 345, 617, 13, 53, "Input",
 InitializationCell->True],
Cell[11721, 360, 1598, 32, 103, "Input",
 InitializationCell->True],
Cell[13322, 394, 701, 15, 30, "Input",
 InitializationCell->True],
Cell[14026, 411, 466, 13, 31, "Input",
 InitializationCell->True],
Cell[14495, 426, 2318, 50, 131, "Input",
 InitializationCell->True],
Cell[16816, 478, 1213, 22, 31, "Input",
 InitializationCell->True],
Cell[18032, 502, 278, 7, 30, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[18347, 514, 120, 2, 36, "Subsection",
 InitializationCell->True],
Cell[18470, 518, 258, 7, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[18765, 530, 122, 2, 36, "Subsection",
 InitializationCell->True],
Cell[18890, 534, 284, 8, 31, "Input",
 InitializationCell->True],
Cell[19177, 544, 1045, 25, 94, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[20247, 573, 1215, 31, 125, "Input",
 InitializationCell->True],
Cell[21465, 606, 1614, 43, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[23128, 655, 123, 2, 36, "Subsection",
 InitializationCell->True],
Cell[23254, 659, 221, 6, 31, "Input",
 InitializationCell->True],
Cell[23478, 667, 531, 14, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[24046, 686, 125, 2, 36, "Subsection",
 InitializationCell->True],
Cell[24174, 690, 164, 3, 31, "Input",
 InitializationCell->True],
Cell[24341, 695, 227, 6, 31, "Input",
 InitializationCell->True],
Cell[24571, 703, 187, 4, 31, "Input",
 InitializationCell->True],
Cell[24761, 709, 276, 6, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[25074, 720, 133, 2, 36, "Subsection",
 InitializationCell->True],
Cell[25210, 724, 248, 5, 30, "Text",
 InitializationCell->True],
Cell[25461, 731, 637, 15, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[26135, 751, 127, 2, 36, "Subsection",
 InitializationCell->True],
Cell[26265, 755, 189, 4, 31, "Input",
 InitializationCell->True],
Cell[26457, 761, 237, 6, 32, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[26731, 772, 123, 2, 36, "Subsection",
 InitializationCell->True],
Cell[26857, 776, 1729, 45, 231, "Input",
 InitializationCell->True],
Cell[28589, 823, 336, 8, 31, "Input",
 InitializationCell->True],
Cell[28928, 833, 279, 7, 31, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[29256, 846, 183, 3, 50, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[29464, 853, 121, 2, 44, "Subsection",
 InitializationCell->True],
Cell[29588, 857, 180, 5, 33, "Input",
 InitializationCell->True],
Cell[29771, 864, 114, 3, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[29922, 872, 131, 2, 36, "Subsection",
 InitializationCell->True],
Cell[30056, 876, 375, 8, 31, "Input",
 InitializationCell->True],
Cell[30434, 886, 461, 12, 31, "Input",
 InitializationCell->True],
Cell[30898, 900, 438, 10, 31, "Input",
 InitializationCell->True],
Cell[31339, 912, 623, 13, 49, "Input",
 InitializationCell->True],
Cell[31965, 927, 1090, 27, 85, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[33080, 958, 450, 13, 33, "Input",
 InitializationCell->True],
Cell[33533, 973, 495, 11, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34065, 989, 414, 12, 33, "Input",
 InitializationCell->True],
Cell[34482, 1003, 1323, 27, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35842, 1035, 600, 15, 33, "Input",
 InitializationCell->True],
Cell[36445, 1052, 499, 11, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[36993, 1069, 133, 2, 36, "Subsection",
 InitializationCell->True],
Cell[37129, 1073, 476, 12, 31, "Input",
 InitializationCell->True],
Cell[37608, 1087, 384, 10, 31, "Input",
 InitializationCell->True],
Cell[37995, 1099, 327, 6, 49, "Text",
 InitializationCell->True],
Cell[38325, 1107, 548, 15, 33, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[38910, 1127, 147, 2, 36, "Subsection",
 InitializationCell->True],
Cell[39060, 1131, 258, 5, 31, "Input",
 InitializationCell->True],
Cell[39321, 1138, 2160, 49, 222, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[41506, 1191, 836, 23, 74, "Input",
 InitializationCell->True],
Cell[42345, 1216, 2043, 42, 70, "Output"]
}, Open  ]],
Cell[44403, 1261, 1090, 19, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[45530, 1285, 140, 2, 36, "Subsection",
 InitializationCell->True],
Cell[45673, 1289, 373, 9, 33, "Input",
 InitializationCell->True],
Cell[46049, 1300, 326, 8, 33, "Input",
 InitializationCell->True],
Cell[46378, 1310, 2443, 59, 233, "Input",
 InitializationCell->True],
Cell[48824, 1371, 447, 9, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[49308, 1385, 143, 2, 36, "Subsection",
 InitializationCell->True],
Cell[49454, 1389, 199, 4, 33, "Input",
 InitializationCell->True],
Cell[49656, 1395, 336, 9, 31, "Input",
 InitializationCell->True],
Cell[49995, 1406, 346, 8, 33, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[50378, 1419, 129, 2, 36, "Subsection",
 InitializationCell->True],
Cell[50510, 1423, 257, 5, 33, "Input",
 InitializationCell->True],
Cell[50770, 1430, 1057, 26, 112, "Input",
 InitializationCell->True],
Cell[51830, 1458, 229, 5, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[52084, 1467, 596, 12, 33, "Input",
 InitializationCell->True],
Cell[52683, 1481, 473, 9, 70, "Output"]
}, Open  ]],
Cell[53171, 1493, 3118, 67, 347, "Input",
 InitializationCell->True],
Cell[56292, 1562, 656, 17, 33, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[56985, 1584, 139, 2, 36, "Subsection",
 InitializationCell->True],
Cell[57127, 1588, 399, 8, 53, "Input",
 InitializationCell->True],
Cell[57529, 1598, 497, 12, 33, "Input",
 InitializationCell->True],
Cell[58029, 1612, 404, 9, 49, "Input",
 InitializationCell->True],
Cell[58436, 1623, 350, 7, 31, "Input",
 InitializationCell->True],
Cell[58789, 1632, 648, 14, 49, "Input",
 InitializationCell->True],
Cell[59440, 1648, 436, 10, 49, "Input",
 InitializationCell->True],
Cell[59879, 1660, 1304, 24, 109, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[61220, 1689, 170, 3, 36, "Subsection",
 InitializationCell->True],
Cell[61393, 1694, 162, 3, 31, "Input",
 InitializationCell->True],
Cell[61558, 1699, 153, 2, 30, "Text",
 InitializationCell->True],
Cell[61714, 1703, 216, 5, 31, "Input",
 InitializationCell->True],
Cell[61933, 1710, 190, 4, 31, "Input",
 InitializationCell->True],
Cell[62126, 1716, 233, 6, 33, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[62396, 1727, 125, 2, 36, "Subsection",
 InitializationCell->True],
Cell[62524, 1731, 191, 4, 31, "Input",
 InitializationCell->True],
Cell[62718, 1737, 328, 8, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[63083, 1750, 131, 2, 36, "Subsection",
 InitializationCell->True],
Cell[63217, 1754, 148, 2, 30, "Text",
 InitializationCell->True],
Cell[63368, 1758, 203, 5, 31, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[63596, 1767, 290, 6, 33, "Input",
 InitializationCell->True],
Cell[63889, 1775, 782, 15, 70, "Message"],
Cell[64674, 1792, 330, 5, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[65053, 1803, 173, 3, 36, "Subsection",
 InitializationCell->True],
Cell[65229, 1808, 274, 6, 30, "Text",
 InitializationCell->True],
Cell[65506, 1816, 160, 3, 31, "Input",
 InitializationCell->True],
Cell[65669, 1821, 494, 14, 31, "Input",
 InitializationCell->True],
Cell[66166, 1837, 294, 7, 31, "Input",
 InitializationCell->True],
Cell[66463, 1846, 217, 5, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[66717, 1856, 229, 4, 36, "Subsection",
 InitializationCell->True],
Cell[66949, 1862, 353, 8, 31, "Input",
 InitializationCell->True],
Cell[67305, 1872, 418, 8, 49, "Text"],
Cell[67726, 1882, 3917, 83, 234, "Input",
 InitializationCell->True],
Cell[71646, 1967, 456, 10, 31, "Input",
 InitializationCell->True],
Cell[72105, 1979, 314, 7, 31, "Input",
 InitializationCell->True],
Cell[72422, 1988, 301, 6, 31, "Input",
 InitializationCell->True],
Cell[72726, 1996, 407, 10, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[73170, 2011, 130, 2, 36, "Subsection",
 InitializationCell->True],
Cell[73303, 2015, 191, 4, 31, "Input",
 InitializationCell->True],
Cell[73497, 2021, 335, 9, 31, "Input",
 InitializationCell->True],
Cell[73835, 2032, 2404, 53, 145, "Input",
 InitializationCell->True],
Cell[76242, 2087, 155, 3, 30, "Text"],
Cell[76400, 2092, 184, 3, 31, "Input"],
Cell[76587, 2097, 2663, 59, 191, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[79287, 2161, 220, 3, 36, "Subsection",
 InitializationCell->True],
Cell[79510, 2166, 348, 6, 31, "Input",
 InitializationCell->True],
Cell[79861, 2174, 1246, 28, 49, "Input",
 InitializationCell->True],
Cell[81110, 2204, 916, 21, 107, "Input",
 InitializationCell->True],
Cell[82029, 2227, 652, 19, 31, "Input",
 InitializationCell->True],
Cell[82684, 2248, 666, 17, 107, "Input",
 InitializationCell->True],
Cell[83353, 2267, 149, 2, 30, "Text",
 InitializationCell->True],
Cell[83505, 2271, 537, 14, 31, "Input",
 InitializationCell->True],
Cell[84045, 2287, 326, 7, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[84408, 2299, 189, 3, 36, "Subsection",
 InitializationCell->True],
Cell[84600, 2304, 327, 7, 33, "Input",
 InitializationCell->True],
Cell[84930, 2313, 1182, 25, 33, "Input",
 InitializationCell->True],
Cell[86115, 2340, 410, 9, 31, "Input",
 InitializationCell->True],
Cell[86528, 2351, 1176, 21, 31, "Input",
 InitializationCell->True],
Cell[87707, 2374, 564, 12, 31, "Input"],
Cell[CellGroupData[{
Cell[88296, 2390, 134, 3, 30, "Input",
 InitializationCell->True],
Cell[88433, 2395, 1816, 47, 70, "Output"]
}, Open  ]],
Cell[90264, 2445, 2163, 50, 204, "Input",
 InitializationCell->True],
Cell[92430, 2497, 69, 1, 30, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[92548, 2504, 118, 2, 50, "Section",
 InitializationCell->True],
Cell[92669, 2508, 360, 7, 49, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[93054, 2519, 119, 2, 44, "Subsection",
 InitializationCell->True],
Cell[93176, 2523, 397, 10, 33, "Input",
 InitializationCell->True],
Cell[93576, 2535, 245, 4, 33, "Input",
 InitializationCell->True],
Cell[93824, 2541, 886, 17, 53, "Input",
 InitializationCell->True],
Cell[94713, 2560, 218, 4, 33, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[94968, 2569, 121, 2, 44, "Subsection",
 InitializationCell->True],
Cell[95092, 2573, 226, 5, 30, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[95343, 2582, 160, 3, 31, "Input",
 InitializationCell->True],
Cell[95506, 2587, 347, 5, 30, "Output"]
}, Open  ]],
Cell[95868, 2595, 268, 6, 31, "Input",
 InitializationCell->True],
Cell[96139, 2603, 285, 7, 33, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[96461, 2615, 128, 2, 44, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[96614, 2621, 479, 10, 73, "Input",
 InitializationCell->True],
Cell[97096, 2633, 389, 6, 31, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[97546, 2646, 121, 2, 64, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[97692, 2652, 122, 2, 44, "Subsection",
 InitializationCell->True],
Cell[97817, 2656, 340, 7, 49, "Text",
 InitializationCell->True],
Cell[98160, 2665, 367, 9, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[98552, 2678, 157, 3, 31, "Input",
 InitializationCell->True],
Cell[98712, 2683, 349, 5, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99098, 2693, 214, 4, 31, "Input",
 InitializationCell->True],
Cell[99315, 2699, 388, 6, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99740, 2710, 164, 4, 33, "Input",
 InitializationCell->True],
Cell[99907, 2716, 543, 11, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100487, 2732, 161, 3, 31, "Input",
 InitializationCell->True],
Cell[100651, 2737, 353, 5, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101041, 2747, 344, 8, 33, "Input",
 InitializationCell->True],
Cell[101388, 2757, 549, 11, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101974, 2773, 157, 3, 31, "Input",
 InitializationCell->True],
Cell[102134, 2778, 354, 5, 70, "Output"]
}, Open  ]],
Cell[102503, 2786, 232, 5, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[102760, 2795, 278, 5, 31, "Input",
 InitializationCell->True],
Cell[103041, 2802, 393, 7, 70, "Output"]
}, Open  ]],
Cell[103449, 2812, 241, 5, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[103715, 2821, 243, 5, 33, "Input",
 InitializationCell->True],
Cell[103961, 2828, 552, 11, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104550, 2844, 159, 3, 31, "Input",
 InitializationCell->True],
Cell[104712, 2849, 352, 5, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[105113, 2860, 126, 2, 36, "Subsection",
 InitializationCell->True],
Cell[105242, 2864, 482, 12, 34, "Text",
 InitializationCell->True],
Cell[105727, 2878, 337, 8, 33, "Input",
 InitializationCell->True],
Cell[106067, 2888, 263, 6, 33, "Input",
 InitializationCell->True],
Cell[106333, 2896, 654, 16, 33, "Input",
 InitializationCell->True],
Cell[106990, 2914, 95, 2, 30, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[107134, 2922, 129, 2, 50, "Section",
 InitializationCell->True],
Cell[107266, 2926, 192, 4, 30, "Text",
 InitializationCell->True],
Cell[107461, 2932, 196, 4, 33, "Input",
 InitializationCell->True],
Cell[107660, 2938, 364, 7, 33, "Input",
 InitializationCell->True],
Cell[108027, 2947, 463, 10, 33, "Input",
 InitializationCell->True],
Cell[108493, 2959, 351, 7, 33, "Input"],
Cell[108847, 2968, 373, 7, 33, "Input"],
Cell[109223, 2977, 376, 9, 33, "Input",
 InitializationCell->True],
Cell[109602, 2988, 153, 2, 30, "Text",
 InitializationCell->True],
Cell[109758, 2992, 432, 11, 33, "Input",
 InitializationCell->True],
Cell[110193, 3005, 683, 12, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[110901, 3021, 122, 2, 44, "Subsection",
 InitializationCell->True],
Cell[111026, 3025, 1277, 31, 152, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[112328, 3060, 146, 2, 31, "Input"],
Cell[112477, 3064, 1143, 32, 94, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[113681, 3103, 131, 2, 64, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[113837, 3109, 185, 3, 44, "Subsection",
 InitializationCell->True],
Cell[114025, 3114, 246, 6, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[114308, 3125, 175, 3, 36, "Subsection",
 InitializationCell->True],
Cell[114486, 3130, 318, 7, 31, "Input",
 InitializationCell->True],
Cell[114807, 3139, 302, 7, 31, "Input",
 InitializationCell->True],
Cell[115112, 3148, 304, 7, 31, "Input",
 InitializationCell->True],
Cell[115419, 3157, 325, 8, 31, "Input",
 InitializationCell->True],
Cell[115747, 3167, 223, 5, 31, "Input",
 InitializationCell->True],
Cell[115973, 3174, 221, 5, 31, "Input",
 InitializationCell->True],
Cell[116197, 3181, 247, 6, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[116481, 3192, 123, 2, 36, "Subsection",
 InitializationCell->True],
Cell[116607, 3196, 264, 6, 31, "Input",
 InitializationCell->True],
Cell[116874, 3204, 222, 5, 31, "Input",
 InitializationCell->True],
Cell[117099, 3211, 237, 6, 31, "Input",
 InitializationCell->True],
Cell[117339, 3219, 428, 11, 31, "Input",
 InitializationCell->True],
Cell[117770, 3232, 6909, 159, 696, "Input",
 InitializationCell->True],
Cell[124682, 3393, 232, 5, 30, "Text",
 InitializationCell->True],
Cell[124917, 3400, 213, 5, 31, "Input",
 InitializationCell->True],
Cell[125133, 3407, 162, 3, 30, "Input",
 InitializationCell->True],
Cell[125298, 3412, 551, 12, 31, "Input",
 InitializationCell->True],
Cell[125852, 3426, 268, 5, 49, "Text",
 InitializationCell->True],
Cell[126123, 3433, 3321, 70, 128, "Input",
 InitializationCell->True],
Cell[129447, 3505, 2217, 47, 149, "Input",
 InitializationCell->True],
Cell[131667, 3554, 450, 9, 31, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[132154, 3568, 127, 2, 44, "Subsection",
 InitializationCell->True],
Cell[132284, 3572, 286, 6, 31, "Input",
 InitializationCell->True],
Cell[132573, 3580, 270, 6, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[132880, 3591, 174, 3, 36, "Subsection",
 InitializationCell->True],
Cell[133057, 3596, 259, 6, 31, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[133341, 3606, 130, 2, 35, "Subsubsection",
 InitializationCell->True],
Cell[133474, 3610, 2138, 48, 239, "Input",
 InitializationCell->True],
Cell[135615, 3660, 242, 5, 30, "Text",
 InitializationCell->True],
Cell[135860, 3667, 885, 19, 69, "Input",
 InitializationCell->True],
Cell[136748, 3688, 279, 6, 31, "Input",
 InitializationCell->True],
Cell[137030, 3696, 377, 8, 33, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[137456, 3710, 125, 2, 36, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[137606, 3716, 193, 3, 35, "Subsubsection",
 InitializationCell->True],
Cell[137802, 3721, 1462, 34, 71, "Input",
 InitializationCell->True],
Cell[139267, 3757, 900, 19, 103, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[140204, 3781, 134, 2, 35, "Subsubsection",
 InitializationCell->True],
Cell[140341, 3785, 172, 3, 33, "Input",
 InitializationCell->True],
Cell[140516, 3790, 1084, 23, 89, "Input",
 InitializationCell->True],
Cell[141603, 3815, 2406, 50, 49, "Input",
 InitializationCell->True],
Cell[144012, 3867, 1210, 25, 111, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[145259, 3897, 128, 2, 35, "Subsubsection",
 InitializationCell->True],
Cell[145390, 3901, 703, 14, 31, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[146142, 3921, 133, 2, 44, "Subsection",
 InitializationCell->True],
Cell[146278, 3925, 832, 23, 71, "Input",
 InitializationCell->True],
Cell[147113, 3950, 284, 7, 31, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[147434, 3962, 126, 2, 44, "Subsection",
 InitializationCell->True],
Cell[147563, 3966, 919, 19, 85, "Input",
 InitializationCell->True],
Cell[148485, 3987, 1076, 27, 67, "Input",
 InitializationCell->True],
Cell[149564, 4016, 518, 11, 31, "Input",
 InitializationCell->True],
Cell[150085, 4029, 434, 11, 31, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[150556, 4045, 129, 2, 44, "Subsection",
 InitializationCell->True],
Cell[150688, 4049, 761, 16, 31, "Input",
 InitializationCell->True],
Cell[151452, 4067, 291, 7, 31, "Input",
 InitializationCell->True],
Cell[151746, 4076, 345, 9, 31, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[152140, 4091, 125, 2, 64, "Section",
 InitializationCell->True],
Cell[152268, 4095, 747, 13, 163, "Text",
 InitializationCell->True],
Cell[153018, 4110, 385, 7, 68, "Text",
 InitializationCell->True],
Cell[153406, 4119, 276, 6, 30, "Text",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[153719, 4130, 119, 2, 50, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[153863, 4136, 136, 2, 44, "Subsection",
 InitializationCell->True],
Cell[154002, 4140, 545, 15, 33, "Input",
 InitializationCell->True],
Cell[154550, 4157, 485, 11, 31, "Input",
 InitializationCell->True],
Cell[155038, 4170, 457, 12, 31, "Input",
 InitializationCell->True],
Cell[155498, 4184, 190, 4, 30, "Text",
 InitializationCell->True],
Cell[155691, 4190, 2644, 57, 323, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[158372, 4252, 132, 2, 36, "Subsection",
 InitializationCell->True],
Cell[158507, 4256, 361, 9, 31, "Input",
 InitializationCell->True],
Cell[158871, 4267, 188, 4, 31, "Input",
 InitializationCell->True],
Cell[159062, 4273, 615, 15, 51, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[159714, 4293, 121, 2, 36, "Subsection",
 InitializationCell->True],
Cell[159838, 4297, 374, 9, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[160249, 4311, 131, 2, 36, "Subsection",
 InitializationCell->True],
Cell[160383, 4315, 364, 9, 31, "Input",
 InitializationCell->True],
Cell[160750, 4326, 354, 9, 31, "Input",
 InitializationCell->True],
Cell[161107, 4337, 851, 18, 31, "Input",
 InitializationCell->True],
Cell[161961, 4357, 485, 14, 49, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[162483, 4376, 127, 2, 36, "Subsection",
 InitializationCell->True],
Cell[162613, 4380, 805, 20, 33, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[163455, 4405, 132, 2, 36, "Subsection",
 InitializationCell->True],
Cell[163590, 4409, 380, 9, 33, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[164007, 4423, 124, 2, 36, "Subsection",
 InitializationCell->True],
Cell[164134, 4427, 481, 12, 51, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[164652, 4444, 121, 2, 36, "Subsection",
 InitializationCell->True],
Cell[164776, 4448, 242, 5, 31, "Input",
 InitializationCell->True],
Cell[165021, 4455, 180, 4, 31, "Input",
 InitializationCell->True],
Cell[165204, 4461, 179, 4, 31, "Input",
 InitializationCell->True],
Cell[165386, 4467, 190, 4, 31, "Input",
 InitializationCell->True],
Cell[165579, 4473, 178, 4, 31, "Input",
 InitializationCell->True],
Cell[165760, 4479, 177, 4, 31, "Input",
 InitializationCell->True],
Cell[165940, 4485, 176, 4, 31, "Input",
 InitializationCell->True],
Cell[166119, 4491, 994, 22, 51, "Input",
 InitializationCell->True],
Cell[167116, 4515, 1314, 26, 49, "Input",
 InitializationCell->True],
Cell[168433, 4543, 650, 16, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[169108, 4563, 123, 2, 35, "Subsubsection",
 InitializationCell->True],
Cell[169234, 4567, 329, 9, 31, "Input",
 InitializationCell->True],
Cell[169566, 4578, 300, 8, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[169903, 4591, 160, 2, 35, "Subsubsection",
 InitializationCell->True],
Cell[170066, 4595, 781, 19, 32, "Input",
 InitializationCell->True],
Cell[170850, 4616, 859, 19, 32, "Input",
 InitializationCell->True],
Cell[171712, 4637, 456, 11, 51, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[172217, 4654, 126, 2, 36, "Subsection",
 InitializationCell->True],
Cell[172346, 4658, 659, 19, 31, "Input",
 InitializationCell->True],
Cell[173008, 4679, 616, 16, 53, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[173661, 4700, 191, 3, 44, "Subsection",
 InitializationCell->True],
Cell[173855, 4705, 832, 20, 85, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[174724, 4730, 236, 4, 36, "Subsection",
 InitializationCell->True],
Cell[174963, 4736, 734, 19, 33, "Input",
 InitializationCell->True],
Cell[175700, 4757, 690, 19, 33, "Input",
 InitializationCell->True],
Cell[176393, 4778, 369, 10, 31, "Input",
 InitializationCell->True],
Cell[176765, 4790, 727, 20, 51, "Input",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[177541, 4816, 154, 2, 50, "Section"],
Cell[177698, 4820, 350, 8, 51, "Input"],
Cell[178051, 4830, 1228, 30, 75, "Input"],
Cell[179282, 4862, 1063, 23, 54, "Input"],
Cell[180348, 4887, 94, 1, 30, "Input"],
Cell[180445, 4890, 1417, 33, 116, "Input"],
Cell[181865, 4925, 1484, 36, 155, "Input"],
Cell[183352, 4963, 302, 6, 49, "Input"],
Cell[183657, 4971, 1779, 46, 149, "Input"],
Cell[185439, 5019, 92, 1, 30, "Input"],
Cell[185534, 5022, 473, 12, 33, "Input"],
Cell[186010, 5036, 347, 8, 31, "Input"],
Cell[186360, 5046, 225, 5, 33, "Input"],
Cell[186588, 5053, 815, 21, 33, "Input"],
Cell[187406, 5076, 119, 2, 31, "Input"],
Cell[187528, 5080, 419, 11, 33, "Input"],
Cell[187950, 5093, 116, 2, 31, "Input"],
Cell[188069, 5097, 327, 9, 33, "Input"],
Cell[188399, 5108, 1968, 47, 225, "Input"],
Cell[CellGroupData[{
Cell[190392, 5159, 137, 2, 31, "Input"],
Cell[190532, 5163, 193, 5, 33, "Output"]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
